<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="CommandRefTopic" />
<meta name="DC.Title" content="DFM Function" />
<meta name="abstract" content="Specifies a user-defined function that can be referenced within expressions for DFM Analyze, DFM Property, or other DFM Function statements." />
<meta name="description" content="Specifies a user-defined function that can be referenced within expressions for DFM Analyze, DFM Property, or other DFM Function statements." />
<meta name="prodname" content="Standard Verification Rule Format (SVRF) Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-26" />
<meta name="Topline" content="Siemens EDA" />
<meta name="VariantPrefix" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="21.2" />
<meta name="HighlightColor" content="mgc_yellow_129_50" />
<meta name="HighlightChanges" content="yes" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="svrf_ur" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="3/25/21" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Standard Verification Rule Format (SVRF) Manual" />
<meta name="CSHelp" content="No" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10089,product.id.P10099,product.id.P10119,product.id.P10101,product.id.P11427,product.id.P10115,product.id.P11426,product.id.P10122,product.id.P11493" />
<meta name="ConditionFiltering" content="XML" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id879454b1-404a-412a-8094-fb480f5c3a9f" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>DFM Function</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="DFM Function" />
<meta name="attributes" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10089,product.id.P10099,product.id.P10119,product.id.P10101,product.id.P11427,product.id.P10115,product.id.P11426,product.id.P10122,product.id.P11493" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body class="usa-arg" id="id879454b1-404a-412a-8094-fb480f5c3a9f">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">DFM Function</h1>
<div class="body refbody CommandRefBody"><div class="abstract CommandRefAbstract"><p class="p ContextMGC">Specification
statement</p>
<p class="shortdesc">Specifies a user-defined function
that can be referenced within expressions for DFM Analyze, DFM Property,
or other DFM Function statements.</p>
</div>
<div class="section Usages"><h2 class="title Subheading sectiontitle">Usage</h2><div class="section UsageSet"><p class="lines UsageLine"><span class="keyword ParameterName Required">DFM FUNCTION</span> <br />
'<span class="keyword ParameterName Required">[</span>' <br />
<span class="keyword ParameterName RequiredReplaceable">function_name</span> '<span class="keyword ParameterName Required">(</span>' <span class="keyword ParameterName RequiredReplaceable">type</span> <span class="keyword ParameterName RequiredReplaceable">arg_name</span> [',' <span class="keyword ParameterName OptionalReplaceable">type</span> <span class="keyword ParameterName OptionalReplaceable">arg_name</span>]… '<span class="keyword ParameterName Required">)</span>' <br />
{<span class="keyword ParameterName Required">TABLE</span> [<span class="keyword ParameterName OptionalDefault">LINEAR</span> | <span class="keyword ParameterName Optional">SPLINE</span>] '<span class="keyword ParameterName Required">{</span>' <span class="keyword ParameterName RequiredReplaceable">input1</span> <span class="keyword ParameterName RequiredReplaceable">result1</span> [<span class="keyword ParameterName OptionalReplaceable">input2</span> <span class="keyword ParameterName OptionalReplaceable">result2</span>]… '<span class="keyword ParameterName Required">}</span>'  <br />
   | <span class="keyword ParameterName RequiredReplaceable">expression</span> <br />
   | <span class="keyword ParameterName Required">MATRIX</span>  <span class="keyword ParameterName RequiredReplaceable">matrix_specification</span> <br />
   | <span class="keyword ParameterName Required">TVF_NUMber_FUNction</span>'('<span class="keyword ParameterName RequiredReplaceable">tcl_proc</span> ',' <span class="keyword ParameterName RequiredReplaceable">TVF_function</span>')'  <br />
   | <span class="keyword ParameterName Required">TVF_STRING_FUNction</span>'('<span class="keyword ParameterName RequiredReplaceable">tcl_proc</span> ',' <span class="keyword ParameterName RequiredReplaceable">TVF_function</span>')'<br />
} <br />
'<span class="keyword ParameterName Required">]</span>'</p>
</div>
</div>
<div class="section Arguments"><h2 class="title Subheading sectiontitle">Arguments</h2><div class="section ArgumentSet"><p class="p">The entire parameter block for
this statement must be enclosed in brackets ([ ]). You must supply
either a <span class="keyword ParameterName Required">TABLE</span>,
an <span class="keyword ParameterName RequiredReplaceable">expression</span>,
a <span class="keyword ParameterName Required">MATRIX</span>,
a <span class="keyword ParameterName Required">TVF_NUMber_FUNction</span>,
or a <span class="keyword ParameterName Required">TVF_STRING_FUNction</span> specification.</p>
<dl class="dl ArgumentList"><dt class="dt ArgumentName dlterm" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id0cea5bc0-30d8-4b41-ba72-c9a7e8ba040e"><span class="keyword ParameterName RequiredReplaceable">function_name</span></dt>
<dd class="dd ArgumentDescription"><p class="p">A required argument that specifies
the name of the function being defined. The function name must not
coincide with the name of any other DFM function or any built-in
function supported in <a class="xref fm:HeadingOnly" href="Command_DfmAnalyze_id1ca0eb21.html#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289__Command_DfmAnalyze_id1ca0eb21.xml#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289" title="Identifies areas on a layout where manufacturing yield can potentially be improved.">DFM Analyze</a> or <a class="xref fm:HeadingOnly" href="Command_DfmProperty_idf1f176c5.html#idf1f176c5-0d5a-4406-95d0-b54438157ae8__Command_DfmProperty_idf1f176c5.xml#idf1f176c5-0d5a-4406-95d0-b54438157ae8" title="Associates user-defined properties to individual objects on the input layer and creates a derived layer containing only those objects that meet the specified criteria.">DFM Property</a>, such
as AREA, EC, EXP, and so on.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id41415922-cc9d-4096-943f-10353178c411">'<span class="keyword ParameterName Required">(</span>' <span class="keyword ParameterName RequiredReplaceable">type</span> <span class="keyword ParameterName RequiredReplaceable">arg_name</span> [',' <span class="keyword ParameterName OptionalReplaceable">type</span> <span class="keyword ParameterName OptionalReplaceable">arg_name</span>]… '<span class="keyword ParameterName Required">)</span>' </dt>
<dd class="dd ArgumentDescription"><p class="p">One or more required argument
pairs specifying the type(s) of data on which this function operates
and assigning a name (<span class="keyword ParameterName RequiredReplaceable">arg_name</span>)
by which to reference the data. When the function is defined by
a TABLE, only one <span class="keyword ParameterName RequiredReplaceable">type arg_name</span> pair
is allowed. Multiple <span class="keyword ParameterName RequiredReplaceable">type arg_name</span> pairs
must be separated by commas. The set of <span class="keyword ParameterName RequiredReplaceable">type</span> and <span class="keyword ParameterName RequiredReplaceable">arg_name</span> pairs
must be enclosed in parentheses ( ).</p>
<p class="p">The type of the argument restricts
its valid uses in the body of the function. The <span class="keyword ParameterName RequiredReplaceable">type</span> must
be one of the following:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id800b18f3-72b3-4788-a7fd-70989f6d1d41"><p class="p Opt"><span class="keyword ParameterName Required">NUMBER</span> —
Indicates the argument is a numeric value, used either as a number
or as an argument to a function that accepts only numbers as arguments.
The value is passed in as double-precision floating-point number. </p>
</li>
<li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id273d0b42-c097-43aa-ab17-d83c2449a203"><p class="p Opt"><span class="keyword ParameterName Required">LAYER</span> —
Indicates the argument is a string that provides a layer name. The
string is used as an argument to a function that accepts layer names
as arguments. <span class="keyword ParameterName Required">LAYER</span> arguments
are only used when the function is defined with an <span class="keyword ParameterName RequiredReplaceable">expression</span>. </p>
</li>
<li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idd2cec700-240c-4471-b677-d5012ae90846"><p class="p Opt"><span class="keyword ParameterName Required">STRING</span> —
Indicates the argument is a string. The string can be the name of
a DFM property that is used in the <span class="keyword ParameterName RequiredReplaceable">expression</span> argument.
See “<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__idbf7e0cb3-2658-4c6a-9b3f-ba26a7425863">Example 4</a>”.</p>
</li>
<li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__ida79b7090-82c5-4225-8537-43c26f4e9b69"><p class="p Opt"><span class="keyword ParameterName Required">VECTOR</span> —
Indicates the argument is a two-dimensional array of numbers in
which one dimension, the tuple size, is fixed and the other dimension,
the number of tuples, is variable.</p>
</li>
<li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idc80c26a8-2372-4b24-8ce1-789ec6cdbae8"><p class="p Opt"><span class="keyword ParameterName Required">VSTRING</span> —
Indicates the argument is a two-dimensional array of strings in
which one dimension, the tuple size, is fixed and the other dimension,
the number of tuples, is variable.</p>
</li>
<li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__ida43f446b-8a47-49ee-8d0a-8d6b45e9b421"><p class="p Opt"><span class="keyword ParameterName Required">NETID</span> —
Indicates the argument is of type netID.</p>
</li>
<li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idda87af37-5853-4d31-9ad6-77dc30c8ec92"><p class="p Opt"><span class="keyword ParameterName Required">VNETID</span> —
Indicates the argument is of type vnetID.</p>
</li>
</ul>
<p class="p"><span class="keyword ParameterName Required">TABLE</span> and <span class="keyword ParameterName Required">MATRIX</span> definitions
only use <span class="keyword ParameterName Required">NUMBER</span> arguments.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id5c0328d9-1b2c-4910-b75b-8021f79f4534"><span class="keyword ParameterName Required">TABLE</span> [<span class="keyword ParameterName Optional">LINEAR</span> | <span class="keyword ParameterName Optional">SPLINE] </span>'<span class="keyword ParameterName Required">{</span>' <span class="keyword ParameterName RequiredReplaceable">input1</span> <span class="keyword ParameterName RequiredReplaceable">result1</span> [<span class="keyword ParameterName OptionalReplaceable">input2</span> <span class="keyword ParameterName OptionalReplaceable">result2</span>]… '<span class="keyword ParameterName Required">}</span>'</dt>
<dd class="dd ArgumentDescription"><p class="p">A keyword and associated list
defining a set of ordered pairs forming a lookup table for calculating
function results. When you specify TABLE, the following must be
true:</p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idc5f3a413-ea0b-43b8-b752-eebdc4c59dbb"><p class="p">The list that defines the
table must be enclosed in braces ({ }).</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idde8d743f-97fd-4d32-a8e5-5237443665f0"><p class="p">In the list that defines
the table, the function inputs (the first value in the ordered pairs)
must be supplied in monotonically increasing order. </p>
</li>
</ul>
<p class="p">The secondary keywords <span class="keyword ParameterName Optional">LINEAR</span> and <span class="keyword ParameterName Optional">SPLINE</span> control
how function values are calculated when the input value is between
two adjacent input values:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id92f8ba74-77dc-4632-816b-500fc69d991a"><p class="p Opt"><span class="keyword ParameterName OptionalDefault">LINEAR</span> —
Piecewise linear interpolation algorithm. This is the default algorithm.</p>
</li>
<li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idf846aafa-eeca-4a73-910f-b9b157355ded"><p class="p Opt">SPLINE
— Bicubic interpolation algorithm. </p>
</li>
</ul>
<p class="p">When using a table lookup for
calculating function results, the <span class="keyword ParameterName RequiredReplaceable">type</span> must
be NUMBER. The result is a floating-point number. </p>
<p class="p">TABLE functions can be used in the function <a class="xref fm:HeadingOnly" href="Command_BILDfmDeviceEvalDfmFunc_idf250824b.html#idf250824b-7f8f-474b-86ad-96518913c75c__Command_BILDfmDeviceEvalDfmFunc_idf250824b.xml#idf250824b-7f8f-474b-86ad-96518913c75c" title="Enables access to DFM Function TABLE and MATRIX functions to assign device property values.">device::eval_dfm_func</a> in the
Device annotation built-in language, as well as in DFM Property,
DFM Analyze, and DFM Function. </p>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">For argument
values outside of the range covered by the table, DFM Function extrapolates
the function based on the closest table points. This extrapolation
is especially problematic for spline functions, but even for piece-wise
linear functions it is unlikely to be accurate. You are encouraged
to always protect interpolated functions from out-of-range arguments
using <a class="xref fm:HeadingOnly" href="General_ConditionalExpressions_ide027a325.html#ide027a325-8bb9-4a37-8131-9256af5f6d60__General_ConditionalExpressions_ide027a325.xml#ide027a325-8bb9-4a37-8131-9256af5f6d60" title="A conditional expression is a way to specify an if/then expression within a DFM expression—it returns one result if the specified condition is true and another result if the condition is false. You can use conditional expressions in the DFM expressions within DFM Analyze, DFM Spec Fill Optimizer, DFM Property and its related operations, and DFM Function.">Conditional Expressions</a>.</p>
</div>
</dd>
<dt class="dt ArgumentName dlterm" id="id879454b1-404a-412a-8094-fb480f5c3a9f__ida876748d-6a30-435b-9999-db8e098ec945"><span class="keyword ParameterName RequiredReplaceable">expression</span></dt>
<dd class="dd ArgumentDescription"><p class="p">An expression that produces
the function results. The <span class="keyword ParameterName RequiredReplaceable">expression</span> may
involve any of the following components:</p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idc1aa1796-96ae-452f-9735-02154910b54c"><p class="p">Numbers, including numeric
variables.</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id3022e26b-48e1-4f22-9b3f-2b1c4ec4d8c2"><p class="p"><a class="xref fm:HeadingOnly" href="General_MathOperators_idf1457929.html#idf1457929-4b2f-45f0-89e6-68dedaabf92d__General_MathOperators_idf1457929.xml#idf1457929-4b2f-45f0-89e6-68dedaabf92d" title="Built-in math operators are available for use in DFM expressions. These are operators familiar in other programming contexts.">Math Operators</a> (+, -,
!, ~, ^, *, /, +, -).</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__iddabe7967-7ced-41cf-9e0c-d77f4af49fd2"><p class="p">Parentheses ( ).</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idbb1452c7-f290-4641-a418-c8b66763ee45"><p class="p"><a class="xref fm:HeadingOnly" href="General_ConditionalExpressions_ide027a325.html#ide027a325-8bb9-4a37-8131-9256af5f6d60__General_ConditionalExpressions_ide027a325.xml#ide027a325-8bb9-4a37-8131-9256af5f6d60" title="A conditional expression is a way to specify an if/then expression within a DFM expression—it returns one result if the specified condition is true and another result if the condition is false. You can use conditional expressions in the DFM expressions within DFM Analyze, DFM Spec Fill Optimizer, DFM Property and its related operations, and DFM Function.">Conditional Expressions</a>. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idcf61dcc2-7343-4f38-ae18-fe8c813c525b"><p class="p">Another user-defined function
created by DFM Function.</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id4286351e-76b8-43ba-ad37-9df67b739160"><p class="p"><a class="xref fm:HeadingOnly" href="Contain_DfmProperties_id7d747680.html#id7d747680-cd5f-44d1-8f88-3950d906f6cf__Contain_DfmProperties_id7d747680.xml#id7d747680-cd5f-44d1-8f88-3950d906f6cf" title="DFM properties are a form of metadata associated with objects on derived layers. They are often numerical values used for calculating scores and filtering data. Some operations support net number, string, and vector properties. Each property has a name and a value.">DFM Properties</a>. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id6bd14117-a2b6-4a94-bfb1-c15d23b913e4"><p class="p">Most <a class="xref fm:HeadingOnly" href="Contain_MeasurementFunctions_id13468c08.html#id13468c08-797c-4cca-8773-611a15322186__Contain_MeasurementFunctions_id13468c08.xml#id13468c08-797c-4cca-8773-611a15322186" title="Measurement functions calculate the value of a geometric attribute of layer data. Measurement functions return values expressed in user units. Although the COUNT function does not measure a geometric attribute, it is included with the measurement functions because it behaves similarly to the other functions in this class.">Measurement Functions</a>. The per-shape functions are not
supported. </p>
</li>
</ul>
<p class="p">The usual rules of operator
precedence apply, and parentheses may be used to establish precedence
in the calculation. For more information on expressions, refer to “<a class="xref fm:HeadingAndPage" href="Contain_DfmExpressions_id0aa735bd.html#id0aa735bd-eb6a-446d-9da0-f14de5e1332e__Contain_DfmExpressions_id0aa735bd.xml#id0aa735bd-eb6a-446d-9da0-f14de5e1332e" title="DFM Expressions are used to calculate DFM properties, define an analysis or density function, or specify a user-defined function. They can be used to calculate scores, statistics, and measurement values based on layer data. DFM Expressions are used in DFM Analyze, the DFM Property operation family, DFM Function, and DFM Spec Fill Optimizer.">DFM Expressions</a>”.</p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idcff4dcab-4c2e-45ab-aa55-21cc06782299"><p class="p">If an expression calls other
DFM Function functions, the declared argument types match.</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idce022a4c-b453-404c-a665-446180e5ad92"><p class="p">Expressions for DFM Function
cannot call other DFM Functions recursively, regardless of whether
the recursion is finite or infinite.</p>
</li>
</ul>
<p class="p">Additional restrictions may
come from the context in which the function is used. Also see “<a class="xref fm:HeadingAndPage" href="General_DfmFuncDfmFunctionSupport_id11f4ca8f.html#id11f4ca8f-c71b-4e69-bfef-3f0f21e91035__General_DfmFuncDfmFunctionSupport_id11f4ca8f.xml#id11f4ca8f-c71b-4e69-bfef-3f0f21e91035" title="The built-in function and DFM expression support for the DFM Function statement is summarized here.">DFM Function Statement: Function and Expression Support</a>”.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id106aa308-e810-444a-895c-fd3a8c36704d"><span class="keyword ParameterName Required">MATRIX</span> <span class="keyword ParameterName RequiredReplaceable">matrix_specification</span></dt>
<dd class="dd ArgumentDescription"><p class="p">A keyword and argument that
specify a multidimensional table that is used to calculate the function
results. A function of N variables F(X<span class="ph FontProperty LiteralSubScript">1</span>,
X<span class="ph FontProperty LiteralSubScript">2</span>,
… X<span class="ph FontProperty VariableSubScript">N</span>)
is defined by a set of values which are specified on a N-dimensional
coordinate grid. </p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id9289d139-a8fd-49e7-80bf-930d0373494f"><p class="p Opt"><span class="keyword ParameterName RequiredReplaceable">matrix_specification</span> —
Defines the N-dimensional coordinate grid and the function values
for the grid points. Linear interpolation is used to determine function
values for input values that fall between defined grid points but
are still within the bounds of the defined grid. </p>
</li>
</ul>
<p class="p">The format of the <span class="keyword ParameterName RequiredReplaceable">matrix_specification</span> is
given in “<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id0278cc24-51e5-4079-ad25-0abfe2d2103e">MATRIX Specification, Usage, and Behavior in DFM Function</a>” in the
“Description” section. </p>
</dd>
<dt class="dt ArgumentName dlterm" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idd3fcb1ae-bbab-4d25-9cd5-c6f2d36a9423"><span class="keyword ParameterName Required">TVF_NUMber_FUNction</span>'('<span class="keyword ParameterName RequiredReplaceable">tcl_proc</span> ',' <span class="keyword ParameterName RequiredReplaceable">TVF_function</span>')' |</dt>
<dd class="dd ArgumentDescription"><p class="p"><span class="keyword ParameterName Required">TVF_STRING_FUNction</span>'('<span class="keyword ParameterName RequiredReplaceable">tcl_proc</span> ',' <span class="keyword ParameterName RequiredReplaceable">TVF_function</span>')'</p>
<p class="p">Keywords and arguments that
specify a Tcl procedure that produces the function results. The
Tcl procedure is defined within a TVF Function block.</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id7d485d8f-e121-494b-9772-47eaff131033"><p class="p Opt"><span class="keyword ParameterName RequiredReplaceable">tcl_proc</span> —
The name of the Tcl procedure.</p>
</li>
<li class="li ArgOption" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idbf338240-c3c0-46ce-8fae-2764d1742a2e"><p class="p Opt"><span class="keyword ParameterName RequiredReplaceable">TVF_function </span>—
The name of the TVF Function block containing the procedure.</p>
</li>
</ul>
<p class="p">Tcl procedures called from
a DFM Function statement must return a numeric or string value,
determined by the choice of <span class="keyword ParameterName Required">TVF_NUMber_FUNction</span> or <span class="keyword ParameterName Required">TVF_STRING_FUNction</span>.
They cannot call other DFM functions. The only supported built-in
function is tvf::svrf_var; the Tcl procedure cannot call other built-in
functions within Calibre (such as other functions in the tvf:: namespace
or functions in the device:: namespace). Each Tcl procedure can
be used by only one DFM Function. DFM Function statements that call
Tcl procedures may be used in <a class="xref fm:HeadingOnly" href="Command_DfmProperty_idf1f176c5.html#idf1f176c5-0d5a-4406-95d0-b54438157ae8__Command_DfmProperty_idf1f176c5.xml#idf1f176c5-0d5a-4406-95d0-b54438157ae8" title="Associates user-defined properties to individual objects on the input layer and creates a derived layer containing only those objects that meet the specified criteria.">DFM Property</a> and <a class="xref fm:HeadingOnly" href="Command_DfmAnalyze_id1ca0eb21.html#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289__Command_DfmAnalyze_id1ca0eb21.xml#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289" title="Identifies areas on a layout where manufacturing yield can potentially be improved.">DFM Analyze</a> operations and in some commands
within the built-in languages for devices. </p>
<p class="p">See “<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id8c38c00e-ac25-49f1-a303-ad06f02d166d">TVF_NUMber_FUNction and TVF_STRING_FUNction in DFM Function</a>” in the
“Description” section for complete information. </p>
</dd>
</dl>
</div>
</div>
<div class="section Descriptions"><h2 class="title Subheading sectiontitle">Description</h2><p class="p">Creates a user-defined function
that can be used in expressions for <a class="xref fm:HeadingOnly" href="Command_DfmAnalyze_id1ca0eb21.html#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289__Command_DfmAnalyze_id1ca0eb21.xml#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289" title="Identifies areas on a layout where manufacturing yield can potentially be improved.">DFM Analyze</a>, <a class="xref fm:HeadingOnly" href="Command_DfmProperty_idf1f176c5.html#idf1f176c5-0d5a-4406-95d0-b54438157ae8__Command_DfmProperty_idf1f176c5.xml#idf1f176c5-0d5a-4406-95d0-b54438157ae8" title="Associates user-defined properties to individual objects on the input layer and creates a derived layer containing only those objects that meet the specified criteria.">DFM Property</a>, other DFM Function definitions,
and anywhere a math function, such as exp(), can be used.</p>
<p class="p">The validity of a DFM Function
is defined in part by the context in which the function is used. For
example, a user-defined function used in a DFM Analyze operation
cannot contain the ANGLE measurement function. If using DFM Function
to re-define a built-in function, the <span class="keyword ParameterName RequiredReplaceable">function_name</span> must
be different than the built-in function name.</p>
<p class="p">These subsections are included:</p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idfd02c629-d6ff-4379-bbc4-56011befc898"><p class="p">“<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id349b318d-2d1e-4866-ac46-159389d861b2">Using Measurement Functions with DFM Function</a>”</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id638314ae-9002-44d5-a2bb-e4fd810980e1"><p class="p">“<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id93a36917-d073-4a7f-85ba-1b0bde9a5281">Debugging DFM Function Statements</a>”</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id52864c5f-a338-441f-b130-6bad7410c417"><p class="p">“<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id0278cc24-51e5-4079-ad25-0abfe2d2103e">MATRIX Specification, Usage, and Behavior in DFM Function</a>”</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id6a93d326-ee05-48da-8f17-4a0e7b3d453a"><p class="p">“<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id8c38c00e-ac25-49f1-a303-ad06f02d166d">TVF_NUMber_FUNction and TVF_STRING_FUNction in DFM Function</a>”</p>
</li>
</ul>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id349b318d-2d1e-4866-ac46-159389d861b2"><h2 class="title Subheading sectiontitle">Using
Measurement Functions with DFM Function</h2><p class="p">You can use the measurement functions in
either of the following two ways:</p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idad1fbfac-443d-4105-a742-9d8428b0debd"><p class="p">You can include measurement functions
in the expression that defines the function value.</p>
<pre class="pre codeblock leveled"><code>DFM FUNCTION [ MyFunction(LAYER LayerName, NUMBER X) 
    (AREA(LayerName)-EXP(-X))/(EXP(X)+EXP(-X)) 
]</code></pre><p class="p">The measurement functions used in a DFM Function
statement must be valid in the context in which the user-defined
function is called. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__ide32868fb-0425-40ef-bb4c-37143d2d777b"><p class="p">You can use a measurement function call
as an argument that you pass to a DFM function, if that argument
is defined to be type NUMBER. For example, the result of AREA(M1)
is passed as a numeric argument to the user-defined function:</p>
<pre class="pre codeblock leveled"><code>DFM PROPERTY M1 [A2 = MyOtherFunction(AREA(M1)) ]

DFM FUNCTION [ MyOtherFunction(NUMBER X) 
    TABLE { 0 0 1 1 2 1.19 3 1.32 4 1.41 5 1.50 6 1.57 7 1.63
            8 1.68 9 1.73 10 1.78 } ]</code></pre></li>
</ul>
</div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id93a36917-d073-4a7f-85ba-1b0bde9a5281"><h2 class="title Subheading sectiontitle">Debugging
DFM Function Statements</h2><p class="p">Note that DFM Function statements
are parsed only when they are used in an expression that itself
must be parsed, such as those in <a class="xref fm:HeadingOnly" href="Command_DfmAnalyze_id1ca0eb21.html#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289__Command_DfmAnalyze_id1ca0eb21.xml#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289" title="Identifies areas on a layout where manufacturing yield can potentially be improved.">DFM Analyze</a> or <a class="xref fm:HeadingOnly" href="Command_DfmProperty_idf1f176c5.html#idf1f176c5-0d5a-4406-95d0-b54438157ae8__Command_DfmProperty_idf1f176c5.xml#idf1f176c5-0d5a-4406-95d0-b54438157ae8" title="Associates user-defined properties to individual objects on the input layer and creates a derived layer containing only those objects that meet the specified criteria.">DFM Property</a> commands, or in another DFM Function
specification. Therefore, DFM Function statements that are defined
in an SVRF file but not referenced are not evaluated for either
syntactical correctness or validity. Note the following when debugging
a DFM Function: </p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idf4c2f4ca-d41f-4a93-ac75-63ac5514d047"><p class="p">Warning and error messages relevant to
your DFM Function definition only show up within the transcript
information for the operation in which it was called.</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id118e9236-e042-47b9-9348-89bf9a99a991"><p class="p">The validity of a DFM function depends
on the context in which it is used. This means a DFM function that
is valid in one context can be invalid in another context. While debugging
DFM functions, be sure to check the context in which the function
is called.</p>
</li>
</ul>
</div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id0278cc24-51e5-4079-ad25-0abfe2d2103e"><h2 class="title Subheading sectiontitle">MATRIX
Specification, Usage, and Behavior in DFM Function</h2><p class="p">The <span class="keyword ParameterName Required">MATRIX</span> keyword
specifies to represent the user-defined function with a multidimensional
table. The <span class="keyword ParameterName RequiredReplaceable">matrix_specification</span> parameter
specifies the coordinate grid and function values. Linear interpolation
is used to calculate function values that are not explicitly defined
in the multidimensional table. </p>
<p class="p">A function of N variables F(X<span class="ph FontProperty LiteralSubScript">1</span>,
X<span class="ph FontProperty LiteralSubScript">2</span>,
… X<span class="ph FontProperty VariableSubScript">N</span>)
is defined by a set of values that are specified on a N-dimensional
coordinate grid X<span class="ph FontProperty VariableSubScript"><span class="ph FontProperty LiteralSubScript">1</span></span>,
… X<span class="ph FontProperty VariableSubScript">N</span>.
The defined grid points for each dimension are noted as x<span class="ph FontProperty VariableSubScript">i</span><span class="ph FontProperty LiteralSubScript">1</span>,
x<span class="ph FontProperty VariableSubScript">i</span><span class="ph FontProperty LiteralSubScript">2</span>,
… x<span class="ph FontProperty LiteralSubScript"><span class="ph FontProperty VariableSubScript">im</span></span>,
where <span class="keyword ParameterName OptionalReplaceable">i</span> is
the dimension and <span class="keyword ParameterName OptionalReplaceable">m</span> is
the number of grid points for the <span class="keyword ParameterName OptionalReplaceable">i</span><span class="ph FontProperty LiteralSuperScript">th</span> dimension.
For each dimension, the coordinate values must be specified in monotonically increasing
order. That is, for each dimension <span class="keyword ParameterName OptionalReplaceable">i</span>,
x<span class="ph FontProperty VariableSubScript">i</span><span class="ph FontProperty LiteralSubScript">1</span> &lt;
x<span class="ph FontProperty VariableSubScript">i</span><span class="ph FontProperty LiteralSubScript">2</span> &lt;
x<span class="ph FontProperty VariableSubScript">i</span><span class="ph FontProperty LiteralSubScript">3 </span>&lt;
… &lt; x<span class="ph FontProperty VariableSubScript">im</span>. </p>
<p class="p">The format of the <span class="keyword ParameterName RequiredReplaceable">matrix_specification</span> is
as follows:</p>
<pre class="pre codeblock"><code>'{' x<span class="ph FontProperty VariableSubScript"><span class="ph FontProperty LiteralSubScript">11</span></span> [,] x<span class="ph FontProperty LiteralSubScript">12</span> [,] ... x<span class="ph FontProperty VariableSubScript">1p</span> '}' [,]     // grid points for each dimension
'{' x<span class="ph FontProperty LiteralSubScript">21</span> [,] x<span class="ph FontProperty LiteralSubScript">22</span> [,] ... x<span class="ph FontProperty VariableSubScript">2q</span> '}' [,]     // in ascending order
'{' x<span class="ph FontProperty LiteralSubScript">31</span> [,] x<span class="ph FontProperty LiteralSubScript">32</span> [,] ... x<span class="ph FontProperty VariableSubScript">3r</span> '}' [,]
  ...
'{' x<span class="ph FontProperty VariableSubScript">N1</span> [,] x<span class="ph FontProperty VariableSubScript">N2</span> [,] ... x<span class="ph FontProperty VariableSubScript">Ns</span> '}' 
::                                    // start of function values</code></pre><pre class="pre codeblock"><code>'{' F(<span class="ph CodeHighlight orange">x<span class="ph FontProperty LiteralSubScript">11</span></span>, x<span class="ph FontProperty LiteralSubScript">21</span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]       // F() for each X<span class="ph FontProperty LiteralSubScript">1</span> point with other 
    F(<span class="ph CodeHighlight orange">x<span class="ph FontProperty LiteralSubScript">12</span></span>, x<span class="ph FontProperty LiteralSubScript">21</span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]       // grid points fixed at the 
    ...                               // first value
    F(<span class="ph CodeHighlight orange">x<span class="ph FontProperty VariableSubScript">1p</span></span>, x<span class="ph FontProperty LiteralSubScript">21</span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) '}' [,]</code></pre><pre class="pre codeblock"><code>'{' F(x<span class="ph FontProperty LiteralSubScript">11</span>, <span class="ph CodeHighlight orange">x<span class="ph FontProperty LiteralSubScript">22</span></span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]       // repeat, but with X<span class="ph FontProperty LiteralSubScript">2</span> at  
    F(x<span class="ph FontProperty LiteralSubScript">12</span>, <span class="ph CodeHighlight orange">x<span class="ph FontProperty LiteralSubScript">22</span></span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty LiteralSubScript">N1</span>) [,]       // the second grid point
    ... 
    F(x<span class="ph FontProperty VariableSubScript">1p</span>, <span class="ph CodeHighlight orange">x<span class="ph FontProperty LiteralSubScript">22</span></span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty LiteralSubScript">N1</span>) '}' [,] 
    ...</code></pre><pre class="pre codeblock"><code>'{' F(x<span class="ph FontProperty LiteralSubScript">11</span>, <span class="ph CodeHighlight orange">x<span class="ph FontProperty VariableSubScript">2q</span></span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]       // continue through all X<span class="ph FontProperty LiteralSubScript">2</span>
    F(x<span class="ph FontProperty LiteralSubScript">12</span>, <span class="ph CodeHighlight orange">x<span class="ph FontProperty VariableSubScript">2q</span></span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]       // grid points
    ...
    F(x<span class="ph FontProperty VariableSubScript">1p</span>, <span class="ph CodeHighlight orange">x<span class="ph FontProperty VariableSubScript">2q</span></span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) } [,]</code></pre><pre class="pre codeblock"><code>'{' F(x<span class="ph FontProperty LiteralSubScript">11</span>, x<span class="ph FontProperty LiteralSubScript">21</span>, <span class="ph CodeHighlight orange">x<span class="ph FontProperty LiteralSubScript">32</span></span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]       // move to second X<span class="ph FontProperty LiteralSubScript">3</span> grid point
    F(x<span class="ph FontProperty LiteralSubScript">12</span>, x<span class="ph FontProperty LiteralSubScript">21</span>, <span class="ph CodeHighlight orange">x<span class="ph FontProperty LiteralSubScript">32</span></span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]       // and continue process
    ...
    F(x<span class="ph FontProperty VariableSubScript">1p</span>, x<span class="ph FontProperty LiteralSubScript">21</span>, <span class="ph CodeHighlight orange">x<span class="ph FontProperty LiteralSubScript">32</span></span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) '}' [,]</code></pre><pre class="pre codeblock"><code>'{' F(x<span class="ph FontProperty LiteralSubScript">11</span>, x<span class="ph FontProperty LiteralSubScript">22</span>, x<span class="ph FontProperty LiteralSubScript">32</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]
    F(x<span class="ph FontProperty LiteralSubScript">12</span>, x<span class="ph FontProperty LiteralSubScript">22</span>, x<span class="ph FontProperty LiteralSubScript">32</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]
    ...
    F(x<span class="ph FontProperty VariableSubScript">1p</span>, x<span class="ph FontProperty LiteralSubScript">22</span>, x<span class="ph FontProperty LiteralSubScript">32</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) '}' [,]
    ...</code></pre><pre class="pre codeblock"><code>'{' F(x<span class="ph FontProperty LiteralSubScript">11</span>, x<span class="ph FontProperty VariableSubScript">2q</span>, x<span class="ph FontProperty LiteralSubScript">32</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]
    F(x<span class="ph FontProperty LiteralSubScript">12</span>, x<span class="ph FontProperty VariableSubScript">2q</span>, x<span class="ph FontProperty LiteralSubScript">32</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span>) [,]
    ...
    F(x<span class="ph FontProperty VariableSubScript">1p</span>, x<span class="ph FontProperty VariableSubScript">2q</span>, x<span class="ph FontProperty LiteralSubScript">32</span>, ... x<span class="ph FontProperty VariableSubScript">N1</span> }[,]
    ...</code></pre><pre class="pre codeblock"><code>'{' F(x<span class="ph FontProperty LiteralSubScript">11</span>, x<span class="ph FontProperty LiteralSubScript">21</span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">Ns</span>) [,]
    F(x<span class="ph FontProperty LiteralSubScript">12</span>, x<span class="ph FontProperty LiteralSubScript">21</span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">Ns</span>) [,]
    ...  
    F(x<span class="ph FontProperty VariableSubScript">1p</span>, x<span class="ph FontProperty LiteralSubScript">21</span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">Ns</span>) '}' [,]</code></pre><pre class="pre codeblock"><code>'{' F(x<span class="ph FontProperty LiteralSubScript">11</span>, x<span class="ph FontProperty LiteralSubScript">22</span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">Ns</span>) [,]
    F(x<span class="ph FontProperty LiteralSubScript">12</span>, x<span class="ph FontProperty LiteralSubScript">22</span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">Ns</span>) [,]
    ...
    F(x<span class="ph FontProperty VariableSubScript">1p</span>, x<span class="ph FontProperty LiteralSubScript">23</span>, x<span class="ph FontProperty LiteralSubScript">31</span>, ... x<span class="ph FontProperty VariableSubScript">Ns</span>) '}' [,]
    ...</code></pre><pre class="pre codeblock"><code>'{' F(x<span class="ph FontProperty LiteralSubScript">11</span>, x<span class="ph FontProperty VariableSubScript">2q</span>, x<span class="ph FontProperty VariableSubScript">3r</span>, ... x<span class="ph FontProperty VariableSubScript">Ns</span>) [,]      // end  by cycling through X<span class="ph FontProperty LiteralSubScript">1</span> points  
    F(x<span class="ph FontProperty LiteralSubScript">12</span>, x<span class="ph FontProperty VariableSubScript">2q</span>, x<span class="ph FontProperty VariableSubScript">3r</span>, ... x<span class="ph FontProperty VariableSubScript">Ns</span>) [,]     // with all other grid points at  
    ...                             // their largest values
    F(x<span class="ph FontProperty VariableSubScript">1p</span>, x<span class="ph FontProperty VariableSubScript">2q</span>, x<span class="ph FontProperty VariableSubScript">3r</span>, ... x<span class="ph FontProperty VariableSubScript">Ns</span>) '}'</code></pre><p class="p">In this specification, the
braces enclosed in single quotes, '{' and '}', are literal and must
be included. These braces delimit the “rows” of the matrix, and
the line breaks are ignored, as is the case with SVRF in general.
The commas in brackets are optional but can be used to improve readability.</p>
<p class="p">For an N-dimensional table,
the first N rows contain the coordinates of the grid points on which the
function is specified. The first row contains the grid values of
the first coordinate, X<span class="ph FontProperty LiteralSubScript">1</span>:
x<span class="ph FontProperty LiteralSubScript">11</span>, x<span class="ph FontProperty LiteralSubScript">12</span>,
… x<span class="ph FontProperty VariableSubScript">1p</span>,
where p is the number of table points in the first dimension. Similarly,
the remaining rows from the second to the Nth contain the grid values
of the coordinates in the remaining dimensions. For each dimension,
the coordinate values must be specified in monotonically increasing
order. </p>
<p class="p">The function values are separated
from the coordinates by double colons “::”. The function values
are specified in “row order”, as follows:</p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__ide5112785-0c9c-4276-ab89-7af4a227c1be"><p class="p">The first row of values contains
the function values for all values of coordinate X<span class="ph FontProperty LiteralSubScript">1</span> while coordinates
X<span class="ph FontProperty LiteralSubScript">2</span> …
X<span class="ph FontProperty VariableSubScript">N</span> are
fixed at their lowest values. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id02144332-8c2d-4b33-9c71-2e81b576d9e5"><p class="p">The second row again goes over
all values of X<span class="ph FontProperty LiteralSubScript">1</span>,
X<span class="ph FontProperty LiteralSubScript">2</span> is
advanced to its second value x<span class="ph FontProperty LiteralSubScript">22</span>, and
the rest of the coordinates are at their lowest values. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idb1678334-bd23-41a0-9791-faf0c1c5fd2c"><p class="p">After all function values for
all values of X<span class="ph FontProperty LiteralSubScript">1</span> and
X<span class="ph FontProperty LiteralSubScript">2</span> are
specified this way, the procedure is repeated for X<span class="ph FontProperty LiteralSubScript">3</span> set
to its second value x<span class="ph FontProperty LiteralSubScript">32</span>,
and so on. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id881330c7-fd1e-4791-9361-cda43aba0938"><p class="p">The last row contains function
values for all values of X<span class="ph FontProperty LiteralSubScript">1</span> and
the largest values of X<span class="ph FontProperty LiteralSubScript">2</span> … X<span class="ph FontProperty VariableSubScript">N</span>.</p>
</li>
</ul>
<p class="p">For example, the following
function specifies a 3-dimensional table on a 3×3×3 grid:</p>
<pre class="pre codeblock"><code>DFM FUNCTION [ F( NUMBER X, NUMBER Y, NUMBER Z ) 
    MATRIX 
      { 1, 2, 3 }         // X dimension grid points, in order
      { 4, 5, 6 }         // Y dimension grid points, in order
      { 7, 8, 9 }         // Z dimension grid points, in order
      ::               // function values
      { 147  247, 347 }   // F(1, 4, 7) F(2, 4, 7) F(3, 4, 7)
      { 157  257  357 }   // F(1, 5, 7) F(2, 5, 7) F(3, 5, 7)
      { 167  267  367 }   // F(1, 6, 7) F(2, 6, 7) F(3, 6, 7)
      { 148  248  348 }   // F(1, 4, 8) F(2, 4, 8) F(3, 4, 8)
      { 158  258  358 }   // F(1, 5, 8) F(2, 5, 8) F(3, 5, 8)
      { 168  268  368 }   // F(1, 6, 8) F(2, 6, 8) F(3, 6, 8)
      { 149  249  349 }   // F(1, 4, 9) F(2, 4, 9) F(3, 4, 9)
      { 159  259  359 }   // F(1, 5, 9) F(2, 5, 9) F(3, 5, 9)
      { 169  269  369 }   // F(1, 6, 9) F(2, 6, 9) F(3, 6, 9)
  ] </code></pre><p class="p">If all function arguments match
one of the specified grid points, the result of the function is
the value specified in the table for that set of coordinates. If
the function arguments fall between specified grid points, the function
value is calculated using linear interpolation. </p>
<p class="p">By default, if the specified
N-dimensional point falls outside of the table in at least one dimension,
the expression evaluation fails and the following warning is issued:</p>
<pre class="pre codeblock"><code>WARNING:  Expression(s) with at least one evaluation failure:
In rule file &lt;file name&gt; at line &lt;line&gt; (in operation DFM PROPERTY):
Coordinate out-of-range when evaluating a MATRIX</code></pre><p class="p">When using the user-defined function within a DFM Property operation,
you can use an expression chain to prevent evaluation failure. See “<a class="xref fm:HeadingAndPage" href="Concept_ExpressionChains_id36d0f74a.html#id36d0f74a-ee22-45ad-bbe8-5b9c9ce99fb0__Concept_ExpressionChains_id36d0f74a.xml#id36d0f74a-ee22-45ad-bbe8-5b9c9ce99fb0" title="An expression chain is a series of expressions used to define a single DFM property. Expression chains are only used in the DFM Property family of operations. The value of the property is defined as the result of the first expression (evaluated left to right) that was successfully evaluated. An expression chain can be used to assign a default value for a property and protect against evaluation failure. If none of the expressions in the chain are successfully evaluated for a given property name, the expression evaluation fails and the layout object on the primary layer is not copied to the output layer.">Expression Chains</a>” and “<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id5d720c8e-1ace-4637-b8cc-368fd48ed19c">Example 5</a>”.</p>
<p class="p">The following syntax checks
are performed:</p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idc8c359b3-7baa-4209-a2f2-0066b9355589"><p class="p">In the function call, a value
must be provided for each of the N input variables (also termed
coordinate values).</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id816816d2-a882-490c-be74-61008e90d7bd"><p class="p">In the matrix definition,
the coordinate values for each dimension must be sorted in ascending
order.</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id393dfeed-8940-46cc-b268-c3f6d2136efb"><p class="p">The number of function values
in the matrix definition must equal the product of the number of
grid points in each dimension. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idb72827b1-3c56-4f20-a96b-419733d182c8"><p class="p">The number of columns must
equal the number of grid points in the first dimension.</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idecd3f438-7b62-4976-9b1e-75ad18e7e820"><p class="p">The number of rows must equal
the product of the number of grid points in each dimension from
the second to the last.</p>
</li>
</ul>
<p class="p">See “<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id5d720c8e-1ace-4637-b8cc-368fd48ed19c">Example 5</a>” for use
of a MATRIX function in a DFM Property operation. MATRIX functions
can also be used in the function <a class="xref fm:HeadingOnly" href="Command_BILDfmDeviceEvalDfmFunc_idf250824b.html#idf250824b-7f8f-474b-86ad-96518913c75c__Command_BILDfmDeviceEvalDfmFunc_idf250824b.xml#idf250824b-7f8f-474b-86ad-96518913c75c" title="Enables access to DFM Function TABLE and MATRIX functions to assign device property values.">device::eval_dfm_func</a> in the
Device annotation built-in language, as well as in DFM Analyze operation. </p>
</div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id8c38c00e-ac25-49f1-a303-ad06f02d166d"><h2 class="title Subheading sectiontitle">TVF_NUMber_FUNction
and TVF_STRING_FUNction in DFM Function</h2><p class="p">The <span class="keyword ParameterName Required">TVF_NUMber_FUNction</span> and <span class="keyword ParameterName Required">TVF_STRING_FUNction</span> keyword
sets specify a Tcl procedure that is called for the user-defined
function. The Tcl procedure is defined within a TVF Function block.
Tcl procedures called from a DFM Function statement must return
a numeric or string value, determined by the keyword choice:</p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idca760570-1af7-4ff6-92e6-53f95a41dc2f"><p class="p"><span class="keyword ParameterName Required">TVF_NUMber_FUNction</span>'('<span class="keyword ParameterName RequiredReplaceable">tcl_proc</span> ',' <span class="keyword ParameterName RequiredReplaceable">TVF_function</span>')'
— Returns a number. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idd6445c5e-c807-4fdf-8beb-47d461fbb47e"><p class="p"><span class="keyword ParameterName Required">TVF_STRING_FUNction</span>'('<span class="keyword ParameterName RequiredReplaceable">tcl_proc</span> ',' <span class="keyword ParameterName RequiredReplaceable">TVF_function</span>')'
— Returns a string.</p>
</li>
</ul>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id80fd57e0-eaac-424e-b073-90a922c61fa2"><p class="p"><span class="keyword ParameterName RequiredReplaceable">tcl_proc</span> —
The name of the Tcl procedure.</p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id0efc425e-492a-460e-8d75-520414821728"><p class="p"><span class="keyword ParameterName RequiredReplaceable">TVF_function </span>—
The name of the <a class="xref fm:HeadingOnly" href="Command_TVFFunction_id7a9f1c9b.html#id7a9f1c9b-4b64-4768-8e1a-ca6b448bb1a7__Command_TVFFunction_id7a9f1c9b.xml#id7a9f1c9b-4b64-4768-8e1a-ca6b448bb1a7" title="Defines a function block of Tcl code.">TVF Function</a> block
containing the procedure.</p>
</li>
</ul>
<p class="p">User-defined functions that call Tcl procedures may be used only
in <a class="xref fm:HeadingOnly" href="Command_DfmProperty_idf1f176c5.html#idf1f176c5-0d5a-4406-95d0-b54438157ae8__Command_DfmProperty_idf1f176c5.xml#idf1f176c5-0d5a-4406-95d0-b54438157ae8" title="Associates user-defined properties to individual objects on the input layer and creates a derived layer containing only those objects that meet the specified criteria.">DFM Property</a> and <a class="xref fm:HeadingOnly" href="Command_DfmAnalyze_id1ca0eb21.html#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289__Command_DfmAnalyze_id1ca0eb21.xml#id1ca0eb21-bd76-4f8e-89f7-9b74a6058289" title="Identifies areas on a layout where manufacturing yield can potentially be improved.">DFM Analyze</a> operations. See the end of this
section for other restrictions. </p>
<h2 class="title Subheading sectiontitle">Argument Passing with TVF Functions</h2><p class="p">The arguments of the user-defined
function are passed to the Tcl procedure as TVF objects, with one
object per argument. There are separate objects for each argument
type; however, you cannot pass LAYER arguments to a Tcl procedure.</p>
<p class="p">To access any argument, the
corresponding object must be evaluated by placing the object within
brackets ([ ]) and the result assigned to a variable. This example
has NUMBER, STRING, and NETID arguments. </p>
<pre class="pre codeblock"><code>DFM FUNCTION [ F( NUMBER N, STRING S, NETID N_ID ) 
    TVF_NUM_FUN( myproc, mylib ) ]

TVF FUNCTION mylib [/*
    proc myproc { <span class="ph CodeHighlight orange">n_</span>  <span class="ph CodeHighlight green">s_ </span> <span class="ph CodeHighlight purple">net_id_</span> } { 
      # Access number, string, and netid arguments
      <span class="ph CodeHighlight orange">set n [$n_]</span>  
      <span class="ph CodeHighlight green">set s [$s_]</span>  
      <span class="ph CodeHighlight purple">set net_id [$net_id_]</span>
      set ret_val $n         
      # other processing on ret_val
      # The $n, $s, and $n variables can used as any other Tcl variable.
      return $ret_val
    }
*/]</code></pre><p class="p">The objects that provide access
to vector, string vector, and vnetID arguments support several subcommands
that return vector properties and values. </p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idcfc312e2-6bbc-4383-928b-6a702accdbda"><p class="p"><span class="keyword ParameterName OptionalReplaceable">vector_object</span> tuple_count
— Returns the number of tuples. This corresponds to the number of
rows in a 2-D matrix. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id45b60161-3d27-47ba-b515-f0b6afdef5a7"><p class="p"><span class="keyword ParameterName OptionalReplaceable">vector_object</span> tuple_size
— Returns the tuple size. This corresponds to the number of columns
in a 2-D matrix. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id1c9504b9-08ae-4152-b797-7e4b0439388b"><p class="p"><span class="keyword ParameterName OptionalReplaceable">vector_object</span> value <span class="keyword ParameterName OptionalReplaceable">i j</span> —
Returns the <span class="keyword ParameterName OptionalReplaceable">j</span>-th
value in the <span class="keyword ParameterName OptionalReplaceable">i</span>-th
tuple. Indices are zero-based. <span class="keyword ParameterName OptionalReplaceable">i</span> and <span class="keyword ParameterName OptionalReplaceable">j</span> can
also be thought of as the row and column, respectively, in a 2-D
matrix.</p>
</li>
</ul>
<p class="p">The tuple_count and tuple_size values are returned as double-precision
floating-point numbers. If an integer type is needed, use a Tcl
function such as int or round to convert the value to an integer. </p>
<p class="p">For example, the following
code accepts vector input. The tuple_count and tuple_size values
are converted to integers. The function returns the last vector
element. </p>
<pre class="pre codeblock"><code>DFM FUNCTION [ VLAST( VECTOR V ) 
    TVF_NUM_FUN( myproc, mylib ) ]

TVF FUNCTION mylib [/*
    proc myproc { v_ } { 
      # Access vector data, return last value
      set count [expr {int([$v_ <span class="ph CodeHighlight orange">tuple_count</span>])}]
      set size  [expr {int([$v_ <span class="ph CodeHighlight orange">tuple_size</span>])}]
      set x [$v_ <span class="ph CodeHighlight orange">value</span> [expr {$count - 1}]  [expr {$size - 1}] ]

      return $x
    }
*/]</code></pre><p class="p">See “<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__idd9100df0-0f75-4b55-a2cb-5f53f6106b9d">Example 6</a>”. Also see “<a class="xref fm:HeadingAndPage" href="Concept_VectorDFMProperties_idf6ea0cc7.html#idf6ea0cc7-cf94-4e41-a273-eb69f35eed95__Concept_VectorDFMProperties_idf6ea0cc7.xml#idf6ea0cc7-cf94-4e41-a273-eb69f35eed95" title="A vector is a two-dimensional array (or matrix) of numbers composed of tuples. Some DFM properties may be vectors.">Vector DFM Properties</a>”, which
includes a more general function for accessing vector elements.
When using a DFM Property operation, the vector access functions
VELEMENT, SVELEMENT, and NETVELEMENT may be a useful alternative
to using the vector object within a Tcl procedure.</p>
<p class="p">See “<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id13afe6c0-59af-4403-b3cc-9d73f1d75250">Example 7</a>” and “<a class="xref fm:HeadingAndPage" href="#id879454b1-404a-412a-8094-fb480f5c3a9f__id2cb7de21-d8af-43eb-b013-29dd8d307efc">Example 8</a>” for examples
that process vector string arguments.</p>
<p class="p">The function arguments are
passed to the Tcl procedure in the order specified in the DFM Function
statement. The rule file compiler verifies that a DFM Function is
called with the arguments of the correct type. However, there is
no compile-time verification that the Tcl procedure accesses the
arguments correctly. All Tcl errors, including invalid use of the
TVF objects and out-of-range indices, are detected at run-time.
If a run-time error is detected, an error message is reported in
the transcript and the DFM expression that called the offending DFM
Function fails to evaluate.</p>
<p class="p">These restrictions apply to the procedures called by <span class="keyword ParameterName Required">TVF_NUMber_FUNction</span> and <span class="keyword ParameterName Required">TVF_STRING_FUNction</span>:</p>
<ul class="ul"><li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id060c451d-c94e-4dd7-b994-dcfbbea80fae"><p class="p">They cannot
call other DFM functions. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id76aaa752-fdad-4e59-a3b5-feaaa19b7cff"><p class="p">The only supported
built-in function is tvf::svrf_var; the Tcl procedure cannot call
other built-in functions within Calibre (such as other functions
in the tvf:: namespace or functions in the device:: namespace). </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id3991d046-0134-4cda-8c99-925f3be8d7fb"><p class="p">The Tcl procedure
definition must not contain default values for the arguments. </p>
</li>
<li class="li" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id2bf2bd75-4ca8-4c27-a980-12db18e1d587"><p class="p">Each Tcl procedure
can be used by only one DFM Function.</p>
</li>
</ul>
</div>
</div>
<div class="section Examples"><h2 class="title Subheading sectiontitle">Examples</h2><div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idbb80c1d4-bbef-4f6d-8103-1e9c033a752d"><h2 class="title Subheading sectiontitle">Example 1</h2><p class="p">The following statement defines
a function F, which takes one numeric argument. The function is
computed by bicubic interpolation of the table, in the range between
0 and 1.</p>
<pre class="pre codeblock"><code>DFM FUNCTION [ F(NUMBER X) TABLE SPLINE
    { 0 0.00 0.1 0.10 0.2 0.20 0.3 0.29 0.4 0.38 0.5 0.46
      0.6 0.54 0.7 0.60 0.8 0.66 0.9 0.72 1.0 0.76 } ]</code></pre><p class="p">Used in <a class="xref fm:HeadingOnly" href="Command_DfmProperty_idf1f176c5.html#idf1f176c5-0d5a-4406-95d0-b54438157ae8__Command_DfmProperty_idf1f176c5.xml#idf1f176c5-0d5a-4406-95d0-b54438157ae8" title="Associates user-defined properties to individual objects on the input layer and creates a derived layer containing only those objects that meet the specified criteria.">DFM Property</a> expressions:</p>
<pre class="pre codeblock"><code>DFM PROPERTY M1 [ A2 = F(AREA(M1)) ]</code></pre></div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id1dca3dee-c78d-4efe-bf17-f477186fc07d"><h2 class="title Subheading sectiontitle">Example 2</h2><p class="p">The following statement defines
the function q using an expression. The input values are all numbers.
The calling environment should ensure c is not equal to 0.</p>
<pre class="pre codeblock"><code>DFM FUNCTION [ q(NUMBER a, NUMBER b, NUMBER c) 
    SQRT(((b-a)/c)^2 + 1) + (b-a)/c 
]</code></pre></div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id2b8363c4-9f26-48ad-83fd-280f6c16775b"><h2 class="title Subheading sectiontitle">Example 3</h2><p class="p">The following statement uses the
hyperbolic tangent function when the value of the argument’s magnitude
lies within a range, otherwise the asymptotic value of the hyperbolic
tangent is returned:</p>
<pre class="pre codeblock"><code>DFM FUNCTION [ TANH1(NUMBER X) 
      (X &lt; 8) ? (x &gt; -8) ? TANH(X) : -1 : 1 
]</code></pre><div class="note note"><span class="notetitle">Note:</span> <p class="p">DFM Function
functions cannot call each other recursively.</p>
</div>
</div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idbf7e0cb3-2658-4c6a-9b3f-ba26a7425863"><h2 class="title Subheading sectiontitle">Example 4</h2><p class="p">The following statement defines
a function P, which requires three parameters and returns a scaled
property value:</p>
<pre class="pre codeblock"><code>DFM FUNCTION [ P(LAYER L, STRING PROPNAME, NUMBER SCALE) 
               PROPERTY(L, PROPNAME) * SCALE ]</code></pre><p class="p">For this function to be valid, the
value of PROPNAME must be the name of a property defined using the <a class="xref fm:HeadingOnly" href="Command_DfmProperty_idf1f176c5.html#idf1f176c5-0d5a-4406-95d0-b54438157ae8__Command_DfmProperty_idf1f176c5.xml#idf1f176c5-0d5a-4406-95d0-b54438157ae8" title="Associates user-defined properties to individual objects on the input layer and creates a derived layer containing only those objects that meet the specified criteria.">DFM Property</a> operation.</p>
</div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id5d720c8e-1ace-4637-b8cc-368fd48ed19c"><h2 class="title Subheading sectiontitle">Example 5</h2><p class="p">The following function specifies
a 3-dimensional matrix on a 2×2×3 grid:</p>
<pre class="pre codeblock"><code>DFM FUNCTION [ M223( NUMBER X, NUMBER Y, NUMBER Z )
              MATRIX 
              { 4, 6 }            // X dimension grid points, in order
              { 1, 2 }            // Y dimension grid points
              { 0.3, 0.5, 0.7 }   // Z dimension grid points
              ::                // function values:
              { 413 613 }         // M223(4, 1, 0.3) M223(6, 1, 0.3)
              { 423 623 }         // M223(4, 2, 0.3) M223(6, 2, 0.3)
              { 415 615 }         // M223(4, 1, 0.5) M223(6, 1, 0.5)
              { 425 625 }         // M223(4, 2, 0.5) M223(6, 2, 0.5)
              { 417 617 }         // M223(4, 1, 0.7) M223(6, 1, 0.7)
              { 427 627 }         // M223(4, 2, 0.7) M223(6, 2, 0.7)
      ]</code></pre><p class="p">The function M223 can be used as follows in a DFM Property operation.
The X, Y, and Z input values are provided by DFM measurement functions.
An expression chain is used to prevent evaluation failure if the
input values are outside the defined grid points. </p>
<pre class="pre codeblock"><code>matrix_val = DFM PROPERTY layer1  layer0
              [ Fval = M223( PERIMETER(layer1), COUNT(layer0), .5 )] 
                       [ Fval = -1]</code></pre></div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__idd9100df0-0f75-4b55-a2cb-5f53f6106b9d"><h2 class="title Subheading sectiontitle">Example 6</h2><p class="p">This example uses TVF_NUMber_FUNction
to call a Tcl procedure.</p>
<p class="p">The first argument is a string that
determines if the tuple count or the average value of all the vector
elements is returned. If its value is “count”, the tuple count is
returned, otherwise the average is returned.</p>
<p class="p">The second argument limits the number
of tuples to consider. If the value is not 0, and the tuple count
is less than the actual count, the number of tuples used is limited
by the argument value.</p>
<p class="p">The third argument is the vector
of numeric values that is processed.</p>
<pre class="pre codeblock"><code>DFM FUNCTION[ get_stat( STRING S, NUMBER N, VECTOR V )
    TVF_NUM_FUNC( get_stat_proc, mylib ) ]</code></pre><pre class="pre codeblock"><code>  TVF FUNCTION mylib [/*
    proc get_stat_proc { type_ limit_ vector_ } {
      set stat_type [$type_]
      set limit [expr {int([$limit_])}]
      set tuple_count [$vector_ tuple_count]
      set tuple_size [$vector_ tuple_size]
      if { $limit != 0 &amp;&amp; $limit &lt; $tuple_count } {
        set tuple_count $limit
      }</code></pre><pre class="pre codeblock"><code>      if {$stat_type == "count"} {
        set rval $tuple_count
      } else {
        set sum 0.0
        for { set i 0 } { $i &lt; $tuple_count } {incr i} {
           for { set j 0 } { $j &lt; $tuple_size } {incr j} {
               set val [ $vector_ value $i $j ]
               set sum [ expr {$sum + $val} ]
           }
        }
        set rval [expr {$sum/($tuple_count * $tuple_size) } ]
      }
      return $rval
    }
*/]</code></pre><p class="p">This function is called in the following DFM Property operation.
The layer vector_layer has a vector property named vec_prop.</p>
<pre class="pre codeblock"><code>stat_props = DFM PROPERTY vector_layer 
   [ vec_prop = VPROPERTY(vector_layer,  vec_prop)]
   [ tuple_count = get_stat("count", 0, VPROPERTY_REF(vec_prop))]  
   [ all_avg = get_stat("avg", 0, VPROPERTY_REF(vec_prop))]</code></pre></div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id13afe6c0-59af-4403-b3cc-9d73f1d75250"><h2 class="title Subheading sectiontitle">Example
7</h2><p class="p">This example determines if the pin names on an OASIS layout are
valid and creates a layer with the invalid pin name and shape. It
uses TVF_STRING_FUNCTION and defines the function VALIDATE_PIN to
determine if the pin names are valid. The function returns an empty
string for valid pin names or the pin name for invalid names. </p>
<pre class="pre codeblock"><code>LAYOUT PATH test.oas
LAYOUT PRIMARY TOP
LAYOUT SYSTEM OASIS

DRC RESULTS DATABASE drc.db

LAYER PIN 0
LAYOUT CELL LIST topcell TOP</code></pre><pre class="pre codeblock"><code>// Return empty string if valid, otherwise return first invalid string 
// (subsequent strings in the vector of strings are not evaluated)
DFM FUNCTION [VALIDATE_PIN(VSTRING V)
   TVF_STRING_FUNCTION("validate_layout_text", "validate")]</code></pre><pre class="pre codeblock"><code>TVF FUNCTION validate [/*
proc validate_layout_text { get_layout_text } {
   set return_val "";
   set count [$get_layout_text tuple_count]
   for {set x 0} { $x &lt; $count} {incr x} {
       set val [ $get_layout_text value $x 0 ]
       set return_val $val;
       set ck [ string compare $val "pwr"];
       if { $ck == 0 } { set return_val "" }
       set ck [ string compare $val "gnd"];
       if { $ck == 0 } { set return_val "" }
       set ck [ string compare $val "gd"];
       if { $ck == 0 } { set return_val "" }
       set ck [ string compare $return_val ""]; 
       if { $ck !=0 } { return $return_val;}
   }
   return $return_val;
}
*/]</code></pre><pre class="pre codeblock"><code>//   find PIN polygons in the original top cell
pin_inside_top = PIN INSIDE CELL TOP PRIMARY ONLY

//   read the property pin_label from all PIN polygons
pin_read = DFM READ PIN PROPERTY STRING pin_label

pin_readf = DFM PROPERTY MERGE pin_inside_top pin_read 
            [PINP = VSTRING(SPROPERTY(pin_read, "pin_label")) ] 

// if INVALID_STR is non-empty, output the shape and property
// along with complete pin label text
invalid_pins = DFM PROPERTY pin_readf 
                   [ label = SVPROPERTY(pin_readf, "PINP")]
                   [ INVALID_STR = VALIDATE_PIN(SVPROPERTY_REF(label)) ]
                   [ - = MATCH(SPROPERTY_REF(INVALID_STR), "^$") ] == 0

error_ck { DFM RDB invalid_pins bad_pins.rdb }</code></pre></div>
<div class="section Subsection" id="id879454b1-404a-412a-8094-fb480f5c3a9f__id2cb7de21-d8af-43eb-b013-29dd8d307efc"><h2 class="title Subheading sectiontitle">Example
8</h2><p class="p">This example processes a layer P1 with attached vector string
properties. If the string vector equals “pwr”, the shape is written
to the output layer MP1. TVF_NUMBER_FUNCTION is used because the
return value is a number. The input arguments are the string vector
and the string to search for. </p>
<pre class="pre codeblock"><code>DFM FUNCTION [F_VSTRCNT(VSTRING vs, STRING str) 
               TVF_NUMBER_FUNCTION("str_find", "strfunc")]</code></pre><pre class="pre codeblock"><code>TVF FUNCTION strfunc [/*
proc str_find {get_vstr get_search_string} {
  set count [$get_vstr tuple_count]
  set search_string [$get_search_string]
     for {set x 0} { $x &lt; $count } {incr x} {
        set strval [$get_vstr value $x 0]
        set ck [string compare $strval $search_string]
        if {$ck == 0} {
           return 1
        }
     }
     return 0
  }
}*/]</code></pre><pre class="pre codeblock"><code>P1 = DFM READ M1 PROPERTY VSTRING "key"
MP1 = DFM PROPERTY MERGE M1 P1 
         [- = F_VSTRCNT(SVPROPERTY(P1, "key"), "pwr")] &gt; 0</code></pre></div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_DfmCommands_ide62291e8.html" title="The commands in this section begin with “DFM.”">DFM … Commands</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "svrf_ur"
                DocTitle = "Standard Verification Rule Format (SVRF) Manual"
                PageTitle = "DFM Function"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Command_DfmFunction_id879454b1.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Standard Verification Rule Format (SVRF) Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>