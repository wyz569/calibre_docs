<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="GeneralRefTopic" />
<meta name="DC.Title" content="TVF Functional Interface for Device Property Calculation" />
<meta name="abstract" content="The TVF functional interface calculates advanced device properties. The Device property computation and annotation languages call Tcl procedures defined in TVF Function statements in the SVRF rule file in order to calculate the properties." />
<meta name="description" content="The TVF functional interface calculates advanced device properties. The Device property computation and annotation languages call Tcl procedures defined in TVF Function statements in the SVRF rule file in order to calculate the properties." />
<meta name="DC.subject" content="TVF, interface for device property calculations" />
<meta name="keywords" content="TVF, interface for device property calculations" />
<meta name="prodname" content="Standard Verification Rule Format (SVRF) Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-26" />
<meta name="Topline" content="Siemens EDA" />
<meta name="VariantPrefix" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="21.2" />
<meta name="HighlightColor" content="mgc_yellow_129_50" />
<meta name="HighlightChanges" content="yes" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="svrf_ur" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="3/25/21" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Standard Verification Rule Format (SVRF) Manual" />
<meta name="CSHelp" content="No" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10089,product.id.P10099,product.id.P10119,product.id.P10101,product.id.P11427,product.id.P10115,product.id.P11426,product.id.P10122,product.id.P11493" />
<meta name="ConditionFiltering" content="XML" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="idea8bad97-46ea-48f8-aec1-7ee829d325cb" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>TVF Functional Interface for Device Property Calculation</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="TVF Functional Interface for Device Property Calculation" />
<meta name="attributes" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10089,product.id.P10099,product.id.P10119,product.id.P10101,product.id.P11427,product.id.P10115,product.id.P11426,product.id.P10122,product.id.P11493" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body class="default" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">TVF Functional Interface for Device Property Calculation</h1>
<div class="body refbody GeneralRefBody"><div class="abstract GeneralRefAbstract"><span class="shortdesc">The TVF
functional interface calculates advanced device properties. The
Device property computation and annotation languages call Tcl procedures
defined in TVF Function statements in the SVRF rule file in order
to calculate the properties.</span>
</div>
<div class="section Subsections"><div class="section Subsection" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__id0b5e5d4d-4ac2-44c0-9e89-d494d9a4df75"><p class="p">The
Tcl procedures employed in the TVF interface may be called through
two functions called TVF_NUMeric_FUNction and TVF_STRING_FUNction.
The difference between these functions is <a class="xref fm:HeadingOnly" href="Command_BILDevPropTvfNumericFunction_id3a059e8f.html#id3a059e8f-46c1-4ea9-8e26-147a4b8fcb57__Command_BILDevPropTvfNumericFunction_id3a059e8f.xml#id3a059e8f-46c1-4ea9-8e26-147a4b8fcb57" title="Provides access to a numeric value returned by a Tcl procedure defined within a TVF Function definition.">tvf_numeric_function</a> returns a numeric value, and <a class="xref fm:HeadingOnly" href="Command_BILDevPropTvfStringFunction_ida7e07a5f.html#ida7e07a5f-8e66-4d0f-a294-d5c2831617e9__Command_BILDevPropTvfStringFunction_ida7e07a5f.xml#ida7e07a5f-8e66-4d0f-a294-d5c2831617e9" title="Provides access to a string value returned by a Tcl procedure defined within a TVF Function definition.">tvf_string_function</a> returns a string value.</p>
<p class="p">Parameters passed to the Tcl procedure consist
of any of the following types:</p>
<ul class="ul"><li class="li" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__id25f522ea-f80c-44ae-8305-128ba1956151"><p class="p">A
numeric argument (a number, result of a numeric function such as <a class="xref fm:HeadingOnly" href="Command_BILDfmNumericValue_id0d606d9b.html#id0d606d9b-2922-43a8-84a7-5ed59d7705c1__Command_BILDfmNumericValue_id0d606d9b.xml#id0d606d9b-2922-43a8-84a7-5ed59d7705c1" title="Provides access to a DFM property from a single polygon on a pin, pin layer, or auxiliary layer. The DFM property is accessible as a regular numeric value.">dfm_numeric_value</a>, or a
numeric variable).</p>
</li>
<li class="li" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__id2aec6e75-7082-4056-8238-a30b9b1aeae1"><p class="p">A
string argument (a result of a string function such as <a class="xref fm:HeadingOnly" href="Command_BILDfmStringValue_id363e7ae4.html#id363e7ae4-b3d0-4a65-8d48-a6a7bf581137__Command_BILDfmStringValue_id363e7ae4.xml#id363e7ae4-b3d0-4a65-8d48-a6a7bf581137" title="Provides access to a DFM string property from a single polygon on a pin, pin layer, or auxiliary layer.">dfm_string_value</a> or a
string variable).</p>
</li>
<li class="li" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__ide4c5439a-0223-431d-a166-aee32e68e19f"><p class="p">An
array or vector, which is the output of the device DFM functions:</p>
<ul class="ul"><li class="li" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__id037353a2-62f8-4aea-bb54-528fdfeb4559"><p class="p"><a class="xref fm:HeadingOnly" href="Command_BILDfmNumericArray_id446986e2.html#id446986e2-7877-41eb-909b-1360013223e7__id2a66d34d-2813-46bd-993e-af9e3b941f7a">TVF Object for dfm_numeric_array</a></p>
</li>
<li class="li" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__id40f3053e-db63-4ca7-8db8-c7ba41ab6068"><p class="p"><a class="xref fm:HeadingOnly" href="Command_BILDfmVectorArray_idaaf251df.html#idaaf251df-6c1d-442d-ac52-b6ff19374976__id1cfcb688-b2f9-4bfe-805e-aa9f54a023db">TVF Object for dfm_vector_array</a></p>
</li>
<li class="li" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__idb549b506-ec23-436d-a04f-54b127a5b2ae"><p class="p"><a class="xref fm:HeadingOnly" href="Command_BILDfmVectorValue_id4b951b76.html#id4b951b76-1ce6-466d-bc87-9fdf3685a4b8__id6cc8df23-3cad-4bbc-afdf-b00bc4d350f6">TVF Object for dfm_vector_value</a></p>
</li>
</ul>
</li>
</ul>
<p class="p">The Tcl proc called by TVF_NUMeric_FUNction
must return a single floating-point number that is, in turn, assigned
to a property or variable to be used in the remainder of the Device program.</p>
<p class="p">Similarly, the Tcl proc called by TVF_STRING_FUNction
must return a string that is, in turn, assigned to a string property
or variable to be used in the remainder of the Device program.</p>
<p class="p">The arguments passed in to a TVF function
Tcl proc are visible from within the proc as TVF objects. The interface
available for the TVF object depends upon the type of the TVF object passed
in. Each of the TVF objects is described with the command that produces
it.</p>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">The <a class="xref fm:HeadingOnly" href="Contain_DeviceAnnotationBuiltInLanguage_id7f618268.html#id7f618268-3701-47f5-a55a-e0d42341a408__Contain_DeviceAnnotationBuiltInLanguage_id7f618268.xml#id7f618268-3701-47f5-a55a-e0d42341a408" title="The Device annotation built-in language is useful for MOS device well proximity and shallow trench isolation (STI) stress effect property calculations and similar applications. It is primarily used to extract physical parameters for the newer BSIM4 models.">Device Annotation Built-In Language</a> supports the TVF functional interface
and is useful for computing simulation properties. The device annotation
flows have better performance than Device property computations
that do not use annotations. So the annotation language is the preferred
environment for TVF-based property computation.</p>
</div>
<p class="p">In older well enclosure and stress effect
calculation flows (0.18um and above), the following are supported
for input:</p>
<ul class="ul"><li class="li" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__id0fd75bfc-632a-4d9f-b5fb-26130723710b"><p class="p">An
enclosure array, which is the output of an <a class="xref fm:HeadingOnly" href="Command_BILDevPropEnclosureVector_idcc863c6a.html#idcc863c6a-8786-4dd4-b7e7-22fb75f36f74__Command_BILDevPropEnclosureVector_idcc863c6a.xml#idcc863c6a-8786-4dd4-b7e7-22fb75f36f74" title="Returns a vector of numbers that correspond to trapezoidal dimensions for polygons.">enclosure_vector</a>, <a class="xref fm:HeadingOnly" href="Command_BILDevPropEnclosureParallel_id8d473446.html#id8d473446-1261-4c6c-be4e-07417706e744__Command_BILDevPropEnclosureParallel_id8d473446.xml#id8d473446-1261-4c6c-be4e-07417706e744" title="Returns a vector of numbers that correspond to trapezoidal dimensions of average enclosure distances and widths.">enclosure_parallel</a>, or <a class="xref fm:HeadingOnly" href="Command_BILDevPropEnclosurePerpendicular_id0d1c1874.html#id0d1c1874-facd-4d19-81ac-c9584b841377__Command_BILDevPropEnclosurePerpendicular_id0d1c1874.xml#id0d1c1874-facd-4d19-81ac-c9584b841377" title="Returns a vector of numbers that correspond to trapezoidal dimensions of average enclosure distances and widths.">enclosure_perpendicular</a> function. See “<a class="xref fm:HeadingAndPage" href="Command_BILDevPropEnclosureParallel_id8d473446.html#id8d473446-1261-4c6c-be4e-07417706e744__id54a4c072-8557-47b8-83d0-f7c6986cad65">TVF Object for Enclosure Array</a>”.</p>
</li>
<li class="li" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__id38cb85b6-0b00-46b9-8d05-e8e8f73a291a"><p class="p">A
multifinger enclosure array, which is the output of a <a class="xref fm:HeadingOnly" href="Command_BILDevPropEnclosureParallel_id8d473446.html#id8d473446-1261-4c6c-be4e-07417706e744__Command_BILDevPropEnclosureParallel_id8d473446.xml#id8d473446-1261-4c6c-be4e-07417706e744" title="Returns a vector of numbers that correspond to trapezoidal dimensions of average enclosure distances and widths.">enclosure_parallel</a>_multifinger or <a class="xref fm:HeadingOnly" href="Command_BILDevPropEnclosurePerpendicular_id0d1c1874.html#id0d1c1874-facd-4d19-81ac-c9584b841377__Command_BILDevPropEnclosurePerpendicular_id0d1c1874.xml#id0d1c1874-facd-4d19-81ac-c9584b841377" title="Returns a vector of numbers that correspond to trapezoidal dimensions of average enclosure distances and widths.">enclosure_perpendicular</a>_multifinger function. See “<a class="xref fm:HeadingAndPage" href="Command_BILDevPropEnclosureParallel_id8d473446.html#id8d473446-1261-4c6c-be4e-07417706e744__id8a9842c9-3337-4186-8469-a5b6143e0bda">TVF Object for Multifinger Enclosure Array</a>”.</p>
</li>
</ul>
<p class="p">The following TVF commands can be used to
convert rectilinear DFM Property measurement vectors into Device
enclosure-vector-style width and length measurements:</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__idb09d5afb-f055-46b3-b553-8df11c4c3373" class="table" frame="void" border="0" rules="none"><colgroup><col style="width:4.875in" /></colgroup><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;"><p class="p"><a class="xref fm:HeadingOnly" href="Command_BILDfmDeviceDfmVecMeasurements_id7ffc76fb.html#id7ffc76fb-35f3-4893-92ce-2d56d84eec1b__Command_BILDfmDeviceDfmVecMeasurements_id7ffc76fb.xml#id7ffc76fb-35f3-4893-92ce-2d56d84eec1b" title="Converts DFM-style rectilinear measurement vectors into Device enclosure-vector-style width and length measurements in database units.">device::dfm_vec_measurements</a></p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;"><p class="p"><a class="xref fm:HeadingOnly" href="Command_BILDfmDeviceScaledDfmVecMeasurements_idd67659f3.html#idd67659f3-b91a-4621-8309-1460afe99580__Command_BILDfmDeviceScaledDfmVecMeasurements_idd67659f3.xml#idd67659f3-b91a-4621-8309-1460afe99580" title="Converts DFM-style rectilinear measurement vectors into scaled Device enclosure-vector-style width and length measurements.">device::scaled_dfm_vec_measurements</a></p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;"><p class="p"><a class="xref fm:HeadingOnly" href="Command_BILDfmDeviceDfmVecArrMeasurements_id6f39e4e4.html#id6f39e4e4-68a2-4009-af8f-1612973d2b28__Command_BILDfmDeviceDfmVecArrMeasurements_id6f39e4e4.xml#id6f39e4e4-68a2-4009-af8f-1612973d2b28" title="Converts DFM-style rectilinear measurement array vectors into Device enclosure-vector-style width and length measurements in database units.">device::dfm_vec_arr_measurements</a></p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;"><p class="p"><a class="xref fm:HeadingOnly" href="Command_BILDfmDeviceScaledDfmVecArrMeasurements_id652e0e1c.html#id652e0e1c-f0d5-4cfc-af79-fc04960bed45__Command_BILDfmDeviceScaledDfmVecArrMeasurements_id652e0e1c.xml#id652e0e1c-f0d5-4cfc-af79-fc04960bed45" title="Converts DFM-style rectilinear measurement array vectors into scaled Device enclosure-vector-style width and length measurements in database units.">device::scaled_dfm_vec_arr_measurements</a></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p">The Device TVF interface requires a Calibre
Advanced Device Properties (ADP) product license in addition to
the usual licenses. The Tcl package CalibreLVS_DEVICE_DFM also must
be loaded.</p>
</div>
<div class="section Subsection" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__id72080bf3-fda9-4c89-89d0-f67ba434103e"><h2 class="title Subheading sectiontitle">Performance Notes</h2><p class="p">When writing Tcl procs for use in the device
calculation module, remember that built-in language functions are
called and evaluated many times during a device extraction run.
Be sure to use standard Tcl performance coding practices such as
the use of brackets ({}) in expr statements. Also be aware that
operations like list lookup, list sorting, and management of complex
data structures may take significant time during device extraction.</p>
</div>
<div class="section Subsection" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__ida5f6d9e1-a90f-41fe-b239-2991c667754a"><h2 class="title Subheading sectiontitle">Multithreading</h2><p class="p">In multithreaded runs, a separate Tcl interpreter
is created for each processing thread. Cells are processed in parallel.
Device recognition is also performed in multithreaded mode in an
MT or Calibre MTflex run.</p>
<p class="p">Tcl commands that interact with files outside
the usual Calibre system or that specify global variables may fail
to run properly in a multithreaded run because there is more than
one Tcl interpreter.</p>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">Using LVS Show Seed
Promotions YES causes device recognition to run single-threaded.
It is usually best to avoid using this statement in a production
environment.</p>
</div>
</div>
<div class="section Subsection" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__id94df1df0-86ef-4695-a3b6-85ae2f6a9732"><h2 class="title Subheading sectiontitle">Debugging</h2><p class="p">When the rule file is
compiled, all TVF Function blocks referenced by Device statements
are run with dummy values. If errors occur during this run of the
proc (when no device data is present), the rule file will fail to
compile. Arithmetic errors like divide by 0 are ignored during this
process.</p>
<p class="p">If errors occur in the
Tcl proc during actual device recognition, the value of 0 is assigned
to the property being calculated. Errors issued by Tcl display error
information provided by Tcl in the Calibre transcript. To see the
text of the error being generated, include a DEBUG statement in the
device property calculation section. For example, the following
statement produces debug information including Tcl runtime errors
for devices 0-99 for any cell that has devices:</p>
<pre class="pre codeblock"><code>DEVICE MN NGATE NGATE SD SD &lt;DIFF&gt;
[
    DEBUG 0-99
    PROPERTY W, L, SEFFA, SEFFB
    ENC = ENC_PER( NGATE, DIFF, s, 100 )
    // Calculations using TVF Functions
    W = TVF_NUM_FUN::device_func::sum_w( ENC )
    L = AREA( NGATE ) / W
    SEFFA = TVF_NUM_FUN::device_func::calc_eff_a( ENC, W, L )
    SEFFB = TVF_NUM_FUN::device_func::calc_eff_b( ENC, W, L )
]</code></pre><p class="p">The Tcl “puts” function can also be useful
in debugging errors during execution.</p>
</div>
<div class="section Subsection" id="idea8bad97-46ea-48f8-aec1-7ee829d325cb__iddf02ffe3-dd2d-480e-87fa-4d5528b63255"><h2 class="title Subheading sectiontitle">Numeric Underflow and Overflow
in Tcl</h2><p class="p">Numeric underflow and overflow in Tcl expressions
cause errors to be issued, resulting in a 0 return value to the
property computation script. Calibre explicitly overrides the exp
and pow functions in Tcl to avoid this issue since these functions
are common reasons for underflow errors occurring in numeric calculations. </p>
<p class="p">In Tcl 8.6, this behavior
changed so that all underflow values are treated as 0, and overflow values
are treated as the floating-point symbolic value Inf (the infinite
value). Calculations that might involve underflow not related to
pow and exp, and any calculation that might involve overflow, should
be protected by the Tcl “catch” command.</p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_DevicePropertyComputationBuiltInLanguage_id974d7ee8.html" title="The Device statement supports user-defined device property computations. This optional section consists of a program that defines device properties. The properties are written to extracted SPICE netlists and used in LVS comparison.">Device Property Computation Built-In Language</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "svrf_ur"
                DocTitle = "Standard Verification Rule Format (SVRF) Manual"
                PageTitle = "TVF Functional Interface for Device Property Calculation"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/General_TvfFunctionalInterfaceDevicePropertyCalculation_idea8bad97.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Standard Verification Rule Format (SVRF) Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>