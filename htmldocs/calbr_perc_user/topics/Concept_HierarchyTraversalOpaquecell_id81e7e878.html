<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Hierarchy Traversal and -opaqueCell" />
<meta name="abstract" content="The high-level commands like perc::check_device, perc::check_net, perc::check_device_and_net check, and perc::check_data check objects cell-by-cell by default. When nets are processed in the context of these commands, they automatically perform net traversal across cell boundaries when needed in the context of the lowest cell in the hierarchy that completely contains a net." />
<meta name="description" content="The high-level commands like perc::check_device, perc::check_net, perc::check_device_and_net check, and perc::check_data check objects cell-by-cell by default. When nets are processed in the context of these commands, they automatically perform net traversal across cell boundaries when needed in the context of the lowest cell in the hierarchy that completely contains a net." />
<meta name="prodname" content="Calibre PERC User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-25" />
<meta name="Topline" content="Siemens EDA" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_perc_user" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="HighlightColor" content="mgc_yellow_129_50" />
<meta name="HighlightChanges" content="yes" />
<meta name="EclipsePluginName" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="21.2;show" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® PERC™ User’s Manual" />
<meta name="CSHelp" content="NO" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,product.version.v2021.2,product.id.P11493,product.id.P10099,product.id.P11347,product.id.P10084,product.id.P11427,product.id.P10116,product.id.P10096" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id81e7e878-7e09-46c9-acf7-1ddda1873aeb" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Hierarchy Traversal and -opaqueCell</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Hierarchy Traversal and -opaqueCell" />
<meta name="attributes" content="doc.type.documentation.user,product.version.v2021.2,product.id.P11493,product.id.P10099,product.id.P11347,product.id.P10084,product.id.P11427,product.id.P10116,product.id.P10096" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Hierarchy Traversal and -opaqueCell</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">The high-level
commands like perc::check_device, perc::check_net, perc::check_device_and_net
check, and perc::check_data check objects cell-by-cell by default. When
nets are processed in the context of these commands, they automatically
perform net traversal across cell boundaries when needed in the
context of the lowest cell in the hierarchy that completely contains
a net. </span>
</div>
<p class="p">When a traversed net is present
in more than one cell (and hence is present in multiple levels of hierarchy),
these commands accumulate relevant data from the lower hierarchy
levels containing the net. When in the context of the cell that
completely contains the net, the data is processed.</p>
<p class="p">For example, consider this netlist:</p>
<pre class="pre codeblock leveled"><code>.subckt lower pos neg  
C0 pos neg 
.ends 
 
.subckt middle vdd vss 
X0 vdd vss lower 
R0 vdd vss 
.ends 
 
.subckt upper vdd vss 
X1 vdd vss middle 
.ends </code></pre><p class="p">Because all of the nets are connected, vdd
and vss are processed in the “upper” cell. By default, the pos and
neg nets are not reported by a net-based check because they are
connected to vdd and vss.</p>
<p class="p">The <a class="xref" href="Contain_RuleCheckCommands_id9b3d8e0b.html#id9b3d8e0b-3ffc-44d8-99e6-ab9ea8f6aadf__idf4460dcd-f8f8-4baa-b901-dba18b4bf2f3">Math Commands</a>, <a class="xref fm:HeadingOnly" href="Command_PercgetInstancesInParallel_idb1ea3d7e.html#idb1ea3d7e-5223-448f-ae87-6456a062a7d0__Command_PercgetInstancesInParallel_idb1ea3d7e.xml#idb1ea3d7e-5223-448f-ae87-6456a062a7d0" title="Returns a list of instance iterators containing instances connected in parallel.">perc::get_instances_in_parallel</a>, <a class="xref fm:HeadingOnly" href="Command_PercgetInstancesInSeries_id99f054f0.html#id99f054f0-66da-4cf9-aaa2-015f3552d176__Command_PercgetInstancesInSeries_id99f054f0.xml#id99f054f0-66da-4cf9-aaa2-015f3552d176" title="Returns a list of instance iterators containing instances connected in series.">perc::get_instances_in_series</a>, and <a class="xref fm:HeadingOnly" href="Command_PercgetOnePattern_id0b6dc0fc.html#id0b6dc0fc-6241-4679-9c86-7d0be6871edb__Command_PercgetOnePattern_id0b6dc0fc.xml#id0b6dc0fc-6241-4679-9c86-7d0be6871edb" title="Creates a pattern iterator.">perc::get_one_pattern</a> perform similarly to the high-level
commands regarding hierarchy traversal when they require information
outside the context of a given cell. </p>
<p class="p">The -opaqueCell option changes the hierarchy
traversal behavior. If -opaqueCell is present, a command cannot
cross boundaries of specified cells. In other words, the command
processes those cells in isolation, and there will be no element
promotions from those cells.</p>
<p class="p">The -opaqueCell option does not change connectivity.
For example, if there are two pins at the cell level but they are
shorted together at a higher level, they are considered to be on
the same net at the cell level. </p>
<p class="p">The following criteria govern the math commands,
perc::get_instances_in_parallel, perc::get_instances_in_series,
and perc::get_one_pattern. These are referred to as supporting commands.</p>
<ul class="ul"><li class="li" id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb__id64c9cc98-f8d2-4336-8fc1-81f7efa858d0"><p class="p">Specification of an empty cell list as
in -opaqueCell {} (or -opaqueCell "") is ignored.</p>
</li>
<li class="li" id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb__idbc9453d9-9419-4421-8b00-fcc619d3ce48"><p class="p">If a supporting command is called from
an initialization proc, -opaqueCell "*" must be specified. (High-level
check commands cannot be called from an init proc.)</p>
</li>
<li class="li" id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb__id0f6a493a-8291-46c1-aa35-2b7af97bb1c8"><p class="p">If a supporting command is called in
a rule check but <span class="ph FontProperty emphasis">not</span> within
the context of any high-level command, -opaqueCell "*" must be specified.</p>
</li>
<li class="li" id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb__ide688ee31-f20f-49f7-955f-5b824ebc57d0"><p class="p">When a supporting command is called within
the context of any high-level command, the following apply:</p>
<ul class="ul"><li class="li" id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb__id63a575de-a8db-465d-9f5b-07e506377d43"><p class="p">There can be at most one value for the
-opaqueCell <span class="keyword ParameterName OptionalReplaceable">cell_name_list</span> within
the context of the high-level command, and that list applies throughout
the rule check.</p>
</li>
<li class="li" id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb__id84fbe478-c812-4a59-9eb6-f2ee2529795c"><p class="p">If the high-level command declares a
(non-empty) -opaqueCell <span class="keyword ParameterName OptionalReplaceable">cell_name_list</span>,
then for any supporting command called within the context of that
high-level command, that <span class="keyword ParameterName OptionalReplaceable">cell_name_list</span> applies
to each supporting command. It is invalid for any such supporting
command to specify the -opaqueCell option.</p>
</li>
<li class="li" id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb__id8d1a169b-2c66-4edb-95eb-ff27d5c9322f"><p class="p">If the high-level command does not specify
-opaqueCell, then any supporting command called within the context
of that high-level command must specify <span class="ph FontProperty emphasis">the same</span> -opaqueCell <span class="keyword ParameterName OptionalReplaceable">cell_name_list</span> (that
is, specified lists must be identical in all instances) or none
at all. Each supporting command executes accordingly. </p>
<p class="p">Example:</p>
<pre class="pre codeblock leveled"><code>proc rule {} { 
# high-level command 
  perc::check_net -condition cond 
} 
 
proc cond {net} { 
  perc::get_one_pattern ... -opaqueCell { inverter } 
# ok -- pattern-match considers 'inverter' to be opaque 
  perc::get_one_pattern ... 
# ok -- pattern-match with no opaque cells 
  perc::get_one_pattern ... -opaqueCell { inverter } 
# ok -- pattern-match considers 'inverter' to be opaque 
  perc::get_one_pattern ... -opaqueCell { inverter aoi } 
# error -- different cell list within same high-level command 
} </code></pre></li>
</ul>
</li>
<li class="li" id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb__id011f3f6f-8b1b-47c6-9a39-763b7cab6a85"><p class="p">If a supporting command specifies a (non-empty)
-opaqueCell <span class="keyword ParameterName OptionalReplaceable">cell_name_list</span>,
then that <span class="keyword ParameterName OptionalReplaceable">cell_name_list</span> applies
to any nested ‑condition procedures in the context of that command.
No supporting commands in the context of the nested -condition procedures may
specify ‑opaqueCell; they inherit the <span class="keyword ParameterName OptionalReplaceable">cell_name_list</span> from
the command that originally specifies it.</p>
</li>
</ul>
<p class="p">The perc::count and perc::exists commands
have an additional restriction in that when the -net option is used
in the context of a perc::check_data -condition procedure, then
perc::count or perc::exists must use the -opaqueCell "*" option.</p>
<div class="section Subsections"><div class="section Subsection" id="id81e7e878-7e09-46c9-acf7-1ddda1873aeb__id8b2e6e02-e6ef-493d-a786-bb8efbe90f90"><h2 class="title Subheading sectiontitle">Considerations
for -opaqueCell Calling Order</h2><p class="p">Rule check results that depend on the -opaqueCell
option depend upon when the command using the option gets called.
If -opaqueCell is called by a high-level command, nets are split
up at the start of the rule check and processed in the appropriate
cell context. If ‑opaqueCell is called in the ‑condition procedure
of a high-level command, then nets are not split up at the start of
the rule check. Rather, the opaque cell is only considered after
the ‑condition procedure is called.</p>
<p class="p">Consider the following netlist:</p>
<pre class="pre codeblock leveled"><code>.subckt lower pos neg  
C0 pos neg 
.ends 
 
.subckt middle vdd vss 
X0 vdd vss lower 
R0 vdd vss 
.ends 
 
.subckt upper vdd vss 
X1 vdd vss middle 
.ends </code></pre><p class="p">These are the rules:</p>
<pre class="pre codeblock leveled"><code>proc "case 1" {} { 
  perc::check_net -condition cond1 -comment "no -opaqueCell" 
} 
 
proc cond1 {net} { 
  puts "cond1: net=[perc::name ${net} -fromTop] \
    cell: [perc::name [perc::get_placements $net]]" 
  set devices [perc::count -net $net -type {C R} -list] 
  perc::report_base_result -title "Net: [perc::name $net -fromTop]" \
    -value "dev count = [lindex $devices 0]" -list [lindex $devices 1] 
  return 1 
} </code></pre><pre class="pre codeblock leveled"><code>proc "case 2" {} { 
  perc::check_net -condition cond2 -opaqueCell "middle" \
    -comment "-opaqueCell in rule check" 
} 
 
proc cond2 {net} { 
  puts "cond2: net=[perc::name ${net} -fromTop] \
    cell: [perc::name [perc::get_placements $net]]" 
  set devices [perc::count -net $net -type {C R} -list] 
  perc::report_base_result -title "Net: [perc::name $net -fromTop]" \
    -value "dev count = [lindex $devices 0]" -list [lindex $devices 1] 
  return 1 
}</code></pre><pre class="pre codeblock leveled"><code>proc "case 3" {} { 
  perc::check_net -condition cond3 -comment "-opaqueCell in cond" 
} 
 
proc cond3 {net} { 
  puts "cond3: net=[perc::name ${net} -fromTop] \
    cell: [perc::name [perc::get_placements $net]]" 
  set devices [perc::count -net $net -type {C R} -opaqueCell "middle" \
    -list] 
  perc::report_base_result -title "Net: [perc::name $net -fromTop]" \
    -value "dev count = [lindex $devices 0]" -list [lindex $devices 1] 
  return 1 
}</code></pre><p class="p">Three cases are checked:</p>
<p class="p BlockIndent"><span class="ph FontProperty HeadingLabel">case 1</span> —
No opaque cell.</p>
<p class="p BlockIndent"><span class="ph FontProperty HeadingLabel">case 2</span> —
The -opaqueCell option is called in the rule check from the high-level
command.</p>
<p class="p BlockIndent"><span class="ph FontProperty HeadingLabel">case 3</span> —
The -opaqueCell option is called in the -condition procedure of
the high-level command.</p>
<p class="p">In the run transcript, the “puts” commands
produce this:</p>
<pre class="pre codeblock leveled"><code>Executing RuleCheck "case 1" ... 
    Checking RULE: no -opaqueCell 
cond1: net=VDD  cell: upper 
cond1: net=VSS  cell: upper 
... 
  Executing RuleCheck "case 2" ... 
    Checking RULE: -opaqueCell in rule check 
cond2: net=VDD  cell: middle 
cond2: net=VSS  cell: middle 
cond2: net=VDD  cell: upper 
cond2: net=VSS  cell: upper 
... 
  Executing RuleCheck "case 3" ... 
    Checking RULE: -opaqueCell in cond 
cond3: net=VDD  cell: upper 
cond3: net=VSS  cell: upper </code></pre><p class="p">Notice that for case 1, VDD and VSS are processed
only in the “upper” cell. This is because there is no opaque cell,
and all the nets in the design are electrically connected. Both
VDD and VSS (and all nets connected to it) are fully represented
in the “upper” cell.</p>
<p class="p">For case 2, VDD and VSS are both split between
the “upper” and “middle” cells and then processed in each of those
cells separately. This is because -opaqueCell is specified as an argument
to a high-level command in the rule check procedure.</p>
<p class="p">For case 3, VDD and VSS are processed only
in the “upper” cell. This is because -opaqueCell is specified in
the -condition procedure of a high-level command. The nets are not
initially split at the opaque cell boundaries. The opaque cell (middle)
is only considered after the -condition procedure gets called.</p>
<p class="p">The PERC Report summary output is as follows:</p>
<pre class="pre codeblock leveled"><code>Status      Result Count  Cell 
---------   ------------  -------------- 
COMPLETED   0 (0)         lower 
COMPLETED   2 (2)         middle          (both from "case 2" check) 
COMPLETED   6 (6)         upper           (two results from each of the 
                                           three checks) 
 
... 
 
Status      Result Count  Rule 
---------   ------------  -------------- 
 
PERC LOAD esd 
 
COMPLETED   2 (2)         case 1 (no -opaqueCell) 
COMPLETED   4 (4)         case 2 (-opaqueCell in rule check) 
COMPLETED   2 (2)         case 3 (-opaqueCell in cond) </code></pre><p class="p">Notice there are no results from the “lower”
cell. This is because in case 1, all nets are processed in the “upper”
cell as discussed previously. For case 2, the VDD and VSS nets are
processed in the “upper” and “middle” cells. The results from the
“lower” cell are reported in the “middle” cell because the “lower”
cell nets are all electrically connected to the “middle” cell.</p>
<p class="p">These are the case 2 results from the “middle”
cell:</p>
<pre class="pre codeblock leveled"><code>  1    Net  VSS (1 placement, LIST# = L1) 
       Net: VSS 
       dev count = 2 
         R0 [ R ]  
           pos: VDD 
           neg: VSS 
         X0/C0 [ C ]  
           pos: X0/POS 
           neg: X0/NEG 
 
  2    Net  VDD (1 placement, LIST# = L1) 
       Net: VDD 
       dev count = 2 
         R0 [ R ]  
           pos: VDD 
           neg: VSS 
         X0/C0 [ C ]  
           pos: X0/POS 
           neg: X0/NEG </code></pre><p class="p">This cell is processed by itself because -opaqueCell
is specified in the high-level command. The C device results come
from the “lower” cell as discussed previously.</p>
<p class="p">These are the results from the “upper” cell:</p>
<pre class="pre codeblock leveled"><code>o RuleCheck:  case 1 (no -opaqueCell) 
------------------------------------------------------------------------- 
 
  1    Net  VSS 
       Net: VSS 
       dev count = 2 
         X1/R0 [ R ]  
           pos: X1/VDD 
           neg: X1/VSS 
         X1/X0/C0 [ C ]  
           pos: X1/X0/POS 
           neg: X1/X0/NEG 
 
  2    Net  VDD 
       Net: VDD 
       dev count = 2 
         X1/R0 [ R ]  
           pos: X1/VDD 
           neg: X1/VSS 
         X1/X0/C0 [ C ]  
           pos: X1/X0/POS 
           neg: X1/X0/NEG </code></pre><pre class="pre codeblock leveled"><code>
o RuleCheck:  case 2 (-opaqueCell in rule check) 
------------------------------------------------------------------------- 
 
  3    Net  VSS 
       Net: VSS 
       dev count = 0 
        
 
  4    Net  VDD 
       Net: VDD 
       dev count = 0 
        
 
o PERC LOAD esd 
o RuleCheck:  case 3 (-opaqueCell in cond) 
------------------------------------------------------------------------- 
 
  5    Net  VSS 
 Net:VSS 
       dev count = 0 
        
 
  6    Net  VDD 
       Net: VDD 
       dev count = 0</code></pre><p class="p">For case 1, all results are reported in “upper”
because all nets are electrically connected to VDD and VSS, which
originate in “upper”. For case 2, the device count is 0 because
“middle” is an opaque cell declared in the rule check proc, so all
devices are reported in “middle”. </p>
<p class="p">For case 3, the device count is 0 at all levels
of the hierarchy. This is because only after the ‑condition procedure
gets called is the “middle” cell treated as opaque. The perc::count command
cannot count anything below the “upper” cell, so no devices are
processed below it.</p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCChap_RuleCheckProceduresCommands_id5cf67804.html" title="A rule check in Calibre PERC is a Tcl procedure called with the check_proc argument of the PERC Load specification statement. Rule checks evaluate various aspects of a design and produce results of those evaluations. Multiple rule check procedures can be specified. The rule check procedure is defined within a TVF Function statement.">Rule Check Procedures and Commands</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_perc_user"
                DocTitle = "Calibre® PERC™ User’s Manual"
                PageTitle = "Hierarchy Traversal and -opaqueCell"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_HierarchyTraversalOpaquecell_id81e7e878.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® PERC™ User’s Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>