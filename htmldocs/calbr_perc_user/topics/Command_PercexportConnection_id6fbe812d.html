<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="CommandRefTopic" />
<meta name="DC.Title" content="perc::export_connection" />
<meta name="abstract" content="Exports pins from different nets for full-path ESD event checks." />
<meta name="description" content="Exports pins from different nets for full-path ESD event checks." />
<meta name="prodname" content="Calibre PERC User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-25" />
<meta name="Topline" content="Siemens EDA" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_perc_user" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="HighlightColor" content="mgc_yellow_129_50" />
<meta name="HighlightChanges" content="yes" />
<meta name="EclipsePluginName" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="21.2;show" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® PERC™ User’s Manual" />
<meta name="CSHelp" content="NO" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,product.version.v2021.2,product.id.P11493,product.id.P10099,product.id.P11347,product.id.P10084,product.id.P11427,product.id.P10116,product.id.P10096" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id6fbe812d-c1ee-4b97-aba1-1135e8e22405" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>perc::export_connection</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="perc::export_connection" />
<meta name="attributes" content="doc.type.documentation.user,product.version.v2021.2,product.id.P11493,product.id.P10099,product.id.P11347,product.id.P10084,product.id.P11427,product.id.P10116,product.id.P10096" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body class="usa-arg" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">perc::export_connection</h1>
<div class="body refbody CommandRefBody-Var1"><div class="abstract CommandRefAbstract"><p class="p ContextMGC">Calibre
PERC LDL command.</p>
<p class="shortdesc">Exports pins from different
nets for full-path ESD event checks.</p>
</div>
<div class="section Usages"><h2 class="title Subheading sectiontitle">Usage</h2><div class="section UsageSet"><p class="lines UsageLine"><span class="keyword ParameterName Required">perc::export_connection ‘[’ list</span> <span class="keyword ParameterName RequiredReplaceable">device_1 pin_1 device_2 pin_2</span> <span class="keyword ParameterName Required">‘]’</span> {<span class="keyword ParameterName Required">-cd</span> | <span class="keyword ParameterName Required">-p2p</span>} <span class="keyword ParameterName Required">‑path</span> <span class="keyword ParameterName RequiredReplaceable">name</span> [‑resistance <span class="keyword ParameterName OptionalReplaceable">value</span>]</p>
</div>
</div>
<div class="section Descriptions"><h2 class="title Subheading sectiontitle">Description</h2><p class="p">This command is for full-path ESD experiment simulation using
the LDL interface. This command is similar to <a class="xref fm:HeadingOnly" href="Command_PercexportPinPair_id3e93b80f.html#id3e93b80f-cda0-4d09-b368-1cd9d948f77b__Command_PercexportPinPair_id3e93b80f.xml#id3e93b80f-cda0-4d09-b368-1cd9d948f77b" title="Exports pin pairs on the same net for LDL checks.">perc::export_pin_pair</a> except
that perc::export_connection allows pins to be on different nets.
Hence, a connection through the pins of a single device can be exported when
those pins are on differing nets. This flow is discussed under “<a class="xref fm:HeadingAndPage" href="Concept_FullPathChecksInLDL_ida45acce3.html#ida45acce3-127c-4e8e-aee2-3fb8ecf3b1da__Concept_FullPathChecksInLDL_ida45acce3.xml#ida45acce3-127c-4e8e-aee2-3fb8ecf3b1da" title="LDL resistance check simulations occur in two fundamental ways: source and sink on the same net, and source and sink on different nets. When source and sink are on the same net, perc::export_pin_pair is used to export the pins. When source and sink are on differing nets, perc::export_connection and perc::export_pin_pair are used with the -path option. This latter method is referred to as “full path” checking. It applies to both CD and P2P checks.">Full Path Checks in LDL</a>”.</p>
<div class="note caution"><span class="cautiontitle">CAUTION:</span> <p class="p">Do
not use this command except for full-path ESD checks. The exporting
of pins on the <span class="ph FontProperty emphasis">same</span> net
can short out real parasitic resistors.</p>
</div>
<p class="p">The <span class="keyword ParameterName Required">[ list</span> <span class="keyword ParameterName RequiredReplaceable">device_1 pin_1 device_2 pin_2</span> <span class="keyword ParameterName Required">]</span> construct
is a literal Tcl command that defines a set of pins to export. The
arguments may reference a top-level port (lvsTopPort) and a device instance,
in which case one pin is a port and the other is an instance pin,
or two different pins from the same instance. The arguments may
be variables.</p>
<p class="p">The <span class="keyword ParameterName RequiredReplaceable">pin_1</span> argument
serves as the source pin for the -I option and <span class="keyword ParameterName RequiredReplaceable">pin_2</span> argument
serves as the sink pin for the -V option of the <a class="xref fm:HeadingOnly" href="Command_PercLdlexecuteCdChecks_id3665a1d4.html#id3665a1d4-0f32-4c6b-abe2-bd3f5d6a6cfb__Command_PercLdlexecuteCdChecks_id3665a1d4.xml#id3665a1d4-0f32-4c6b-abe2-bd3f5d6a6cfb" title="Executes current density experiments for a Calibre PERC LDL CD run.">perc_ldl::execute_cd_checks</a> command.</p>
<p class="p">One of the <span class="keyword ParameterName Required">-cd</span> or <span class="keyword ParameterName Required">-p2p</span> options
must be specified. The <span class="keyword ParameterName Required">-cd</span> option
is used with <a class="xref fm:HeadingOnly" href="Command_PercLdldesignCdExperiment_ida28f6fee.html#ida28f6fee-0ff8-409b-9597-a51834fa751e__Command_PercLdldesignCdExperiment_ida28f6fee.xml#ida28f6fee-0ff8-409b-9597-a51834fa751e" title="Defines current density experiments for a Calibre PERC LDL CD run.">perc_ldl::design_cd_experiment</a> and the <span class="keyword ParameterName Required">-p2p</span> option
is used with <a class="xref fm:HeadingOnly" href="Command_PercLdldesignP2pExperiment_id98d67b80.html#id98d67b80-dfb4-4459-9297-6c89cfbb0236__Command_PercLdldesignP2pExperiment_id98d67b80.xml#id98d67b80-dfb4-4459-9297-6c89cfbb0236" title="Defines point-to-point resistance experiments for a Calibre PERC P2P run.">perc_ldl::design_p2p_experiment</a>.</p>
<p class="p">The <span class="keyword ParameterName Required">-path</span> argument
is used in conjunction with perc::export_pin_pair -path option to
simulate entire ESD event paths such as from an I/O pad through
many intermediate connections to a ground pad.</p>
<p class="p">The -resistance option allows
the specification of a resistance in ohms to apply to physical devices.
If this option is not specified, the resistance across physical
devices is 0.</p>
<p class="p">This command exports pin pairs
with respect to the top-level cell when the pin pairs chosen for exporting
are specific to a given placement of a cell. If the pin pairs chosen
for exporting are applicable to all placements of a given cell,
they are exported hierarchically with respect to that cell.</p>
<p class="p">Pins matched by this command
are written to a pin pairs file in the <span class="keyword ParameterName OptionalReplaceable">perc_ldl_data</span> directory.
This file is for the internal use of the tool.</p>
<p class="p">If the pins of a multi-finger
device are specified and serve as a sink or a source, each finger
of the device has its own sink or source. If a pin is exported as
a sink, the sink is replicated for each finger so the current drains
through each finger. If a pin is exported as a source, a source
group is created and the current is applied to that group as if
each finger were shorted together.</p>
</div>
<div class="section Arguments"><h2 class="title Subheading sectiontitle">Arguments</h2><div class="section ArgumentSet"><dl class="dl ArgumentList"><dt class="dt ArgumentName dlterm" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__id4874815f-0a3a-47bd-a3bc-d269d3fd8418"><span class="keyword ParameterName Required">[list</span> <span class="keyword ParameterName RequiredReplaceable">device_1 pin_1 device_2 pin_2</span> <span class="keyword ParameterName Required">]</span> </dt>
<dd class="dd ArgumentDescription"><p class="p">A required argument set that
defines the device instance pins or ports to export. This is a literal
Tcl command that takes the following arguments:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__idebc826b0-478d-4efc-b806-5dbd2a7e8388"><p class="p Opt"><span class="keyword ParameterName RequiredReplaceable">device_N </span>—
A required instance iterator or lvsTopPort keyword. Two of these arguments
must be present in the list. The lvsTopPort keyword is used to match
a port and may only be used once in the list. If exporting pins
from the same instance, then that instance is referenced twice.</p>
</li>
<li class="li ArgOption" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__idfd678469-07ca-460a-b670-e414cfbd4f28"><p class="p Opt"><span class="keyword ParameterName RequiredReplaceable">pin_N </span>—
A required pin iterator (see <a class="xref fm:HeadingOnly" href="Command_PercgetPins_idcfb94cf6.html#idcfb94cf6-a4dc-4442-ac03-614d308693ed__Command_PercgetPins_idcfb94cf6.xml#idcfb94cf6-a4dc-4442-ac03-614d308693ed" title="Creates a pin iterator.">perc::get_pins</a>.) or name of a pin corresponding
to the <span class="keyword ParameterName RequiredReplaceable">device_N</span> devices.
Two of these arguments must be present in the list. If the lvsTopPort
keyword is used for <span class="keyword ParameterName RequiredReplaceable">device_N</span>,
then specify “port” for <span class="keyword ParameterName RequiredReplaceable">pin_N</span>.
If exporting two pins from the same instance, then the pin iterators
or names must differ.</p>
</li>
</ul>
</dd>
<dt class="dt ArgumentName dlterm" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__id7b9b80b6-369a-41a3-850c-ddc86b0058f0"><span class="keyword ParameterName Required">-cd</span> </dt>
<dd class="dd ArgumentDescription"><p class="p">Argument that specifies the
listed device pins are used in current density analysis. Either <span class="keyword ParameterName Required">-cd</span> or <span class="keyword ParameterName Required">-p2p</span> must
be specified.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__id3c5711d2-35c4-4229-bf9b-8b5c6b90de0a"><span class="keyword ParameterName Required">-p2p</span> </dt>
<dd class="dd ArgumentDescription"><p class="p">Argument that specifies the
listed device pins are used in pin-to-pin resistance analysis. Either <span class="keyword ParameterName Required">-cd</span> or <span class="keyword ParameterName Required">-p2p</span> must
be specified.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__idaed9c41d-15af-4d8c-bc41-b2109703197c"><span class="keyword ParameterName Required">-path</span> <span class="keyword ParameterName RequiredReplaceable">name</span> </dt>
<dd class="dd ArgumentDescription"><p class="p">A required argument set that
specifies an arbitrary path name to classify a path. This is used in
conjunction with a perc::export_pin_pair -path specification to
simulate an entire ESD path with given pin conditions.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__ida8fec5ef-e69e-4735-9851-2aeb58bda653">-resistance <span class="keyword ParameterName OptionalReplaceable">value</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Optional argument set that specifies
a resistance for physical devices in ohms. By default, the resistance
across physical devices is 0.</p>
</dd>
</dl>
</div>
</div>
<div class="section ReturnedValues"><h2 class="title Subheading sectiontitle">Return Values</h2><p class="p">None.</p>
</div>
<div class="section Examples" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__id29cb33fb-0e4a-48e1-bf7e-7012a2a46f61"><h2 class="title Subheading sectiontitle">Examples</h2><div class="section Subsection" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__id6b4dcef3-40b1-4236-851b-6e3eca98ebad"><h2 class="title Subheading sectiontitle">Example
1</h2><p class="p">Although this check is written as a current density check, it
would also work in a P2P resistance configuration. The check is
for the following diode configuration:</p>
<div class="fig fignone" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__idcfffd925-20a7-49cc-a34d-d0a902736fbb"><br /><div class="imagecenter"><img class="image imagecenter fmdpi:108" src="../graphics/export_connection1.png" /></div><br /></div>
<pre class="pre codeblock leveled"><code>TVF FUNCTION test_export_connection [/* 
  package require CalibreLVS_PERC 
 
  # set up net types 
  proc init {} { 
    <a class="xref fm:HeadingOnly" href="Command_PercdefineNetType_id94dce3ed.html#id94dce3ed-08eb-4906-8920-4023848dda4b__Command_PercdefineNetType_id94dce3ed.xml#id94dce3ed-08eb-4906-8920-4023848dda4b" title="Assigns a net type to nets from an input list of net names.">perc::define_net_type</a> "Power"    {lvsPower} 
    perc::define_net_type "Ground"   {lvsGround} 
    perc::define_net_type "Pad"      {lvsTopPorts} 
    <a class="xref fm:HeadingOnly" href="Command_PercdefineTypeSet_id4729110c.html#id4729110c-e73f-4c7b-8772-d111b3fd3cf4__Command_PercdefineTypeSet_id4729110c.xml#id4729110c-e73f-4c7b-8772-d111b3fd3cf4" title="Creates and assigns a new net type set from a list of net types.">perc::define_type_set</a> "IOPad"    {Pad &amp;&amp; !Power &amp;&amp; !Ground} 
  } 
 
  # get the IO pad nets going to power 
  proc io2pwr {} { 
    <a class="xref fm:HeadingOnly" href="Command_PerccheckNet_id75162cb0.html#id75162cb0-c882-4d1d-9273-9095a7dd5b64__Command_PerccheckNet_id75162cb0.xml#id75162cb0-c882-4d1d-9273-9095a7dd5b64" title="Checks nets in the design for nets that match the specified conditions. By default, all nets are matched.">perc::check_net</a> -netType IOPad -condition io2pwr_cond \
      -comment "Full Path CD Up" 
  } 
 
  proc io2pwr_cond {net} { 
    pin_pair_cd $net pos neg up 
    return 0 
  } 
 
  # get the IO pad nets going to ground 
  proc io2gnd {} { 
    perc::check_net -netType IOPad -condition io2gnd_cond \
      -comment "Full Path CD Down" 
  } 
 
  proc io2gnd_cond {net} { 
    pin_pair_cd $net neg pos dn 
    return 0 
  } </code></pre><pre class="pre codeblock leveled"><code>  # for nets that have diodes, export the top-level ports connected to 
  # diode pins, the diode pins, and the internal connections between the  
  # diode pins 
  proc pin_pair_cd {net pin1 pin2 p_name} { 
    set result [<a class="xref fm:HeadingOnly" href="Command_Perccount_iddc2be6a2.html#iddc2be6a2-af8b-4db2-a0a4-eebebc591bad__Command_Perccount_iddc2be6a2.xml#iddc2be6a2-af8b-4db2-a0a4-eebebc591bad" title="Returns the number of devices meeting the conditions of the command.">perc::count</a> -net $net -type D -pinAtNet $pin1 -list] 
    set dio_count [lindex $result 0] 
    set dio_list  [lindex $result 1] 
         
    if {$dio_count &gt; 0} { 
      foreach dio $dio_list { 
        <a class="xref fm:HeadingOnly" href="Command_PercexportPinPair_id3e93b80f.html#id3e93b80f-cda0-4d09-b368-1cd9d948f77b__Command_PercexportPinPair_id3e93b80f.xml#id3e93b80f-cda0-4d09-b368-1cd9d948f77b" title="Exports pin pairs on the same net for LDL checks.">perc::export_pin_pair</a> [list lvsTopPort port $dio $pin1] -cd \
          -path $p_name 
        perc::export_connection [list $dio $pin1 $dio $pin2] -cd \
          -path $p_name 
        perc::export_pin_pair [list $dio $pin2 lvsTopPort port] -cd \
          -path $p_name 
      } 
    } 
    return 0 
  } 
*/] 
 
// set the reporting constraints for these layers 
PERC LDL CD m1 CONSTRAINT VALUE 0.1 
PERC LDL CD poly CONSTRAINT VALUE 0.1 
 
TVF FUNCTION test_export_connection_ldl_checks [/* 
  # this block executes the LDL CD checks 
  proc cd_execute {} { 
    set cd_tests {} 
    lappend cd_tests [<a class="xref fm:HeadingOnly" href="Command_PercLdldesignCdExperiment_ida28f6fee.html#ida28f6fee-0ff8-409b-9597-a51834fa751e__Command_PercLdldesignCdExperiment_ida28f6fee.xml#ida28f6fee-0ff8-409b-9597-a51834fa751e" title="Defines current density experiments for a Calibre PERC LDL CD run.">perc_ldl::design_cd_experiment</a> -rulecheck io2pwr \
      -experiment_name io2pwr.full_path -group_by path] 
    lappend cd_tests [perc_ldl::design_cd_experiment -rulecheck io2gnd \
      -experiment_name io2gnd.full_path -group_by path] 
         
    <a class="xref fm:HeadingOnly" href="Command_PercLdlexecuteCdChecks_id3665a1d4.html#id3665a1d4-0f32-4c6b-abe2-bd3f5d6a6cfb__Command_PercLdlexecuteCdChecks_id3665a1d4.xml#id3665a1d4-0f32-4c6b-abe2-bd3f5d6a6cfb" title="Executes current density experiments for a Calibre PERC LDL CD run.">perc_ldl::execute_cd_checks</a> -I 2 -V 0 \
     -cd_experiment_list [list $cd_tests] 
    exit 
  } 
*/] 
 
DFM YS AUTOSTART test_export_connection_ldl_checks cd_execute 
DFM DATABASE "dfmdb" OVERWRITE REVISIONS [DEVICES PINLOC] </code></pre><p class="p">The TVF Function test_export_connection_ldl_checks
sets up and executes the current density checks.</p>
<p class="p">The TVF Function test_export_connection
finds current density on complete paths from I/O pads through diode
pins to power or ground. (These checks are not designed for a diode
stack. For that configuration, see Example 2.)</p>
<p class="p">Tcl proc cd_execute sets up two
Calibre PERC LDL CD experiments, io2pwr.full_path and io2gnd.full_path.
These check current density on paths from I/O pads to power and
ground, respectively.</p>
<p class="p">Tcl proc init sets up the net types
for power, ground, and I/O pads. The Tcl procs io2pwr and io2gnd
use these net types to select the nets of interest for the CD checks.</p>
<p class="p">Tcl proc pin_pair_cd checks if there
are diodes on the nets of interest. If there are, then the proc exports
the top-level ports on those nets, the pins of the diodes, and the
internal pin connections through each diode. The CD calculations
are then performed along the entire paths.</p>
</div>
<div class="section Subsection" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__idd6903178-f3f3-40e8-b8eb-bc82c3026afb"><h2 class="title Subheading sectiontitle">Example
2</h2><p class="p">In Example 1, it is assumed there is only one diode in the “up”
or “down” configuration connecting an IO port to a supply port.
Frequently, however, there is a stack of diodes connected in series
in the “up” and “down” branches. The diode stacks may also be connected in
parallel. The following code considers the latter case.</p>
<pre class="pre codeblock"><code>LVS POWER NAME "source"
LVS GROUND NAME "sink"

// revise the constraints to what is actually needed
PERC LDL CD metal1 CONSTRAINT VALUE 0.1
PERC LDL CD metal2 CONSTRAINT VALUE 0.1
PERC LDL CD nsd    CONSTRAINT VALUE 0.1
PERC LDL CD psd    CONSTRAINT VALUE 0.1

DFM YS AUTOSTART execute_perc_res_checks
    extract_resistance

DFM DATABASE "dfmdb" OVERWRITE REVISIONS [ DEVICES PINLOC ]
MASK SVDB DIRECTORY "svdb" XRC QUERY

TVF FUNCTION perclib [/*
  package require CalibreLVS_PERC

  # set up net types
  proc setup {} {
    perc::define_net_type IO  { IO }
  }

  # main proc for processing the data
  proc export_series_devices { IO_net dev_itr series_pin_1 \
                               series_pin_2 debug } {
    
    set input_net [<a class="xref fm:HeadingOnly" href="Command_Percname_idfec10dd1.html#idfec10dd1-a4a4-4a94-ad9f-1da475b6a82d__Command_Percname_idfec10dd1.xml#idfec10dd1-a4a4-4a94-ad9f-1da475b6a82d" title="Returns the name of the element pointed to by the iterator argument.">perc::name</a> $IO_net]
    set dev_count [lindex $dev_itr 0]

  # too many devices on this net
    if {$dev_count &gt; 100} { 
      puts "   NOTE: Device count $dev_count &gt; 100. \
        Skipping $input_net."
      return 1
    }</code></pre><pre class="pre codeblock"><code>    set dev_list [lindex $dev_itr 1]

    foreach devs $dev_list {
      lappend types [<a class="xref fm:HeadingOnly" href="Command_Perctype_id19c43fdf.html#id19c43fdf-9288-4113-8906-7d1cf825ce84__Command_Perctype_id19c43fdf.xml#id19c43fdf-9288-4113-8906-7d1cf825ce84" title="Returns the type of the referenced instance, the net, or a pin’s net types or path types. For a cell instance, it returns the cell name.">perc::type</a> $devs]
    }

    set device_type_list [lsort -unique -nocase $types]
    set dev_pin [lindex $dev_itr 2]
    
    if {$debug == 1} {
      puts "   INFO 1: export series devices for path=$input_net \
        typelist=$device_type_list \
        pin1=$series_pin_1 pin2=$series_pin_2 dev_count=$dev_count"
    }

  # process the devices on the input net
    for {set i 0} {$i &lt; $dev_count} {incr i} {
      set dev [lindex $dev_list $i]
      set pin_name [lindex $dev_pin $i]

  # find the number of series devices, possibly in parallel branches
      set series_devices [<a class="xref fm:HeadingOnly" href="Command_PercgetInstancesInSeries_id99f054f0.html#id99f054f0-66da-4cf9-aaa2-015f3552d176__Command_PercgetInstancesInSeries_id99f054f0.xml#id99f054f0-66da-4cf9-aaa2-015f3552d176" title="Returns a list of instance iterators containing instances connected in series.">perc::get_instances_in_series</a> $dev $IO_net \
        $series_pin_1 $series_pin_2 -spAlso]
      set chain_count [llength $series_devices]

      if {$debug == 1} {
        puts "\n   INFO 2: $chain_count series devices starting with\
          [perc::name $dev]" 
        puts "           exported pin pair: lvsTopPort port:$input_net\
          -&gt; [perc::name $dev]/$pin_name"
      }

  # do this if a single device is not something you want to model.
  # if no series devices, go on to the next device.
  #   if {$chain_count &lt;= 1} { 
  #     puts "   NOTE: no series device for [perc::name $dev]"
  #     continue
  #   }

  # export the top-level port/device pin pair
      perc::export_pin_pair [list lvsTopPort port $dev $pin_name] -cd \
        -path $input_net
   
  # find the first and last devices in the series
      set head_dev [lindex $series_devices 0]
      set tail_dev [lindex $series_devices [expr {$chain_count - 1}]]
      
  # find the net connecting to the next device in the series
      set next_dev_net_iter [<a class="xref fm:HeadingOnly" href="Command_PercgetOtherNetOnInstance_id85c3d2b2.html#id85c3d2b2-1b55-49a9-ae53-4cda904a9176__Command_PercgetOtherNetOnInstance_id85c3d2b2.xml#id85c3d2b2-1b55-49a9-ae53-4cda904a9176" title="Creates a net iterator.">perc::get_other_net_on_instance</a> $dev \
                             $IO_net $series_pin_1 $series_pin_2]</code></pre><pre class="pre codeblock"><code>  # initially, the previous device is the first device
      set previous_dev $head_dev
   
  # process the next device in the series.
  # do this for all but the final device in the chain.
      for {set j 1} {$j &lt; $chain_count} {incr j} {
        set current_dev [lindex $series_devices $j]
       
  # export the connections across successive devices in the series chain
        foreach {iter1} $previous_dev {
          if {$debug == 1} {
            puts "   INFO 3: exported connection\
              [perc::name $iter1]/$series_pin_1 -&gt;\
              [perc::name $iter1]/$series_pin_2"
          }

          perc::export_connection [list $iter1 $series_pin_1 \
            $iter1 $series_pin_2] -cd -path $input_net

          foreach {iter2} $current_dev {
            if {$debug == 1} {
              puts "   INFO 4: exported connection\
                [perc::name $iter2]/$series_pin_1 -&gt;\
                [perc::name $iter2]/$series_pin_2"
            }
            
            perc::export_connection [list $iter2 $series_pin_1 \
              $iter2 $series_pin_2] -cd -path $input_net

  # adjacent pins on successive devices must be exported as source and 
  # sink. pins passed into the proc can be in any order.
  # choose pin 2 on the 'current' device as the source pin.
            set source_pin $series_pin_2
            
  # if the net across the 'current' device is the same net that is 
  # connected to pin 1 on the 'previous' device, then pin 1 on the 
  # 'current' device is the source pin.      
            if { [<a class="xref fm:HeadingOnly" href="Command_Percequal_id6694e74a.html#id6694e74a-ec3f-4390-be3a-cfbbc4310f02__Command_Percequal_id6694e74a.xml#id6694e74a-ec3f-4390-be3a-cfbbc4310f02" title="Returns TRUE if two iterators point to the same element.">perc::equal</a> $next_dev_net_iter [<a class="xref fm:HeadingOnly" href="Command_PercgetNets_id591349e2.html#id591349e2-717e-4ca8-aad7-1a22ad2a4aea__Command_PercgetNets_id591349e2.xml#id591349e2-717e-4ca8-aad7-1a22ad2a4aea" title="Creates a net iterator.">perc::get_nets</a> \
              [<a class="xref fm:HeadingOnly" href="Command_PercgetPins_idcfb94cf6.html#idcfb94cf6-a4dc-4442-ac03-614d308693ed__Command_PercgetPins_idcfb94cf6.xml#idcfb94cf6-a4dc-4442-ac03-614d308693ed" title="Creates a pin iterator.">perc::get_pins</a> $iter1 -name $series_pin_1]]] == 1 } {
              set source_pin $series_pin_1
            }
     
  # choose pin 2 as the sink pin   
            set sink_pin $series_pin_2
            
  # if the net across the 'current' device is the same net that is 
  # connected to pin 1 on the 'current' device, then pin 1 on the 
  # 'current' device is the sink pin.    
       if { [perc::equal $next_dev_net_iter [perc::get_nets \
              [perc::get_pins $iter2 -name $series_pin_1]]] == 1 } {
              set sink_pin $series_pin_1
            }</code></pre><pre class="pre codeblock"><code>            if {$debug == 1} {
              puts "   INFO 5: exported pin pair\
                [perc::name $iter1]/$source_pin -&gt;\
                [perc::name $iter2]/$sink_pin on NET\
                [perc::name $next_dev_net_iter]"
            }

  # export the source and sink pins
            perc::export_pin_pair [list $iter1 $source_pin \
              $iter2 $sink_pin] -cd -path $input_net

          }; # end foreach iter2
       };    # end foreach iter1

  # go to the next device and get the net across that device    
       set previous_dev $current_dev
       set next_dev_net_iter [perc::get_other_net_on_instance $iter2 \
         $next_dev_net_iter $series_pin_1 $series_pin_2]
     }; # end for set j

  # now handle the final device in the chain
     foreach {iter2} $tail_dev {
  # need to find out if the "ending pin" is a port here before exporting 
  # the final pin pair.
  # choose pin 2 initially as the source.
       set source_pin $series_pin_2
  
  # if the net across the 'current' device is the same net that is 
  # connected to the pin 1 on the 'current' device, then pin 1 on the 
  # 'current' device is the source pin.        
        if { [perc::equal $next_dev_net_iter [perc::get_nets \
          [perc::get_pins $iter2 -name $series_pin_1]]] == 1 } {
          set source_pin $series_pin_1
        } 

        if {$debug == 1} {
          puts "   INFO 6: exported pin pair:\
            [perc::name $iter2]/$source_pin -&gt;\
            lvsTopPort port:[perc::name [perc::get_nets \
              [perc::get_pins $iter2 -name $source_pin]]]"
        }
         
       perc::export_pin_pair [list $iter2 $source_pin lvsTopPort port] \
         -cd -path $input_net
        
     }; # end foreach iter2
   }; # end for set i
   return 0
  }; # end proc export_series_devices</code></pre><pre class="pre codeblock"><code># call the main engine for doing the exporting of diodes
  proc cd_full_path_UP_cond { IO_net } {
  # set this to 1 if you want transcripted debugging trace
    set debug 1
  # get diodes with POS pins on IO_net
    set up_D_iter [perc::count -net $IO_net -type D \
      -pinAtNet [list POS] -listPin] 
  #                       &lt;net&gt;   &lt;devices&gt;  &lt;pin1&gt; &lt;pin2&gt; &lt;debug flag&gt;
    export_series_devices $IO_net $up_D_iter POS    NEG    $debug
    return 0
  }

# get the IO net and do some exporting of all diodes on that net
  proc cd_full_path_UP { } {
    perc::check_net -netType IO -condition cd_full_path_UP_cond \
      -comment "export diodes between IO and power ports"
  }

  # call the main engine for doing the exporting of diodes
  proc cd_full_path_DOWN_cond { IO_net } {
  # set this to 1 if you want transcripted debugging trace
    set debug 1
  # get diodes with NEG pins on IO_net
    set down_D_iter [perc::count -net $IO_net -type D \
      -pinAtNet [list NEG] -listPin] 
  #                       &lt;net&gt;   &lt;devices&gt;    &lt;pin1&gt; &lt;pin2&gt; &lt;debug flag&gt;
    export_series_devices $IO_net $down_D_iter NEG    POS    $debug
    return 0
  }

# get the GND net and do some exporting of all diodes on that net
  proc cd_full_path_DOWN { } {
    perc::check_net -netType IO -condition cd_full_path_DOWN_cond \
      -comment "export diodes between GND and IO ports"
  }

*/]

TVF FUNCTION execute_perc_res_checks [/*
  proc extract_resistance {} {
    set test1 [perc_ldl::design_cd_experiment \
      -rulecheck cd_full_path_UP -group_by path \
      -experiment_name bypath_up]
    set test2 [perc_ldl::design_cd_experiment \
      -rulecheck cd_full_path_UP -experiment_name default_up]
    set test3 [perc_ldl::design_cd_experiment \
      -rulecheck cd_full_path_DOWN -group_by path \
      -experiment_name bypath_down] 
    set test4 [perc_ldl::design_cd_experiment \
      -rulecheck cd_full_path_DOWN -experiment_name default_down]
    set tests [list $test1 $test2 $test3 $test4]

    perc_ldl::execute_cd_checks -I 1 -V 0 \
      -cd_experiment_list [list $tests]
    exit
  }
*/]</code></pre><p class="p">The “setup” initialization procedure defines a net type for IO
nets. The procs cd_full_path_UP and cd_full_path_DOWN initiate checking
the “up” and “down” branches of a protection diode structure, such
as here:</p>
<div class="fig fignone" id="id6fbe812d-c1ee-4b97-aba1-1135e8e22405__idb03831a3-aa42-4940-9b6d-3a22d30a378a"><br /><div class="imagecenter"><img class="image imagecenter fmdpi:108" src="../graphics/export_connection_ex2.png" /></div><br /></div>
<p class="p">The “up” branch is connected to the “source” port and the “down”
branch is connected to the “sink” port. The IO net serves as the
root of the trunk of the two branches. </p>
<p class="p">The cd_full_path_UP_cond and DOWN_cond procs ensure the proper
diode pin configurations are sent to the export_series_devices proc,
which is the main engine for exporting diodes for CD simulation.
The cd_full_path_UP_cond and DOWN_cond procs have the variable flags “set debug
1” enabled so a debug trace is written to the transcript. You can
disable these flags as desired.</p>
<p class="p">The export_series_devices proc traverses the diode branch structures
from the IO net to the supply nets and exports the proper pin and
device connections for simulation. For the schematic shown previously,
this is an example debug trace in the transcript for the “up” branch:</p>
<pre class="pre codeblock"><code>  Executing RuleCheck "cd_full_path_UP" ...
    Checking RULE: export diodes between IO and power ports
   INFO 1: export series devices for path=IO  typelist=D  pin1=POS pin2=NEG dev_count=2

   INFO 2: 2 series devices starting with X5/D0
           exported pin pair: lvsTopPort port:IO -&gt; X5/D0/pos
   INFO 3: exported connection X5/D0/POS -&gt; X5/D0/NEG
   INFO 4: exported connection X4/D0/POS -&gt; X4/D0/NEG
   INFO 5: exported pin pair X5/D0/NEG -&gt; X4/D0/POS on NET 6
   INFO 6: exported pin pair: X4/D0/NEG -&gt; lvsTopPort port:SOURCE

   INFO 2: 2 series devices starting with X1/D0
           exported pin pair: lvsTopPort port:IO -&gt; X1/D0/pos
   INFO 3: exported connection X1/D0/POS -&gt; X1/D0/NEG
   INFO 4: exported connection X0/D0/POS -&gt; X0/D0/NEG
   INFO 5: exported pin pair X1/D0/NEG -&gt; X0/D0/POS on NET 2
   INFO 6: exported pin pair: X0/D0/NEG -&gt; lvsTopPort port:SOURCE</code></pre><p class="p">Two parallel stacks of diodes are exported for each branch. </p>
<p class="p">The extract_resistance proc sets up the CD experiments and executes
them for both branches. The tests have results grouped by path and
by rule check.</p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_RuleCheckCommands_id9b3d8e0b.html" title="Rule check commands appear in rule check procs and are used to check the design. Some rule check commands may be used in init procs. These are annotated in the notes to the tables in this section.">Rule Check Commands</a></div>
</div>

<div class="linklist linklist relinfo"><strong>Related Topics</strong><br />

<div><a class="link" href="../topics/TaskTop_RunningCalibrePercCdFlow_id204c3ddd.html" title="This procedure shows how to set up and run the Calibre PERC CD flow.">Running the Calibre PERC CD Flow</a></div>
<div><a class="link" href="../topics/TaskTop_RunningCalibrePercP2pFlow_id568522db.html" title="This procedure shows how to set up and run the Calibre PERC P2P flow.">Running the Calibre PERC P2P Flow</a></div></div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_perc_user"
                DocTitle = "Calibre® PERC™ User’s Manual"
                PageTitle = "perc::export_connection"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Command_PercexportConnection_id6fbe812d.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® PERC™ User’s Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>