<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Useful Utility Procedures" />
<meta name="abstract" content="Three useful utility procedures can be used for Calibre PERC voltage assignment and propagation reporting." />
<meta name="description" content="Three useful utility procedures can be used for Calibre PERC voltage assignment and propagation reporting." />
<meta name="prodname" content="Calibre PERC User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-25" />
<meta name="Topline" content="Siemens EDA" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_perc_user" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="HighlightColor" content="mgc_yellow_129_50" />
<meta name="HighlightChanges" content="yes" />
<meta name="EclipsePluginName" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="21.2;show" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® PERC™ User’s Manual" />
<meta name="CSHelp" content="NO" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,product.version.v2021.2,product.id.P11493,product.id.P10099,product.id.P11347,product.id.P10084,product.id.P11427,product.id.P10116,product.id.P10096" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="ide324021e-abe0-4793-bc35-3ee9d47a4885" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Useful Utility Procedures</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Useful Utility Procedures" />
<meta name="attributes" content="doc.type.documentation.user,product.version.v2021.2,product.id.P11493,product.id.P10099,product.id.P11347,product.id.P10084,product.id.P11427,product.id.P10116,product.id.P10096" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="ide324021e-abe0-4793-bc35-3ee9d47a4885">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Useful
Utility Procedures</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">Three useful
utility procedures can be used for Calibre PERC voltage assignment
and propagation reporting.</span>
</div>
<p class="p">The following Tcl procs are called from initialization
or rule check procedures and are assumed to be in a file called <span class="ph filepath">utilities.tcl</span> in
later examples, but the filename can be any you choose.</p>
<div class="section Subsections" id="ide324021e-abe0-4793-bc35-3ee9d47a4885__id25bd350c-df0d-4a91-b9dc-21e45a7a5fe7"><div class="section Subsection" id="ide324021e-abe0-4793-bc35-3ee9d47a4885__id0c811fc9-a1b8-435a-ab42-65738390412f"><h2 class="title Subheading sectiontitle">define_net_voltages_from_file
proc</h2><p class="p">This proc reads in voltage values for
nets, which are defined in a separate file and sets up <a class="xref fm:HeadingOnly" href="Command_PercdefineNetVoltage_id8609d11e.html#id8609d11e-ac3a-4e2d-9cc8-552555478d23__Command_PercdefineNetVoltage_id8609d11e.xml#id8609d11e-ac3a-4e2d-9cc8-552555478d23" title="Assigns a voltage to a list of named nets.">perc::define_net_voltage</a> commands in an initialization
procedure. The lines in the separate file have the following format:</p>
<p class="p BlockIndent"><span class="keyword ParameterName RequiredReplaceable">net_name</span> {<span class="keyword ParameterName RequiredReplaceable">voltage</span> | <span class="keyword ParameterName RequiredReplaceable">voltage_group</span>}
[{<span class="keyword ParameterName OptionalReplaceable">voltage</span> | <span class="keyword ParameterName OptionalReplaceable">voltage_group</span>}…]</p>
<p class="p">With the following definitions:</p>
<ul class="ul"><li class="li" id="ide324021e-abe0-4793-bc35-3ee9d47a4885__id77c3339e-a42e-4469-aedb-89ecf8fd3ab8"><p class="p"><span class="keyword ParameterName RequiredReplaceable">net_name</span> —
Name of a net.</p>
</li>
<li class="li" id="ide324021e-abe0-4793-bc35-3ee9d47a4885__id631d7edc-8283-4f01-9f11-298d2f0f4c37"><p class="p"><span class="keyword ParameterName RequiredReplaceable">voltage</span> —
Numeric value in volts.</p>
</li>
<li class="li" id="ide324021e-abe0-4793-bc35-3ee9d47a4885__id6de71fdf-4fc0-4673-8461-6b9320a26dbe"><p class="p"><span class="keyword ParameterName RequiredReplaceable">voltage_group</span> —
Group name defined in a <a class="xref fm:HeadingOnly" href="Command_PercdefineVoltageGroup_idbdb87620.html#idbdb87620-cb7a-4979-90fe-0df343b16abe__Command_PercdefineVoltageGroup_idbdb87620.xml#idbdb87620-cb7a-4979-90fe-0df343b16abe" title="Specifies a group of related voltages.">perc::define_voltage_group</a> command.</p>
</li>
</ul>
<p class="p">This is an example of voltage file entries
that are suitable for vector-less analysis:</p>
<pre class="pre codeblock leveled"><code>VDD    3.3 1.8 0.0 
# vddh has an underlying numeric value defined in a 
# perc::define_voltage_group command.
VDDH   vddh 
VSS    0.0 
IN     3.3 1.8 0.0 </code></pre><p class="p">Vectored analysis typically requires only one
voltage value per net. For details about these evaluation modes,
see “<a class="xref fm:HeadingAndPage" href="Concept_VoltageCheckCoding_id11b112f0.html#id11b112f0-580b-4c0d-a0d9-ccdb5970123d__id678045a6-27f7-4bdd-833a-ce458744b881">Vectored Versus Vector-Less Voltage Analysis</a>”.</p>
<p class="p">This is the procedure for writing perc::define_net_voltage
commands from a file.</p>
<pre class="pre codeblock leveled"><code># define_net_voltages_from_file assigns voltages specified in a file 
# to corresponding nets. 
 
# Lines in filename are expected to be of these forms: 
# &lt;net_name&gt; &lt;voltage_value&gt; [&lt;voltage_value&gt; ...] 
# &lt;net_name&gt; &lt;voltage_group&gt; [&lt;voltage_group&gt; ...] 
 
  proc define_net_voltages_from_file {filename} { 
  # initialize voltage_type_list to empty; open voltages_file for reading 
    set voltage_type_list {} 
    set fn [open $filename r] 
  # read each line 
    while { [gets $fn line] &gt;= 0 } { 
  # ignore commented and blank lines 
      if { [string index $line 0] == "#" } continue 
      if { [string trim $line] == {}  } continue 
  # parse lines in $fn to get the voltage values 
      set voltages [lreplace $line 0 0] 
  # for every voltage value, append the net name 
      foreach { voltage_value } $voltages { 
        lappend $voltage_value [lindex $line 0] 
  # If this voltage value is not yet seen, then add this  
  # voltage-value list to the list of lists: voltage_type_list 
        if { [lsearch $voltage_type_list $voltage_value] &lt; 0 } {  
          lappend voltage_type_list $voltage_value 
        } 
     }; # end foreach 
   }; # end while 
   close $fn 
  # For each voltage-net list, generate a perc::define_net_voltage command 
    foreach { voltage_type } $voltage_type_list { 
      <a class="xref fm:HeadingOnly" href="Command_PercdefineNetVoltage_id8609d11e.html#id8609d11e-ac3a-4e2d-9cc8-552555478d23__Command_PercdefineNetVoltage_id8609d11e.xml#id8609d11e-ac3a-4e2d-9cc8-552555478d23" title="Assigns a voltage to a list of named nets.">perc::define_net_voltage</a> "${voltage_type}" \
        [subst \${${voltage_type}}] 
    } 
  } </code></pre></div>
<div class="section Subsection" id="ide324021e-abe0-4793-bc35-3ee9d47a4885__idefa56e02-249a-4f14-914e-8bf2c7a49922"><h2 class="title Subheading sectiontitle">print_voltages proc</h2><p class="p">This proc is used to print device pin voltages
to the run transcript. This proc would be part of a Calibre PERC
rule check. This proc is useful for rule file development and debugging
purposes, but it can output a large number of lines.</p>
<pre class="pre codeblock leveled"><code># print_voltages writes device instance pin voltages to the transcript. 
# undefined voltages are listed as such. 
 
# dev ::= instance, pn1 ::= pin1, pv1 ::= pin1 voltage 
#                   pn2 ::= pin2, pv2 ::= pin2 voltage 
 
  proc print_voltages {dev pn1 pv1 pn2 pv2} { 
    puts "subckt [<a class="xref fm:HeadingOnly" href="Command_Percname_idfec10dd1.html#idfec10dd1-a4a4-4a94-ad9f-1da475b6a82d__Command_Percname_idfec10dd1.xml#idfec10dd1-a4a4-4a94-ad9f-1da475b6a82d" title="Returns the name of the element pointed to by the iterator argument.">perc::name</a> [<a class="xref fm:HeadingOnly" href="Command_PercgetPlacements_idbb97f715.html#idbb97f715-1a39-433c-af27-25ad6d2679ef__Command_PercgetPlacements_idbb97f715.xml#idbb97f715-1a39-433c-af27-25ad6d2679ef" title="Creates a placement representative iterator.">perc::get_placements</a> $dev]] \
      instance [perc::name $dev] \
      pins $pn1=[expr {$pv1==""?"undefined":$pv1}] \
      $pn2=[expr {$pv2==""?"undefined":$pv2}] \
      [lindex [info level -2] 0]()" 
  } </code></pre></div>
<div class="section Subsection" id="ide324021e-abe0-4793-bc35-3ee9d47a4885__id2ef969b1-6aea-464b-bc28-f0dc5199cc23"><h2 class="title Subheading sectiontitle">check_pin_voltages proc</h2><p class="p">This proc checks the difference in pin voltages
on a given device against a specified tolerance value. This proc
returns a 0 or 1 to the calling environment, depending on whether
the pin voltages meet the difference tolerance value. It calls the
previously-defined print_voltages proc to print pin voltages to
the transcript.</p>
<pre class="pre codeblock leveled"><code># check_pin_voltages checks the difference in voltages of 2 pins from 
# the same instance. if the difference is &gt; val, the instance is bad. 
 
# dev ::= instance, pn1 ::= pin1, pn2 ::= pin2, val ::= voltage delta 
 
  proc check_pin_voltages { dev pn1 pn2 val} { 
    set pv1 [<a class="xref fm:HeadingOnly" href="Command_Percvoltage_id84e75b60.html#id84e75b60-58d3-47f4-b206-1f2333157773__Command_Percvoltage_id84e75b60.xml#id84e75b60-58d3-47f4-b206-1f2333157773" title="Returns voltage values for a net or pin.">perc::voltage</a> [<a class="xref fm:HeadingOnly" href="Command_PercgetPins_idcfb94cf6.html#idcfb94cf6-a4dc-4442-ac03-614d308693ed__Command_PercgetPins_idcfb94cf6.xml#idcfb94cf6-a4dc-4442-ac03-614d308693ed" title="Creates a pin iterator.">perc::get_pins</a> $dev -name $pn1] -path] 
    set pv2 [perc::voltage [perc::get_pins $dev -name $pn2] -path] 
# ignore undefined or multiple voltages, but report them in the transcript 
    if { [llength $pv1] != 1 || [llength $pv2] != 1 } {  
      print_voltages $dev $pn1 $pv1 $pn2 $pv2 
      return 0 
    } 
     
# If "undefined" nodes are to be treated as errors do this instead: 
#   if { [llength $pv1] != 1 || [llength $pv2] != 1 } {  
#     print_voltages $dev $pn1 $pv1 $pn2 $pv2 
#     return 1  
#   } 
 
# out of tolerance pin voltage differences are an error 
    if {([expr {$pv1 - $pv2}] &gt; $val) || ([expr {$pv2 - $pv1}] &gt; $val)} {  
      return 1  
    } else { 
      return 0 
    }  
  } </code></pre><p class="p">These procedures can be in a Tcl file that
you source from your rule file. The procedures can then be called
when needed.</p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCChap_CalibrePercVoltageRuleChecks_id2b941fd5.html" title="The Calibre PERC voltage checking capability is used for static voltage verification of a design. The voltage checking capability entails assignment of numeric labels to nets (logical labels are also supported, which may have underlying numeric values). These voltage labels can then be propagated throughout the design along topological paths meeting well-defined conditions. Numeric valued labels implicitly have an order to them, which is something that net and path type labels do not generally support. This facilitates sorting and testing of voltage values using mathematical expressions in appropriate checks.">Calibre PERC Voltage Rule Checks</a></div>
</div>

<div class="linklist linklist relinfo"><strong>Related Topics</strong><br />

<div><a class="link" href="../topics/Concept_UnifiedPowerFormatSupport_idca5116bc.html" title="Calibre PERC supports Unified Power Format (UPF). A UPF file defines a design’s power domain intent. The file includes elements such as voltages, supply nets, power states, power switches, level shifters, isolation, and retention.">Unified Power Format Support</a></div></div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_perc_user"
                DocTitle = "Calibre® PERC™ User’s Manual"
                PageTitle = "Useful Utility Procedures"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_UsefulUtilityProcedures_ide324021e.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® PERC™ User’s Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>