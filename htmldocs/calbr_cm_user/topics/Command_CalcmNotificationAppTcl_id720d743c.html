<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="CommandRefTopic" />
<meta name="DC.Title" content="calcm_notification_app.tcl" />
<meta name="abstract" content="Monitors a calcmd log file and cluster status to send notifications to the job administrator if necessary." />
<meta name="description" content="Monitors a calcmd log file and cluster status to send notifications to the job administrator if necessary." />
<meta name="DC.subject" content="CalCM applications, calcm_notification_app.tcl" />
<meta name="keywords" content="CalCM applications, calcm_notification_app.tcl" />
<meta name="prodname" content="Calibre Cluster Manager (CalCM) User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-26" />
<meta name="Topline" content="Siemens EDA" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="2" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_cm_user" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="none" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® Cluster Manager (CalCM) User’s Manual" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,doc.type.documentation.sys,product.version.v2021.2,product.id.P10101" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="2021.1" />
<meta name="HighlightChanges" content="yes" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id720d743c-7ba3-44d8-befe-aa2263917509" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>calcm_notification_app.tcl</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="calcm_notification_app.tcl" />
<meta name="attributes" content="doc.type.documentation.user,doc.type.documentation.sys,product.version.v2021.2,product.id.P10101" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body class="usa-arg" id="id720d743c-7ba3-44d8-befe-aa2263917509">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">calcm_notification_app.tcl</h1>
<div class="body refbody CommandRefBody"><div class="abstract CommandRefAbstract"><span class="shortdesc">Monitors
a calcmd log file and cluster status to send notifications to the
job administrator if necessary.</span>
</div>
<div class="section Usages"><h2 class="title Subheading sectiontitle">Usage</h2><div class="section UsageSet"><p class="lines UsageLine"><span class="keyword ParameterName Required">APPLICATION TCL</span> <span class="keyword ParameterName RequiredReplaceable">path</span><span class="keyword ParameterName Required">/calcm_notification_app.tcl</span> [ FILE ‘[‘</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">NOTIFYCMD</span> = <span class="keyword ParameterName OptionalReplaceable">cmd</span>]</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">ATTRTRACKERS</span> = <span class="keyword ParameterName OptionalReplaceable">tracker_list</span>]</p>
<p class="lines UsageLine">   [CHECKINTERVAL = <span class="keyword ParameterName OptionalReplaceable">sec</span>]</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">DBPATH</span> = <span class="keyword ParameterName OptionalReplaceable">file_path</span>]</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">DAEMONFILTERS</span> = <span class="keyword ParameterName OptionalReplaceable">proc</span>]…</p>
<p class="lines UsageLine">   [EVENTFILTERS = <span class="keyword ParameterName OptionalReplaceable">regexp</span>]…</p>
<p class="lines UsageLine">   [EVENTTRACKERS = <span class="keyword ParameterName OptionalReplaceable">tracker_list</span>]</p>
<p class="lines UsageLine">   [JOBEVENTFILTERS = <span class="keyword ParameterName OptionalReplaceable">regexp</span>]…</p>
<p class="lines UsageLine">   [JOBEVENTTRACKERS = <span class="keyword ParameterName OptionalReplaceable">tracker_list</span>]</p>
<p class="lines UsageLine">   [JOBFILTERS = <span class="keyword ParameterName OptionalReplaceable">proc</span> …]</p>
<p class="lines UsageLine">   [JOBTIMEOUT = <span class="keyword ParameterName OptionalReplaceable">sec</span>]</p>
<p class="lines UsageLine">   [KILLONTIMEOUT = <span class="keyword ParameterName OptionalReplaceable">flag</span>]</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">MASTERFILTERS</span> = <span class="keyword ParameterName OptionalReplaceable">proc</span>]…</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">NOTIFYCONF</span> = <span class="keyword ParameterName OptionalReplaceable">file_path</span>]</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">NOTIFYEMAIL</span> = <span class="keyword ParameterName OptionalReplaceable">email_list</span>]</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">NOTIFYINTERVAL</span> = <span class="keyword ParameterName OptionalReplaceable">sec</span>]</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">NOTIFYSHUTDOWN</span> = <span class="keyword ParameterName OptionalReplaceable">flag</span>]</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">PRUNEDBINTERVAL</span> = <span class="keyword ParameterName OptionalReplaceable">interval</span>]</p>
<p class="lines UsageLine">   [PRUNEDBSAVETIME = <span class="keyword ParameterName OptionalReplaceable">value</span>]</p>
<p class="lines UsageLine">   [<span class="keyword ParameterName Optional">PRUNEDBSTARTTIME</span> = <span class="keyword ParameterName OptionalReplaceable">time</span>]</p>
<p class="lines UsageLine">   [RECORDMESSAGE = <span class="keyword ParameterName OptionalReplaceable">value</span>]</p>
<p class="lines UsageLine">   [REMOTEFILTERS = <span class="keyword ParameterName OptionalReplaceable">proc</span>]…</p>
<p class="lines UsageLine">   [TIMEOUT = <span class="keyword ParameterName OptionalReplaceable">sec</span>]</p>
<p class="lines UsageLine">   [VERSIONFILTERS = <span class="keyword ParameterName OptionalReplaceable">filters</span>]</p>
<p class="lines UsageLine">‘]’ ]</p>
</div>
</div>
<div class="section Arguments"><h2 class="title Subheading sectiontitle">Arguments</h2><div class="section ArgumentSet"><dl class="dl ArgumentList"><dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id9acd2480-62e6-4890-8ebb-c2e5f8c5f451"><span class="keyword ParameterName Optional">NOTIFYCMD</span> = <span class="keyword ParameterName OptionalReplaceable">cmd</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the command that is
used to send notifications based on event, job, and cluster status.
The NOTIFYCMD is used with calcm_notification_app.tcl arguments
to report notifications to specified users. The default notification
is to send an e‑mail. An example of this command using the Linux
mail command is as follows:</p>
<p class="p">NOTIFYCMD = {mail -s $subject
$users &lt;&lt; $body &amp;}</p>
<p class="p">where <span class="keyword ParameterName OptionalReplaceable">cmd</span> is
enclosed in braces ({ }), both $subject and $body are set by the
calcmd, and $users includes $user in NOTIFYEMAIL. Multiple commands
can be split with the backslash (\) as shown:</p>
<pre class="pre codeblock"><code>NOTIFYCMD = {mail -s $subject $users &lt;&lt; $body &amp;} \
{echo $body &gt;&gt; notification.txt &amp;}</code></pre></dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id98a28ae2-2b39-4b62-a425-9800acbdedfc"><span class="keyword ParameterName Optional">ATTRTRACKERS</span> = <span class="keyword ParameterName OptionalReplaceable">tracker_list</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies a list of attribute trackers used
to gather specific information for notifications about the job and
cluster status. The list is enclosed in braces ({ }) as shown:</p>
<p class="p BlockIndent">{“<span class="keyword ParameterName OptionalReplaceable">name</span>” <span class="keyword ParameterName OptionalReplaceable">limit</span> <span class="keyword ParameterName OptionalReplaceable">value</span> <span class="keyword ParameterName OptionalReplaceable">exp</span>}</p>
<p class="p">where the attribute tracker arguments are defined as follows:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id214ad7ee-0e01-44cf-8cb7-e93f69ea1227"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">name</span> —
The attribute tracker name enclosed in quotes (“ ”). To add the
attribute tracker for the host where calcmd is launched, you must
include the keyword “daemon” in “<span class="keyword ParameterName OptionalReplaceable">name</span>”.</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id78ab9cbc-5a26-4ba8-91c7-533682033176"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">limit</span> —
The number of results to keep.</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__idb8f58c60-36ac-42f3-a00b-7e909ade6ddf"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">value</span> —
The actual stored value that can be specified by a Nemo API or a
predefined value. Refer to the “<a class="xref fm:HeadingOnly" href="MGCAppe_CalcmNemoApiReferenceDictionary_idfc68f3b5.html#idfc68f3b5-3a0e-43ff-998e-9f75f120f1dc__MGCAppe_CalcmNemoApiReferenceDictionary_idfc68f3b5.xml#idfc68f3b5-3a0e-43ff-998e-9f75f120f1dc" title="This section provides reference information on the Tcl commands that can be used to create or customize CalCM applications. Information is also provided on the cluster snapshot and related object types.">CalCM Nemo API Reference Dictionary</a>” for more
information.</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__idb5a7d4fd-46d5-424d-8cc8-181c164ab380"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">exp</span> —
The evaluating expression used to obtain the result. Valid predefined
variables include:</p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id254e681e-f065-403d-9226-f9f60ed9c9c6"><p class="p">value —
The retrieved value from <span class="keyword ParameterName OptionalReplaceable">value</span>.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id7948ddfc-8fa7-4e1b-84c0-b692fcc0f1ca"><p class="p">dvalue — The
integer value from <span class="keyword ParameterName OptionalReplaceable">value</span>.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__idf480c506-4be2-4321-806a-ed535515174c"><p class="p">pvalue — The
value from the previous cycle <span class="keyword ParameterName OptionalReplaceable">value</span>.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id49210a49-b2d2-4385-8385-7f478ddf250d"><p class="p">pdvalue — The
integer value from the previous cycle <span class="keyword ParameterName OptionalReplaceable">value</span>.</p>
</li>
</ul>
</li>
</ul>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__idebda433f-f41a-40cc-be13-e60079ec910c">CHECKINTERVAL = <span class="keyword ParameterName OptionalReplaceable">sec</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies a value in seconds
for how frequently the calcmd log is monitored. It is recommended
to keep this value the same as the <a class="xref fm:HeadingOnly" href="Command_ServerInterval_idfc2cf818.html#idfc2cf818-d6d9-42ab-a12a-fe7221cace0e__Command_ServerInterval_idfc2cf818.xml#idfc2cf818-d6d9-42ab-a12a-fe7221cace0e" title="Specifies the update interval.">SERVER INTERVAL</a> value in the CalCM configuration
file (<span class="ph filepath">calcmd.conf</span>). The default value is 60
seconds.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id878c4bff-9969-43fa-8c0d-bc4e1f4082de"><span class="keyword ParameterName Optional">DBPATH</span> = <span class="keyword ParameterName OptionalReplaceable">file_path</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the path to the notification database.
You can define the file permissions for the database file by appending
the permissions to the filename (for example, <span class="ph filepath">calcm_notification.db,775</span>).
The default is <span class="ph filepath">calcm_notification.db. nam</span>e.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id416e74dd-cbcd-4a7c-afb5-7caa38bd7c6f"><span class="keyword ParameterName Optional">DAEMONFILTERS</span> = <span class="keyword ParameterName OptionalReplaceable">proc</span> …</dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies Tcl procedures to filter CalCM
daemon host status information. If there is a match, the daemon
status or attribute tracker information is reported to the user(s)
specified in NOTIFYCMD. Note that the status or attribute tracker
information is available only if you use an application to monitor
and collect the hardware information for the daemon host. The variables
and Tcl procedures used for DAEMONFILTERS are the same as those
used for MASTERFILTERS argument and <a class="xref fm:HeadingOnly" href="Command_RemoteResource_id94665948.html#id94665948-463d-4a78-b64f-a4aa0d0c8a79__Command_RemoteResource_id94665948.xml#id94665948-463d-4a78-b64f-a4aa0d0c8a79" title="Specifies a resource requirement for remote hosts.">REMOTE RESOURCE</a> command.
The default is no specification.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id534b370e-04e4-4eb1-be05-f415eb75a7f5">EVENTFILTERS = <span class="keyword ParameterName OptionalReplaceable">regexp</span> …</dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies Tcl regular expressions
for evalEvent, evalFilter, and evalFilterExpr Tcl procedures for
the events to match against each line in the CalCM daemon log file (<span class="ph FontProperty emphasis">calcmd.log</span>).
If there is a match, then the event is reported to the user(s) specified
in NOTIFYCMD. Use braces ({  }) to enclose the filter for proper
handling of the backslash (\) character and other special characters. </p>
<p class="p">Tcl procedures starting with “eval1*”, specified as “eval1Event”,
“eval1Filter”, and “eval1FilterExpr”, can be used to report a notification
only once. After the first report, the notification is removed from
the filter and no longer monitored. </p>
<p class="p">The evalEvent Tcl procedure can be used with EVENTFILTERS to
check the frequency or number of occurrences of the event tracker.
If specified, an action is evaluated. The format of the evalEvent
argument is as follows:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id74877d58-2108-4860-93d5-6b143fea7117"><p class="p Opt">evalEvent
“<span class="keyword ParameterName OptionalReplaceable">name</span>” <span class="keyword ParameterName OptionalReplaceable">limit</span> <span class="keyword ParameterName OptionalReplaceable">message</span> [<span class="keyword ParameterName OptionalReplaceable">action</span>]</p>
<p class="p">where the event tracker arguments are defined as follows:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id84b90769-fbf5-4948-83e2-57bf2bf1077f"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">name</span> —
Represents the event tracker name enclosed in quotes (“ ”).</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id82765284-8b56-401c-9acb-bf4e22a7e771"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">limit </span>—
Specifies that if the number of occurrences of the event tracker
is more than the limit, the message is reported, and the counter
is reset. The value of the limit is specified as a positive integer.</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__idbdc448cc-88cc-49aa-baf4-9ee204d48ff0"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">message</span> —
Specifies the message for the event that is reported. </p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__ida3e5a535-c94a-4ba4-82cb-45b02a96c2c0"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">action</span> —
Specifies the action for the event that is reported.</p>
</li>
</ul>
</li>
</ul>
<p class="p">The evalFilter Tcl procedure can be used with EVENTFILTERS to
filter the event and to notify of the occurrence of the event. If
specified, an action is evaluated. The format of the evalFilter
argument is as follows:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__idbcd50fd5-6a9c-4ea4-92d1-b23748f6d542"><p class="p Opt">evalFilter <span class="keyword ParameterName OptionalReplaceable">filter</span> <span class="keyword ParameterName OptionalReplaceable">message</span> [<span class="keyword ParameterName OptionalReplaceable">action</span>]</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id24306ffc-695d-4861-8b3f-a6bce6f6722b"><p class="p Opt">where
the event tracker arguments are defined as follows:</p>
<p class="p"><span class="keyword ParameterName OptionalReplaceable">filter</span> —
Specifies the filter match for the event that is reported.</p>
<p class="p"><span class="keyword ParameterName OptionalReplaceable">message</span> —
Specifies the message for the event that is reported. </p>
<p class="p"><span class="keyword ParameterName OptionalReplaceable">action</span> —
Specifies the action for the event that is reported.</p>
</li>
</ul>
</li>
</ul>
<p class="p">The evalFilterExpr Tcl procedure can be used with EVENTFILTERS
to act based on the filter match and the condition. </p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id5a738f8b-1205-4bbb-a4de-18f870c709bc"><p class="p Opt">evalFilterExpr <span class="keyword ParameterName OptionalReplaceable">filter</span> <span class="keyword ParameterName OptionalReplaceable">condition</span> <span class="keyword ParameterName OptionalReplaceable">message</span> [<span class="keyword ParameterName OptionalReplaceable">action</span>]</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__idde5695fe-24a1-488f-bfa1-c7b7d7ee6b9f"><p class="p Opt">where
the event tracker arguments are defined as follows:</p>
<p class="p"><span class="keyword ParameterName OptionalReplaceable">filter</span> —
Specifies the filter match for the event that is reported.</p>
<p class="p"><span class="keyword ParameterName OptionalReplaceable">condition</span> —
Specifies the condition to be met for the event that is reported.</p>
<p class="p"><span class="keyword ParameterName OptionalReplaceable">message</span> —
Specifies the message for the event that is reported. </p>
<p class="p"><span class="keyword ParameterName OptionalReplaceable">action</span> —
Specifies the action for the event that is reported.</p>
</li>
</ul>
<p class="p">An example of EVENTFILTERS with the evalFilter and evalEvent
Tcl procedures is shown:</p>
<pre class="pre codeblock"><code>EVENTFILTERS = {evalFilter {^/*\s*Your timebomb license will expire}}\
{^\s*ERROR:}\
{^WARNING: \(LBD\)}
{evalEvent “license_recover_failure” 10 {license recovery failed more than $count times.}}
</code></pre></dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id25fb7e34-1267-4bff-8600-5c146eca5eac"><span class="keyword ParameterName Optional">EVENTTRACKERS</span> = <span class="keyword ParameterName OptionalReplaceable">tracker_list</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the list of event trackers. The
list is enclosed in braces ({ }) as shown:</p>
<p class="p BlockIndent">{“<span class="keyword ParameterName OptionalReplaceable">name</span>” <span class="keyword ParameterName OptionalReplaceable">limit</span> <span class="keyword ParameterName OptionalReplaceable">filter</span> [<span class="keyword ParameterName OptionalReplaceable">condition</span>]}</p>
<p class="p">where the event tracker arguments are defined as follows:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id559a90c0-ad49-40d3-9c84-237801fc4a5e"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">name</span> —
Represents the event tracker name enclosed in quotes (“ ”).</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id7016edc0-1319-4f37-9f9f-ac0ad28a8ce7"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">limit</span> —
Specifies how many evaluated results to keep. A value of ‑1 can
be specified to keep the number of matched results indefinitely.</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__idc56a261f-aeaa-44f4-a985-7e99d26d779f"><p class="p Opt"><span class="keyword ParameterName OptionalReplaceable">filter</span> —
Specifies the regular expression applied to the CalCM daemon log
file (<span class="ph FontProperty emphasis">calcmd.log</span>).</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id3c8feab4-5046-410f-ac4a-1ced0a75a82c"><p class="p Opt">[<span class="keyword ParameterName OptionalReplaceable">condition</span>]
— Specifies a condition that determines whether the event tracker
is triggered. If no condition is specified, the event tracker triggers
when the filter argument is matched. The arguments in the condition
are extracted as “arg<span class="keyword ParameterName OptionalReplaceable">n</span>”
based on the filter and the number of arguments “argc”, the elapsed
time “elapsed”, and the user name “user”.</p>
</li>
</ul>
<p class="p">An example of EVENTTRACKERS is shown:</p>
<pre class="pre codeblock"><code>EVENTTRACKERS = {"license_recover_failure" -1 {Unable to recover all licenses}} </code></pre></dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id2c830ada-aa55-444d-8367-68d3bb821196"><span class="keyword ParameterName Optional">JOBEVENTFILTERS</span> = <span class="keyword ParameterName OptionalReplaceable">regexp</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies Tcl regular expressions for evalEvent,
evalFilter, or evalFilterExpr Tcl procedures for job events. If
specified, the job’s transcript is matched with the specified filters.
If there is a match, the notification is recorded in the notification
database and reported to the user(s) specified in NOTIFYCMD. The
jobAttr can be used in the condition argument to check the job attributes
specified in the <span class="ph filepath">job.conf</span> file. Use braces
({ }) to enclose the filter for proper handling of the backslash
(\) character and other special characters.</p>
<p class="p">An example of JOBEVENTFILTERS is shown:</p>
<pre class="pre codeblock"><code>JOBEVENTFILTERS = {^/*\s*Your timebomb license will expire}\
	{^\s*ERROR:} \
	{evalFilterExpr {^CPU TIME = (\d+)[+ ]*(\d*).* REAL TIME = (\d+) .* OPS COMPLETE = (\d+)} {$argc &gt; 3 &amp;&amp; ($arg3 &gt; ($arg1 + $arg2))} {OP $arg4 with REAL TIME &gt; CPU TIME.}}
</code></pre></dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id2d8b91f5-c9bd-438a-849f-eb804b7217ac"><span class="keyword ParameterName Optional">JOBEVENTTRACKERS</span> = <span class="keyword ParameterName OptionalReplaceable">tracker_list</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the list of job event trackers
as specified in EVENTTRACKERS. The job event tracker is applied
to the job’s transcript. The jobAttr can be used in the condition
argument to check the job attributes specified in the <span class="ph filepath">job.conf</span> file.</p>
<p class="p">An example of JOBEVENTTRACKERS is shown:</p>
<pre class="pre codeblock"><code>JOBEVENTTRACKERS = {"no_remote_cpu" -1 {^CPU TIME = (\d+)[+ ]*(\d*).* REAL TIME = (\d+) .* OPS COMPLETE} {$argc == 3 &amp;&amp; $arg2 == 0}}</code></pre></dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id404a97f2-af5d-4b3b-b98f-d511d8e08990"><span class="keyword ParameterName Optional">JOBFILTERS</span> = <span class="keyword ParameterName OptionalReplaceable">proc</span> …</dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies Tcl procedures
to filter job information. The Tcl procedures evalExpr and evalAttr can
be used in conjunction with the results gathered from a JOBFILTERS
attribute tracker list. If there is a match, the notification is
reported to the user(s) specified in NOTIFYCMD. If specified, an
action is evaluated. You can use the <a class="xref fm:HeadingOnly" href="Command_Nemojob_id593e22ab.html#id593e22ab-dc5f-4ac7-ad64-96086bf13bfd__Command_Nemojob_id593e22ab.xml#id593e22ab-dc5f-4ac7-ad64-96086bf13bfd" title="Returns information on the Calibre job that is running.">nemo::job</a> API with
$jobObject and the <a class="xref fm:HeadingOnly" href="Command_Nemomaster_id9b8d692b.html#id9b8d692b-9cba-45f5-aac9-8f94a723417a__Command_Nemomaster_id9b8d692b.xml#id9b8d692b-9cba-45f5-aac9-8f94a723417a" title="Returns information about the Calibre primary process.">nemo::master</a> API with
$masterObj to get specific information about a Calibre job and primary
process. Refer to the “<a class="xref fm:HeadingOnly" href="MGCAppe_CalcmNemoApiReferenceDictionary_idfc68f3b5.html#idfc68f3b5-3a0e-43ff-998e-9f75f120f1dc__MGCAppe_CalcmNemoApiReferenceDictionary_idfc68f3b5.xml#idfc68f3b5-3a0e-43ff-998e-9f75f120f1dc" title="This section provides reference information on the Tcl commands that can be used to create or customize CalCM applications. Information is also provided on the cluster snapshot and related object types.">CalCM Nemo API Reference Dictionary</a>” for more information.
The default is no specification. </p>
<p class="p">Tcl procedures starting with “eval1*”, specified as “eval1Expr”
and “eval1Attr”, can be used to report a notification only once.
After the first report, the notification is removed from the filter
and no longer monitored. </p>
<p class="p">The JOBFILTERS valid variables include:</p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id0bfd1e72-fcca-4727-aa6c-9848d90a34f0"><p class="p">jobObj
— Job object.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__idc6d202d4-7aac-4d96-adc1-c68bf31879a6"><p class="p">jobID — The
job ID of the job.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id5e2d01ab-221f-4d70-a060-788886f4e423"><p class="p">masterObj — The primary host object of the
job.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id25f042dd-a8a2-4a14-a7df-874eb2e13601"><p class="p">hdb — The HDB number for each primary.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__idb92968d3-122e-47ce-a596-77ec21dfa09a"><p class="p">nodeObj — The primary node object of the job.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id03177ccb-98a9-45a1-b977-06d13db703db"><p class="p">nodeName — The primary node name.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id7ac683ee-0caa-4c41-b9c4-0c1e9815207a"><p class="p">user — The
user who launched the job.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id32a0e836-11bf-4431-bca8-c431c35dd825"><p class="p">updated — The
boolean flag indicating whether the job is updated properly.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__iddf187a90-87f1-4edf-bda1-25066e0a84ff"><p class="p">demand — The
job’s total CPU demand.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__iddaf25387-085e-4037-a836-d3481187bb68"><p class="p">adjusted_demand
— The job’s adjusted CPU demand.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__idb283bb25-ceb6-4e99-b712-74a92d5952bf"><p class="p">cpu_adjustable
— The boolean flag indicating whether the job CPU supply is adjustable.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id76963266-6d82-4283-a687-936f74f9e1ec"><p class="p">supply — The
number of remotes supplied to the job.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id9b02efad-928d-49c7-b9e9-4181ecb6fb08"><p class="p">revoke — The
number of remotes revoked from the job.</p>
</li>
</ul>
<p class="p">The evalExpr Tcl procedure argument format is as follows:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id737a8c3b-4d8b-4136-a556-e656d6a18ac7"><p class="p Opt">evalExpr <span class="keyword ParameterName OptionalReplaceable">expr</span> <span class="keyword ParameterName OptionalReplaceable">message</span> [<span class="keyword ParameterName OptionalReplaceable">action</span>] </p>
<p class="p">If the evalExpr <span class="keyword ParameterName OptionalReplaceable">expr</span> is
evaluated true, the message is reported and if specified, the action
is evaluated. The arguments for the evalExpr are as follows:</p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__idfc72bb13-779c-450a-8e3b-9251db39497d"><p class="p"><span class="keyword ParameterName OptionalReplaceable">expr</span> —
Specifies the expression to evaluate.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id393a7e66-e0c4-4026-b71d-e6de3e2eb9e2"><p class="p"><span class="keyword ParameterName OptionalReplaceable">message</span> —
Specifies the notification message if the expression is true.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id0587028e-cd1d-46fd-94ef-eb1b3a92b963"><p class="p"><span class="keyword ParameterName OptionalReplaceable">action</span> —
Specifies the action that is evaluated if the expression is true.
The JOBFILTERS variables can be used in the <span class="keyword ParameterName OptionalReplaceable">action</span> argument.</p>
</li>
</ul>
</li>
</ul>
<p class="p">The evalAttr Tcl procedure argument format is as follows:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id25ed852b-ad52-42ee-87f3-e6af0f2e3d29"><p class="p Opt">evalAttr
“<span class="keyword ParameterName OptionalReplaceable">name</span>” <span class="keyword ParameterName OptionalReplaceable">condition</span> <span class="keyword ParameterName OptionalReplaceable">message</span> [<span class="keyword ParameterName OptionalReplaceable">action</span>]</p>
<p class="p">If the evalAttr “<span class="keyword ParameterName OptionalReplaceable">name</span>”
is evaluated true for a specified condition, the message is reported.
After the notification, the attribute tracker information is reset.
The arguments for the evalAttr are as follows:</p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id142d316a-833f-41c6-8735-f37c9eb252df"><p class="p"><span class="keyword ParameterName OptionalReplaceable">name</span> —
The value or result to be evaluated enclosed in quotes (“ ”).</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__idbce90716-b9a6-46f4-bc91-c6e7a3d8592d"><p class="p"><span class="keyword ParameterName OptionalReplaceable">condition</span> —
The condition for evaluation.</p>
<p class="p">The following variables can be used in the condition argument
in addition to the JOBFILTERS variables:</p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__idf607ecfc-40e6-4e3e-9906-159729463aa9"><p class="p">count —
The number of positive results.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id91769673-6955-4673-bf68-bdaee24377eb"><p class="p">total — The
total number of positive results that occur and not reset.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id9b8c1bda-cf4d-4845-8733-0b4cc2d6d295"><p class="p">ncount — The
number of non‑positive results.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__idef4def7c-21c0-41a1-8b9e-ef5580a048fa"><p class="p">consecutive
— The number of consecutive positive results.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__idd3bd8c11-762f-40bc-bef7-87c3598dc042"><p class="p">nconsecutive
— The number of consecutive non‑positive results.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id32a5551b-bf64-40c5-9a3f-1078f0530406"><p class="p">limit — The
number of results tracked.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__ide3fedd46-0e62-43de-b055-d9038686b69b"><p class="p">values — The
list of values gathered from the attribute tracker list.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__ida70e0a51-bdce-4747-b1b3-1496fef8a1d2"><p class="p">value — The
last attribute tracker list value.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id414752a4-a533-4d18-9b52-95f9ff1e4e7e"><p class="p">dvalues — The
list of integer values gathered from the attribute tracker list.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id119a6a08-845e-43da-80e5-c33e3a7b2fad"><p class="p">dvalue — The
last integer value in the attribute tracker list.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id586f40cf-e4dd-46d9-b1b5-9c41c70e569f"><p class="p">results — The
list of results evaluated.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id3f9c08ce-d2b8-48f7-93bc-a314e8b47fcd"><p class="p">result — The
last result evaluated.</p>
</li>
</ul>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id4417dc8d-31de-4f43-9f64-e7f17ecd286e"><p class="p"><span class="keyword ParameterName OptionalReplaceable">message</span> —
The notification message if the expression is true. The variables
can be used from the <span class="keyword ParameterName OptionalReplaceable">condition</span> argument.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id5bf7055d-6a4c-49a8-b710-d6d516a0782e"><p class="p"><span class="keyword ParameterName OptionalReplaceable">action</span> —
Specifies the action that is evaluated if the expression is true.
The JOBFILTERS variables can be used in the <span class="keyword ParameterName OptionalReplaceable">action</span> argument.</p>
</li>
</ul>
</li>
</ul>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id0d8acf63-e378-45a5-b674-551b488427db"><span class="keyword ParameterName Optional">JOBTIMEOUT</span> = <span class="keyword ParameterName OptionalReplaceable">sec</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the timeout interval in seconds
until the job transcript is updated. If this timeout interval is
exceeded, it is reported. The default value is 4800 seconds. This
parameter is active only when JOBEVENTFILTERS is specified.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id743084a5-e504-4e1f-be2f-0196eb7753b4">KILLONTIMEOUT = <span class="keyword ParameterName OptionalReplaceable">flag</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies whether to kill the
CalCM daemon when the timeout interval occurs. The default is false;
do not kill. Valid values include:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__idd63c1621-bd7c-47aa-841e-aba5d4b5bf0f"><p class="p Opt">0
— CalCM daemon is not killed when timeout occurs (default).</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__idd1465dad-8b2d-4437-ac76-46227f8f132c"><p class="p Opt">1
— CalCM daemon is killed when timeout occurs.</p>
</li>
</ul>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id33cff93a-7688-4ce0-b0b2-4aaee87744da"><span class="keyword ParameterName Optional">MASTERFILTERS</span> = <span class="keyword ParameterName OptionalReplaceable">proc </span>…</dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies Tcl procedures
to filter Calibre primary process information. The Tcl procedures evalExpr
and evalAttr can be used in conjunction with the results gathered
from a MASTERFILTERS attribute tracker list. If there is a match,
the notification is reported to the user(s) specified in NOTIFYCMD.
You can use the Nemo API with $nodeObj to get specific information
about a primary process running on a cluster node. Refer to the “<a class="xref fm:HeadingOnly" href="MGCAppe_CalcmNemoApiReferenceDictionary_idfc68f3b5.html#idfc68f3b5-3a0e-43ff-998e-9f75f120f1dc__MGCAppe_CalcmNemoApiReferenceDictionary_idfc68f3b5.xml#idfc68f3b5-3a0e-43ff-998e-9f75f120f1dc" title="This section provides reference information on the Tcl commands that can be used to create or customize CalCM applications. Information is also provided on the cluster snapshot and related object types.">CalCM Nemo API Reference Dictionary</a>” for more
information. The variables used for MASTERFILTERS are the same as
the variables used for <a class="xref fm:HeadingOnly" href="Command_RemoteResource_id94665948.html#id94665948-463d-4a78-b64f-a4aa0d0c8a79__Command_RemoteResource_id94665948.xml#id94665948-463d-4a78-b64f-a4aa0d0c8a79" title="Specifies a resource requirement for remote hosts.">REMOTE RESOURCE</a>. The default
is no specification. The example is as follows: </p>
<pre class="pre codeblock"><code>MASTERFILTERS = {$down} \
	{evalExpr {$swap &gt;= 100} {The swap space is more than 100 mb.}}</code></pre></dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__idb55b00d5-6635-4b5d-8c61-99044e583c30"><span class="keyword ParameterName Optional">NOTIFYCONF</span> = <span class="keyword ParameterName OptionalReplaceable">file_path</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the path of a file that contains
the notification attribute trackers and filter configurations. The
following configuration variables are used: </p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id0839c919-aa2d-41fc-9210-059f97e6854a"><p class="p">ATTRTRACKERS</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id93029eec-8c34-42db-9d34-b12e5e3f6bfb"><p class="p">DAEMONFILTERS</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__iddc835336-519d-4a85-8915-7add158a59b2"><p class="p">EVENTFILTERS</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id3264734e-f67c-4540-9492-31fc709d439d"><p class="p">EVENTTRACKERS</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id835a3f6b-d5eb-49bd-a264-c9a72061193f"><p class="p">JOBEVENTFILTERS</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id1afdb5f8-d74d-48fb-93fc-55837e42b7da"><p class="p">JOBEVENTTRACKERS</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id0357204a-27bf-4771-b18c-b4dddfba4043"><p class="p">JOBFILTERS</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__ide5fcf98e-8acd-448b-afe5-f0701f07b223"><p class="p">MASTERFILTERS</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id14baf439-d4fe-45c5-91c6-0557d576e0b2"><p class="p">REMOTEFILTERS</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id9e6d0ae7-d577-4b14-b87c-e24373f397a4"><p class="p">VERSIONFILTERS</p>
</li>
</ul>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">By specifying notifications outside of the main CalCM configuration
file (<span class="ph filepath">calcmd.conf</span>), as with NOTIFYCONF and <a class="xref fm:HeadingOnly" href="Command_ResetNotification_id0d481b0e.html#id0d481b0e-d1f0-4a41-b7de-49a4a0c542a1__Command_ResetNotification_id0d481b0e.xml#id0d481b0e-d1f0-4a41-b7de-49a4a0c542a1" title="Reconfigures the attribute trackers and filters used for CalCM notifications.">reset_notification</a>, you
can update the notification settings without restarting the CalCM
daemon.</p>
</div>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__idad724016-6211-48fd-a299-9b52048329f7">NOTIFYEMAIL = <span class="keyword ParameterName OptionalReplaceable">email_list</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies
a list of comma‑separated e‑mail addresses that receive the notification.
The $user variable is substituted with the username that launched
the Calibre job, and the $defaultUserName variable is substituted
with the username that launched the calcmd. The default value is
$user.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id38fb6caa-4dc5-445e-b261-fa65913791e0"><span class="keyword ParameterName Optional">NOTIFYINTERVAL</span> = <span class="keyword ParameterName OptionalReplaceable">sec</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the interval for the notification
in seconds. It can be used to reduce the number of notification
e-mails by accumulating the notifications for the interval. The
default value is 1800 seconds.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id851412f7-d90e-4a40-80a6-ac3542d72a1c"><span class="keyword ParameterName Optional">NOTIFYSHUTDOWN</span> = <span class="keyword ParameterName OptionalReplaceable">flag</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies whether to notify if a shutdown
event of the CalCM daemon occurs. If the flag is set to true, the
event is triggered when detaching an application from the CalCM
daemon. The default is false; do not notify. Valid values include:</p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__idbe0b8f44-087a-4e98-b8a5-1f5a4fef7ad6"><p class="p Opt">0
— Do not notify when a CalCM daemon shutdown event occurs (default).</p>
</li>
<li class="li ArgOption" id="id720d743c-7ba3-44d8-befe-aa2263917509__id59ede803-154d-4eb2-b6b0-e3eef7447abe"><p class="p Opt">1
— Notify when a CalCM daemon shutdown event occurs. </p>
</li>
</ul>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id907825b7-f557-4298-9baa-589311e96179"><span class="keyword ParameterName Optional">PRUNEDBINTERVAL</span> = <span class="keyword ParameterName OptionalReplaceable">interval</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the interval for the notification
database pruning in seconds. Pruning begins at the next update,
and subsequent attempts to prune are done at each interval time.
The default interval is 0, which means no pruning. Pruning reduces
the size of the database by removing historical information.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id3fab8b0f-a4c6-4871-b522-816cdd3cb9db">PRUNEDBSAVETIME = <span class="keyword ParameterName OptionalReplaceable">value</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the maximum value in seconds that
data is saved in a table when the notification database pruning
is attempted. For example, if this value is set to 3600 and pruning
is attempted, any data older than 3600 seconds in the table is pruned.
The default value is 0, which means no pruning is attempted. Pruning
reduces the size of the database by removing historical information. </p>
<p class="p">You can specify the values separately for each table. The default
value applies to any tables without explicit values. Syntax for
wildcard (*) and multiple specifications are supported as shown
in these examples.</p>
<p class="p">Specify that all tables in the application save up to 3600 seconds
of data.</p>
<pre class="pre codeblock"><code>PRUNEDBSAVETIME = {* 3600}</code></pre><p class="p">Specify that the “notifications” table save up to 2400 seconds
of data, and the remaining tables save up to 3600 seconds of data.</p>
<pre class="pre codeblock"><code>PRUNEDBSAVETIME = {* 3600} \
				{notifications 2400}</code></pre></dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id66689acc-4fe0-40c4-9d42-e41928e4637e"><span class="keyword ParameterName Optional">PRUNEDBSTARTTIME</span> = <span class="keyword ParameterName OptionalReplaceable">time</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies when the notification database
pruning occurs. Pruning is attempted at the specified time. If specified
with PRUNEDBINTERVAL, the PRUNEDBINTERVAL setting is ignored, and
a warning is issued to the transcript. Pruning reduces the size
of the database by removing historical information.</p>
<p class="p">The following formats are supported:</p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__ide4943c05-db9f-43ea-9857-7cd32f6aa1a3"><p class="p">For daily
pruning, specify time as <span class="keyword ParameterName OptionalReplaceable">hour</span>:<span class="keyword ParameterName OptionalReplaceable">minute</span>.
For example, to prune the database at 1:00 a.m. each day, specify
“01:00”.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id96a0d163-5ee7-44fc-aed1-02e5589fa99b"><p class="p">For weekly
pruning, specify time as <span class="keyword ParameterName OptionalReplaceable">day‑of‑week</span>‑<span class="keyword ParameterName OptionalReplaceable">hour</span>:<span class="keyword ParameterName OptionalReplaceable">minute</span>.
For example, to prune the database on Monday at 8:00 a.m. each week,
specify “Monday‑08:00”.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id64ecb665-7f08-4950-823c-169b50565778"><p class="p">For monthly
pruning, specify time as <span class="keyword ParameterName OptionalReplaceable">week‑of‑the‑month</span>‑<span class="keyword ParameterName OptionalReplaceable">day‑of‑week</span>‑<span class="keyword ParameterName OptionalReplaceable">hour</span>:<span class="keyword ParameterName OptionalReplaceable">minute</span>. For
example, to prune the database at 1:00 a.m.on the first Sunday of
each month, specify “1st‑Sunday‑01:00”. To prune on the last Sunday
of each month at 1:00 a. m., specify “4th‑Sunday‑01:00”.</p>
</li>
</ul>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__idffd8a518-494b-4dfd-b36e-dd2e49d2a7b8">RECORDMESSAGE = <span class="keyword ParameterName OptionalReplaceable">value</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies whether or not to record messages
in the notification database. The default value is 1, which specifies
to record messages in the notifications database. Message recording
is disabled by specifying a value of 0. </p>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id61ec209d-4617-4ebf-9dc3-3743b70f8d72">REMOTEFILTERS =  <span class="keyword ParameterName OptionalReplaceable">proc </span>…</dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies Tcl procedures to
filter Calibre remote process information. If there is a match,
the remote status or attribute tracker information is reported to
the user(s) specified in NOTIFYCMD. The variables and Tcl procedures
used for REMOTEFILTERS are the same as those used for MASTERFILTERS
and <a class="xref fm:HeadingOnly" href="Command_RemoteResource_id94665948.html#id94665948-463d-4a78-b64f-a4aa0d0c8a79__Command_RemoteResource_id94665948.xml#id94665948-463d-4a78-b64f-a4aa0d0c8a79" title="Specifies a resource requirement for remote hosts.">REMOTE RESOURCE</a>. The
default is no specification.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id9d54740c-f6bd-4ff1-9cdf-8b5fb4dbb274">TIMEOUT = <span class="keyword ParameterName OptionalReplaceable">sec</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies the timeout interval
in seconds until all the CalCM daemon update cycle is finished.
If this timeout interval is exceeded, it is reported. The default
value is 2400 seconds.</p>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">The CalCM
daemon update cycle can slow down as a function of its required
workload. Update cycle times exceeding 10 minutes are considered
excessive and may indicate an issue that should be reported to the
CalCM administrator.</p>
</div>
</dd>
<dt class="dt ArgumentName dlterm" id="id720d743c-7ba3-44d8-befe-aa2263917509__id0e8d1f13-5bf7-4aa6-af8d-dc3904eb4d40">VERSIONFILTERS = <span class="keyword ParameterName OptionalReplaceable">filters</span></dt>
<dd class="dd ArgumentDescription"><p class="p">Specifies a Calibre version that is not
supported in CalCM. A notification is reported for the job with
the version that matches the filter. If the optional job mode parameter
is specified, it is reported in the notification only if the version
and the mode(s) match the filter. After the filter is matched, no
further version checking is done. </p>
<p class="p">The allowed modes are as follows:</p>
<pre class="pre codeblock"><code>DCA: Dynamic CPU allocation (supply/revoke of remotes)
HT: Hyperthread
HS: Hyperscale
</code></pre><p class="p">Filters are specified one per line. For multiple filters, the
backslash (\) is used. The example is as follows: </p>
<pre class="pre codeblock"><code>VERSIONFILTERS = {&lt;2010.2} \
                 {2016.2_1.&lt;100 HT HS DCA} \
                 {CALIBREWB &lt;2016.2}</code></pre><p class="p">where version filters are specified as follows:</p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__ida00c3b6f-7c44-46b0-874e-3379eb8424cc"><p class="p">A filter
is composed of a sub-version that is separated with “.” or “_” and
the mode. </p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id4e7ff2d3-afca-462e-927d-85584e3fcd57"><p class="p">A comparison
operator can be specified before the sub-version. The default comparison
value is “==” (match).</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id933e6e45-ddce-4024-99d1-20ce10b50e9a"><p class="p">An optional
executable name can be specified before the version filter to apply
the filter for a specific binary such as “calibrewb”. The strings
“CALIBRE” and “CALIBREWB” can be specified in the executable name.
Notification occurs only if the version and the job mode(s) are
matched. </p>
</li>
</ul>
<p class="p">See “<a class="xref fm:HeadingAndPage" href="#id720d743c-7ba3-44d8-befe-aa2263917509__id0078ee82-5bbc-4b2f-a526-32352cd52423">Example 5</a>” for expanded
details.</p>
</dd>
</dl>
</div>
</div>
<div class="section Descriptions"><h2 class="title Subheading sectiontitle">Description</h2><p class="p">The calcm_notification_app.tcl
application checks the calcmd log file in the background and reports
warnings or errors on every update cycle. Filters for the job, primary,
and remote processes are also evaluated during the application update.
If the attribute tracker and filter conditions are matched, the
notification is reported at the end of the update cycle. The option KILLONTIMEOUT
can be used to kill the CalCM daemon if necessary. The default filter
for the calcm_notification_app.tcl application is as follows:</p>
<pre class="pre codeblock leveled"><code>{^/*\s*Your timebomb license will expire} 
{^\s*ERROR:} 
{^WARNING: \ (LBD\)} 
 </code></pre><p class="p">The calcm_notification_app.tcl application also supports a tag
syntax for grouping notifications. The tags can be used to show
filtered messages on the jobs detail web page of the CalCM dashboard.
If a notification filter has no tag, the default tag is “notifications”.
See “<a class="xref fm:HeadingAndPage" href="#id720d743c-7ba3-44d8-befe-aa2263917509__id0bda401f-eba5-42a2-9b22-15983a885a89">Example 7</a>” for expanded
details.</p>
</div>
<div class="section Examples"><h2 class="title Subheading sectiontitle">Examples</h2><div class="section Subsection" id="id720d743c-7ba3-44d8-befe-aa2263917509__idaf20f814-61b4-450b-8e9e-bc1d3ee11279"><h2 class="title Subheading sectiontitle">Example
1</h2><p class="p">This is an example of calcm_notification_app.tcl usage that sends
an e-mail whenever a log file line is detected that starts with
“ERROR:”, has the phrase “Your timebomb will expire”, or if the
JOB UPDATE to next JOB UPDATE interval exceeds 600 seconds. The
CalCM daemon is not killed upon timeout.</p>
<pre class="pre codeblock leveled"><code>APPLICATION TCL $CALCM_APP/calcm_notification_app.tcl FILE [ 
LOG = $CALCM_HOME/notification.log 
NOTIFYCMD = {mail -s $subject $user &lt;&lt; $body &amp;} 
NOTIFYEMAIL = yourEmail@yourDomain 
EVENTFILTERS = {(^\s*ERROR:) | (Your timebomb will expire)} 
TIMEOUT = 600 
KILLONTIMEOUT = 0 
] 
 </code></pre></div>
<div class="section Subsection" id="id720d743c-7ba3-44d8-befe-aa2263917509__id2d38bd1d-8efc-4ab2-8638-a3d8efda9021"><h2 class="title Subheading sectiontitle">Example
2</h2><p class="p">This is an example of the calcm_notification_app.tcl application
using ATTRTRACKERS and JOBFILTERS to report low CPU demand using
the Tcl evalAttr procedure. If the CPU demand is less than or equal
to zero for nine consecutive update cycles, it is reported.</p>
<pre class="pre codeblock"><code>ATTRTRACKERS = {"demand,$jobID" 10 $demand {$dvalue &lt;= 0}}
JOBFILTERS = {evalAttr "demand,$jobID"
{$consecutive &gt;= $limit-1}
{The demand was less than 0 for $limit update cycles.}}</code></pre></div>
<div class="section Subsection" id="id720d743c-7ba3-44d8-befe-aa2263917509__id06f39586-26e3-4d30-bd37-24d7bc49b11d"><h2 class="title Subheading sectiontitle">Example
3</h2><p class="p">This is an example of the calcm_notification_app.tcl
application using JOBFILTERS with the nemo::job API to retrieve
the number of Calibre primary processes and report low CPU demand using
the Tcl evalAttr procedure.</p>
<pre class="pre codeblock"><code>JOBFILTERS = {evalExpr {[nemo::job number_of_masters $jobObj] == 0} {The number of HDB is 0.}} \
{evalAttr "demand,$jobID" {$consecutive &gt;= $limit-1} {The demand was less than 0 for $limit update cycles ($attrValues($name)).}}</code></pre></div>
<div class="section Subsection" id="id720d743c-7ba3-44d8-befe-aa2263917509__idce94e197-5179-40a9-94e1-7d528894684c"><h2 class="title Subheading sectiontitle">Example
4</h2><p class="p">This is an example of the calcm_notification_app.tcl application
using ATTRTRACKERS and REMOTEFILTERS to report memory swap space
with the Tcl evalAttr procedure. If the swap space is greater than
or equal to 100 MB for ten consecutive cycles, it is reported. This
attribute tracker and filter can also be specified for MASTERFILTERS.</p>
<pre class="pre codeblock"><code>ATTRTRACKERS = {"swap,$nodeName" 10 $swap {$dvalue &lt;= 100}}
REMOTEFILTERS = {evalAttr {$swap &gt;= 100}
{$consecutive &gt;= $limit-1}
{The swap space is more than 100 mb for $limit update cycles.}}</code></pre></div>
<div class="section Subsection" id="id720d743c-7ba3-44d8-befe-aa2263917509__id0078ee82-5bbc-4b2f-a526-32352cd52423"><h2 class="title Subheading sectiontitle">Example
5</h2><p class="p">This is an example of the calcm_notification_app.tcl application
using VERSIONFILTERS to filter and report notifications for Calibre
versions and modes that are not supported in CalCM. This syntax
can also be used for calcm_jobqueue_app.tcl VERSIONFILTERS.</p>
<pre class="pre codeblock"><code>VERSIONFILTERS = {&lt;2010.2} \
                 {2016.2_1.&lt;100 HT HS DCA} \
                 {CALIBREWB &lt;2016.2}</code></pre><p class="p">Filters are applied as follows:</p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id0c35a255-8d27-4400-9759-304d085dc0c3"><p class="p">The version
“2010.1_23” is matched to the first filter “&lt;2010.2” because
“2010.1_23” is less than “2010.2”. </p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id1869c433-98d3-4f1d-ad3a-7798bbf6ace1"><p class="p">The version
“2016.2_1.99” is matched in the second filter because “2016.2_1”
is equal and “99 &lt; 100”. The job is launched in HYPER MTFLEX
mode and is matched to HS and DCA. </p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id2ea877f8-4b76-4e67-b5b0-f9449fed2a6a"><p class="p">The version
of “CALIBREWB” that is less than “2016.2” is matched to the third
filter.</p>
</li>
</ul>
</div>
<div class="section Subsection" id="id720d743c-7ba3-44d8-befe-aa2263917509__id2806b482-4729-4676-9556-2b00b7701764"><h2 class="title Subheading sectiontitle">Example
6</h2><p class="p">This is an example of the calcm_notification_app.tcl application
using REMOTEFILTERS to launch a custom script when a remote host
is detected to have low memory and high swap usage. Specify the
expression on a single line.</p>
<pre class="pre codeblock"><code>REMOTEFILTERS = {evalExpr {$mem_free &lt; 20000 &amp;&amp; $swap &gt; 10000}
 {Remote free memory &lt; 20 GB, Swap &gt; 10 GB,
  launching analyze_remote_memory_usage}
 {exec /usr/bin/timeout 60s ssh -oStrictHostKeyChecking=no
  -oBatchMode=yes $hostname <var class="keyword varname italic">FullPath</var>/analyze_remote_memory_usage &gt;&gt;
<var class="keyword varname italic">FullPath</var>/analyze_remote_memory_usage.log &amp;}}</code></pre><p class="p">This is the expected result in the CalCM daemon log:</p>
<pre class="pre codeblock"><code>2019-01-02 09:45:48] NOTE: update_application (Wed Jan  2 09:45:48 2019),
 Notification Service v1.1_1.61.2.3
[2019-01-02 09:45:48] Notification action: exec /usr/bin/timeout 60s
 ssh ‑oStrictHostKeyChecking=no
 -oBatchMode=yes $hostname <var class="keyword varname italic">FullPath</var>/analyze_remote_memory_usage &gt;&gt;
<var class="keyword varname italic">FullPath</var>/analyze_remote_memory_usage.log &amp; 
[2019-01-02 09:45:48] Notification user(<span class="keyword ParameterName OptionalReplaceable">mylogin</span>), remote(<span class="keyword ParameterName OptionalReplaceable">remotehost</span>):
 Remote free memory &lt; 20 GB, Swap &gt; 10 GB,
 launching analyze_remote_memory_usage</code></pre><p class="p">Considerations when launching a custom script for this application
are as follows:</p>
<ul class="ul"><li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__ide8a630bb-54c2-4f99-afe6-78d150220c6a"><p class="p">The custom
script is launched inside the CalCM daemon cycle loop and can severely slow
down the CalCM cycle when swapping notification is raised on multiple
remote hosts at the same time, for example, and can even cause a
timeout.</p>
<p class="p">It is therefore strongly recommended to launch custom scripts
that are not long running by design. If the script needs to connect
by SSH protocol to a swapping host, for example, you should protect
against long executions by specifying the following:</p>
<pre class="pre codeblock"><code>{exec /usr/bin/timeout 60s ssh $hostname ... &amp;}</code></pre><p class="p">The ampersand (&amp;) background launch ensures that a slow execution
of the custom script does not slow down the CalCM daemon itself.</p>
<p class="p">The Linux timeout command ensures that background processes cannot
accumulate indefinitely on the CalCM host if they are unresponsive.</p>
</li>
<li class="li" id="id720d743c-7ba3-44d8-befe-aa2263917509__id915e53fa-4898-460e-a6e7-01c37c8db4cc"><p class="p">The custom
script can raise an alert to call for immediate action or be used
as a post‑run analysis tool to identify a specific process that
resulted in a degraded runtime of CalCM jobs using this remote host.</p>
</li>
</ul>
</div>
<div class="section Subsection" id="id720d743c-7ba3-44d8-befe-aa2263917509__id0bda401f-eba5-42a2-9b22-15983a885a89"><h2 class="title Subheading sectiontitle">Example
7</h2><p class="p">This is an example of the calcm_notification_app.tcl application
using tag syntax for grouping notifications. You can insert a specific
tag into the <span class="keyword ParameterName OptionalReplaceable">message</span> argument.
The tag syntax is “tag(<span class="keyword ParameterName OptionalReplaceable">tag_name</span>)”
with only one tag specification per filter. The <span class="keyword ParameterName OptionalReplaceable">tag_name</span> can
consist of only alphabetic characters (a-z, A-Z), numbers (0-9),
and the underscore (_). This syntax is supported in the evalAttr,
evalExpr, evalEvent, and evalFilter Tcl procedures. The example
is as follows:</p>
<pre class="pre codeblock"><code>JOBFILTERS = {evalAttr
 "long_ops,$jobID,$hdb" {$consecutive &gt;= $limit-1}
 {tag(long_ops): $JobID : The present operation is ongoing
 for 7 hours with under 10 cores.}} \ 
 {evalAttr "not_updated,$jobID" {$consecutive &gt;= $limit-1}{tag(update):
 The job has not responded for $limit update cycles.}}</code></pre></div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_CalcmTclApplicationReference_id59ca9376.html" title="This section provides reference information on the CalCM Tcl applications (default unless noted otherwise).">CalCM Tcl Application Reference</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_cm_user"
                DocTitle = "Calibre® Cluster Manager (CalCM) User’s Manual"
                PageTitle = "calcm_notification_app.tcl"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Command_CalcmNotificationAppTcl_id720d743c.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® Cluster Manager (CalCM) User’s Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>