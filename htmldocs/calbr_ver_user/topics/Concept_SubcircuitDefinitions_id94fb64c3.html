<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Subcircuit Definitions" />
<meta name="abstract" content="Subcircuits are written by the hierarchical SPICE netlister for hcells, regular LVS Box cells, and cells created by the hierarchical database constructor (ICV_* cells). If the tool is run with the ‑flatten option, then there is only one subcircuit." />
<meta name="description" content="Subcircuits are written by the hierarchical SPICE netlister for hcells, regular LVS Box cells, and cells created by the hierarchical database constructor (ICV_* cells). If the tool is run with the ‑flatten option, then there is only one subcircuit." />
<meta name="DC.subject" content="Element statements, .SUBCKT, Element statements, .MACRO, Subcircuit statements, SPICE, netlist, subcircuit statements, subcircuits" />
<meta name="keywords" content="Element statements, .SUBCKT, Element statements, .MACRO, Subcircuit statements, SPICE, netlist, subcircuit statements, subcircuits" />
<meta name="prodname" content="Calibre Verification User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-15" />
<meta name="Topline" content="Siemens EDA" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_ver_user" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="HighlightColor" content="mgc_yellow_129_50" />
<meta name="HighlightChanges" content="yes" />
<meta name="EclipsePluginName" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="21.2;show" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® Verification User’s Manual" />
<meta name="CSHelp" content="NO" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,product.version.v2021.2,product.id.P10089,product.id.P11800,product.id.P11801,product.id.P11802,product.id.P11426,product.id.P10099,product.id.P10084,product.id.P10090,product.id.P11493,product.id.P11427" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id94fb64c3-350d-4f96-9150-4f811c9fe151" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Subcircuit Definitions</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Subcircuit Definitions" />
<meta name="attributes" content="doc.type.documentation.user,product.version.v2021.2,product.id.P10089,product.id.P11800,product.id.P11801,product.id.P11802,product.id.P11426,product.id.P10099,product.id.P10084,product.id.P10090,product.id.P11493,product.id.P11427" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id94fb64c3-350d-4f96-9150-4f811c9fe151">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Subcircuit Definitions</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">Subcircuits
are written by the hierarchical SPICE netlister for hcells, regular
LVS Box cells, and cells created by the hierarchical database constructor (ICV_*
cells). If the tool is run with the ‑flatten option, then there
is only one subcircuit.</span>
</div>
<p class="p">If you specify a top-level subcircuit
name, then this subcircuit serves as the top-level network. The
pins of this subcircuit serve as design ports. If a top-level subcircuit name
is not specified, then the tool looks for any element statements
and subcircuit calls in the netlist that are not part of any subcircuit
definition. These statements then serve as the top-level network.</p>
<p class="p">Some special features:</p>
<ul class="ul"><li class="li" id="id94fb64c3-350d-4f96-9150-4f811c9fe151__id2ecb6f5e-6306-4527-a24b-000bcec950ff"><p class="p">Subcircuits that contain no devices are
treated as primitive components. This includes user-defined devices
and LVS Box cells.</p>
</li>
<li class="li" id="id94fb64c3-350d-4f96-9150-4f811c9fe151__id671298b2-569e-4a69-bbae-f8ef447028d8"><p class="p">Parameters are passed between levels
of hierarchy. Primitive subcircuits can have arbitrary parameters.</p>
</li>
</ul>
<div class="section Subsections" id="id94fb64c3-350d-4f96-9150-4f811c9fe151__id6c685703-6857-4dc9-a796-3bacd46894b2"><div class="section Subsection" id="id94fb64c3-350d-4f96-9150-4f811c9fe151__id668d4398-5d02-4bdc-819a-95b38ce8644a"><h2 class="title Subheading sectiontitle">.SUBCKT, .SUBCIRCUIT,
.SUB, or .MACRO</h2><p class="p">The following strings define a subcircuit.</p>
<pre class="pre codeblock"><code><span class="ph CodeHighlight orange">.SUBCKT subname</span> &lt; n1 n2 … &lt; / m1 m2 … &gt; &gt; &lt; parnam = pval &gt; …</code></pre><pre class="pre codeblock"><code><span class="ph CodeHighlight orange">.SUBCIRCUIT subname</span> &lt; n1 n2 … &lt; / m1 m2 … &gt; &gt; &lt; parnam = pval &gt; …</code></pre><pre class="pre codeblock"><code><span class="ph CodeHighlight orange">.SUB subname</span> &lt; n1 n2 … &lt; / m1 m2 … &gt; &gt; &lt; parnam = pval &gt; …</code></pre><pre class="pre codeblock"><code><span class="ph CodeHighlight orange">.MACRO subname</span> &lt; n1 n2 … &lt; / m1 m2 … &gt; &gt; &lt; parnam = pval &gt; …</code></pre><p class="p">Here is an example:</p>
<pre class="pre codeblock leveled"><code>.SUBCKT res2 in1 in2 res=5 pp="abc" 
R1 in1 3 res aaa=pp 
R2 3 in2 res aaa=pp 
.ENDS res2 </code></pre><p class="p">All subcircuit definitions must terminate with
a .ENDS or .EOM statement.</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="id94fb64c3-350d-4f96-9150-4f811c9fe151__iddd1a9f75-6530-4769-b666-feb6efded7b4" class="table" frame="border" border="1" rules="cols"><caption><span class="tablecap"><span class="table--title-label">Table 1. </span>SUBCKT Statements </span></caption><colgroup><col style="width:1.402in" /><col style="width:5.098in" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d81381e241"><p class="p">Argument</p>
<p class="p">Name</p>
</th>
<th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d81381e250"><p class="p">Description</p>
</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d81381e241 "><p class="p">subname</p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d81381e250 "><p class="p">Subcircuit name. String
of any number of allowed characters.</p>
</td>
</tr>
<tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d81381e241 "><p class="p">n1 n2 …</p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d81381e250 "><p class="p">Node names for external
reference. Strings of any number of allowed characters. Any element
nodes appearing in the subcircuit but not included in this list
or in a .GLOBAL or *.GLOBAL statement are strictly local. At least
one of these parameters must appear in a called subcircuit.</p>
</td>
</tr>
<tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d81381e241 "><p class="p">/ m1 m2 …</p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d81381e250 "><p class="p">Optional additional node
names for external reference. The / characters in the node name
list are treated as white space, unless you specified the <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Spice Slash Is Space', 'svrf_ur'); return false;">LVS Spice Slash Is Space</a> NO specification statement in your rule file.</p>
</td>
</tr>
<tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d81381e241 "><p class="p">parnam = pval</p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d81381e250 "><p class="p">Optional parameter name
set to a numeric or string value for use only in the subcircuit.
The value applies to this subcircuit and to any subcircuits called
by this subcircuit. It is overridden by an assignment in the subcircuit
call, or by a value set in a .PARAM statement. The parnam must begin
with a letter followed by any number of allowed characters. See “<a class="xref fm:HeadingAndPage" href="Concept_StringParameters_id2488fbea.html#id2488fbea-7d94-4335-8ae0-1171efe7a60d__Concept_StringParameters_id2488fbea.xml#id2488fbea-7d94-4335-8ae0-1171efe7a60d" title="The Calibre SPICE parser supports character-string parameters in addition to standard SPICE numerical parameters.">String Parameters</a>” for complete details on string
parameters.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p">The statements following the subcircuit statement
(and preceding the .ENDS or .EOM statement) define the subcircuit.
Subcircuit definitions may contain subcircuit calls. Subcircuit definitions
may contain other (nested) subcircuit definitions.</p>
<p class="p">When resolving node names inside subcircuit
definitions, <a class="xref fm:HeadingOnly" href="Command_Global_id93123761.html#id93123761-7aee-4f17-a679-4c1a219fe49f__Command_Global_id93123761.xml#id93123761-7aee-4f17-a679-4c1a219fe49f" title="Specifies nodes shared globally by all subcircuits. The form *.GLOBAL is coded as a comment and is equivalent to .GLOBAL.">.GLOBAL</a> nodes
normally have precedence over subcircuit pins with the same name.
To indicate the opposite, specify <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Spice Prefer Pins', 'svrf_ur'); return false;">LVS Spice Prefer Pins</a> YES in the rule file. </p>
<p class="p"><a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Spice Option', 'svrf_ur'); return false;">LVS Spice Option</a> allows you to control the SPICE parser reporting of subcircuit
calls with floating pins, subcircuits sharing the same name but
with differing numbers of pins, and the modification of duplicate
subcircuit names.</p>
<p class="p">When the top-level network is enclosed in a
subcircuit definition, hierarchical applications use the external
node names of the top-level subcircuit as design ports.</p>
</div>
<div class="section Subsection" id="id94fb64c3-350d-4f96-9150-4f811c9fe151__id8774b54f-10d2-48bf-a9ea-32d29385232f"><h2 class="title Subheading sectiontitle">Primitive
Subcircuits</h2><p class="p">A
subcircuit that does not contain any element statements, subcircuit calls,
*.CONNECT statements, *.J statements, *. SEEDPROM statements, and
any subcircuit that appears in an LVS Box rule file statement, is
considered a primitive component.</p>
<p class="p">Here is an example:</p>
<pre class="pre codeblock leveled"><code>.SUBCKT primitive a b c par1=5U par2=10U 
.ENDS primitive </code></pre><p class="p">Here is the general form:</p>
<p class="p BlockIndent">LVS component type: subcircuit_name</p>
<p class="p BlockIndent">LVS component subtype: as specified
in a subcircuit call or none.</p>
<p class="p BlockIndent">LVS pin names: any allowed name</p>
<p class="p">User-defined devices (ones that do not conform to built-in criteria)
appear as primitive subcircuits. These include transistors having
more than four pins, capacitors and resistors having more than three
pins, and so forth.</p>
<p class="p">All primitive subcircuits own a special property
called M, which is available for tracing. The Trace Property name
is M. The value is always 1. This property is not available for
tracing in non-primitive subcircuits. </p>
</div>
<div class="section Subsection" id="id94fb64c3-350d-4f96-9150-4f811c9fe151__id0f72995d-1883-40bb-a8a9-ba9daae3bebe"><h2 class="title Subheading sectiontitle">Nested
Subcircuits</h2><p class="p">Subcircuit definitions may be nested. Nested
subcircuit definitions have local scope. In other words, an embedded
subcircuit is visible only from its immediate parent in the nesting hierarchy
and from other subcircuits nested under the parent. It is not visible
from above or below the parent in the nesting hierarchy. </p>
<p class="p">For example, the following design has two capacitors
(from local bbb definition #1) and 4 resistors (from local bbb definition
#2). </p>
<pre class="pre codeblock leveled"><code>.subckt aaa d e f     $$ Beginning of subcircuit aaa. 
$ 
.subckt bbb a b c     $$ Local definition of bbb #1; 
c1 a b                $$   scope is aaa. 
c2 b c 
.ends bbb 
$ 
x1 d e f bbb          $$ Call to bbb #1. 
.ends aaa             $$ End of subcircuit aaa. 
.subckt ccc d e f     $$ Beginning of subcircuit ccc. 
$ 
.subckt bbb a b c     $$ Local definition of bbb #2; 
r1 a b                $$   scope is ccc. 
r2 b c 
.ends bbb 
$ 
.subckt ddd a b c 
x1 a b c bbb          $$ Call to bbb #2. 
.ends ddd 
$ 
x1 d e f bbb          $$ Call to bbb #2. 
x2 1 2 3 ddd 
.ends ccc             $$ End of subcircuit ccc. 

.subckt top 
x1 g h l aaa 
x2 i j k ccc 
.ends </code></pre></div>
<div class="section Subsection" id="id94fb64c3-350d-4f96-9150-4f811c9fe151__idfc947001-30b5-48f6-b401-dc0ab8f7b00c"><h2 class="title Subheading sectiontitle">Duplicate
Pins</h2><p class="p">The SPICE parser allows duplicate pin names
in subcircuit definitions but issues warnings about them. Only the
first pin in each group of duplicate pin names actually connects to
elements within the subcircuit; other pins in the group are unused.
For example:</p>
<pre class="pre codeblock leveled"><code>.SUBCKT  cell1 a a 
C1 a b 100 
.ENDS 

.SUBCKT cell2 
X1 1 2 cell1 
.ENDS </code></pre><p class="p">In the subcircuit call X1, node 1 connects
to C1 in cell1 through pin a of cell1. Node 2 does not connect to
any devices in cell1. A warning is issued about duplicate definition
of pin a in cell1.</p>
</div>
<div class="section Subsection" id="id94fb64c3-350d-4f96-9150-4f811c9fe151__idb8efcb22-3aa9-4b01-9045-19a267cd201b"><h2 class="title Subheading sectiontitle">Duplicate .SUBCKT Definitions</h2><p class="p">The SPICE parser classifies subcircuits
by subcircuit name and number of pins. Subcircuit definitions with
the same name but different number of pins are allowed and are not
considered duplicate. </p>
<p class="p">You can tell the SPICE parser to report warnings
for duplicate subcircuit definitions with different pin counts by
specifying <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Spice Option', 'svrf_ur'); return false;">LVS Spice Option S</a> in the rule file. </p>
<p class="p">Subcircuit definitions with the same name and
the same number of pins are considered duplicate. When duplicate
subcircuit definitions are present in a netlist, one of those definitions is
used and all others are discarded with warnings. You should not
rely on any specific subcircuit definition (first, last, or other)
to be chosen. Duplicate subcircuit definitions are reported as warnings,
as follows:</p>
<pre class="pre codeblock leveled"><code>Warning: Duplicate subckt definition "&lt;cell&gt;" at line &lt;N&gt; in file "&lt;pathname&gt;" previously defined at line &lt;n&gt; in file "&lt;pathname&gt;"</code></pre><p class="p">The SPICE parser ceases these warnings after
256 duplicates have been found.</p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_ElementStatements_idf08b9c7c.html" title="SPICE uses element statements to represent circuit components. Most of these components are primitive devices. A subcircuit definition frequently specifies a more complex structure.">Element Statements</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_ver_user"
                DocTitle = "Calibre® Verification User’s Manual"
                PageTitle = "Subcircuit Definitions"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_SubcircuitDefinitions_id94fb64c3.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® Verification User’s Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>