<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Hcells and Circuit Comparison" />
<meta name="abstract" content="Hcells are compared as hierarchical entities. For each pair of hcells, the layout cell is compared to the paired source cell. All other cells are expanded in the circuit comparison stage down to the next level of hcells (or down to primitive devices when there are no lower-level hcells)." />
<meta name="description" content="Hcells are compared as hierarchical entities. For each pair of hcells, the layout cell is compared to the paired source cell. All other cells are expanded in the circuit comparison stage down to the next level of hcells (or down to primitive devices when there are no lower-level hcells)." />
<meta name="prodname" content="Calibre Verification User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-15" />
<meta name="Topline" content="Siemens EDA" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_ver_user" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="HighlightColor" content="mgc_yellow_129_50" />
<meta name="HighlightChanges" content="yes" />
<meta name="EclipsePluginName" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="21.2;show" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® Verification User’s Manual" />
<meta name="CSHelp" content="NO" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,product.version.v2021.2,product.id.P10089,product.id.P11800,product.id.P11801,product.id.P11802,product.id.P11426,product.id.P10099,product.id.P10084,product.id.P10090,product.id.P11493,product.id.P11427" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id1a9d220b-15eb-4fd7-9259-761562bccac5" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Hcells and Circuit Comparison</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Hcells and Circuit Comparison" />
<meta name="attributes" content="doc.type.documentation.user,product.version.v2021.2,product.id.P10089,product.id.P11800,product.id.P11801,product.id.P11802,product.id.P11426,product.id.P10099,product.id.P10084,product.id.P10090,product.id.P11493,product.id.P11427" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id1a9d220b-15eb-4fd7-9259-761562bccac5">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Hcells and Circuit Comparison</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">Hcells are
compared as hierarchical entities. For each pair of hcells, the
layout cell is compared to the paired source cell. All other cells
are expanded in the circuit comparison stage down to the next level
of hcells (or down to primitive devices when there are no lower-level
hcells). </span>
</div>
<p class="p">When no hcells
are present, circuit comparison operates at primitive device level
(flat). </p>
<p class="p">The top level cells (<a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'Layout Primary', 'svrf_ur'); return false;">Layout Primary</a> and <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'Source Primary', 'svrf_ur'); return false;">Source Primary</a>)
always correspond and do not need to appear in the cell correspondence
file. By default, primitive devices correspond by component type,
as in flat LVS. In primitive devices with non-built-in types, you
can override the automatic correspondence by including the device
names in the hcell list. The hcell list then exclusively determines
their correspondence. Warnings are issued for cell names that do
not exist in the input data. </p>
<p class="p">The -automatch option causes
cells that correspond by name in layout and source to serve as hcells.
If using -automatch, you should ensure that subcircuits in the source
serve the same function as cells in the layout with the same names.
In most cases, a well-chosen hcell list delivers better performance
than -automatch.</p>
<div class="section Subsections"><div class="section Subsection" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__id41ff87dc-97c6-40b2-8cf6-f832b4bbc8eb"><h2 class="title Subheading sectiontitle">Indications of a Non-Optimal
Hcell List in LVS Comparison</h2><p class="p">Certain indications are given in the run transcript
and the LVS Report if the hcell list is not optimal.</p>
<p class="p">These are indicators that an hcell list is too small:</p>
<ul class="ul"><li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__id73ec7001-759a-41c5-a8c0-db5dee3e8d16"><p class="p">The overall
memory consumption (LVHEAP) during LVS comparison is unusually high.</p>
</li>
<li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__idc9203c75-e001-462e-97fc-f72c17031044"><p class="p">The INITIAL
NUMBERS OF OBJECTS section of the LVS Report shows large numbers
(1E5 or more) of primitive devices.</p>
</li>
</ul>
<p class="p">Other indicators of a problematic hcell list:</p>
<ul class="ul"><li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__id23027d79-c97b-4fe8-8589-952e595e92c1"><p class="p">For certain
hcells, if there are more instances of a component in the layout
or source at a lower level of the hierarchy, but the reverse is
true farther up in the hierarchy, then the hcell pair should probably
be removed from the list.</p>
</li>
<li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__ide3ad0f39-b7a7-4765-bd16-014f6e1a29f4"><p class="p">There are many
discrepancies related to pin swapping for a given hcell.</p>
<p class="p">If either of these latter situations occurs, try specifying <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Exclude Hcell', 'svrf_ur'); return false;">LVS Exclude Hcell</a> for
the affected hcells and see if that resolves the issue.</p>
</li>
<li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__id06333d8e-3253-45f5-a463-0bd384a1ca29"><p class="p">Hcell instances may be expanded
by the circuit comparison algorithm if it determines that expansion
is necessary in order to match the layout and source hierarchies.
This is indicated in the transcript by “EXPANDING unbalanced cells”
entries. For more information refer to <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Expand Unbalanced Cells', 'svrf_ur'); return false;">LVS Expand Unbalanced Cells</a>.</p>
</li>
</ul>
<p class="p">When cells contain large numbers of flattened
instances, memory allocations that occur during the stages “FLATTENING
non-corresponding cells” and “EXPANDING unbalanced cells” are reported
in the run transcript. Performance may be improved by identifying
hcells with very large instance counts and finding contained cells
that may function as additional hcells. Specifying contained cells
identified in this way as hcells helps reduce overall per-cell contained
instance counts and can result in improved performance.</p>
<p class="p">To facilitate this identification, the additional
transcript memory information includes the following:</p>
<ul class="ul"><li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__idef8bc1ed-f130-46d0-95cb-938652164cfb"><p class="p">Layout or source design.</p>
</li>
<li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__id4a49f485-7cc9-4728-911e-8c1382b9a936"><p class="p">Cell name.</p>
</li>
<li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__id2076c016-34fc-494c-b354-824756b44ba2"><p class="p">Instance count.</p>
</li>
<li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__idd0227fe1-7c21-4ec9-8d40-d7d5dea90938"><p class="p">Memory in use (LVHEAP and MALLOC).</p>
</li>
<li class="li" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__idd708f946-a21c-46aa-9af3-fe9660a82fc9"><p class="p">Elapsed time.</p>
</li>
</ul>
<p class="p">Example output:</p>
<pre class="pre codeblock"><code>Resolving DEEP SHORTS ...
DEEP SHORTS resolved.  CPU TIME = 2  REAL TIME = 2  LVHEAP = 1692/1737/1737
MALLOC = 1794/1794/1794  ELAPSED TIME = 32

<span class="ph CodeHighlight Bold">EXPANDING unbalanced cells</span> ...

<span class="ph CodeHighlight Bold">Source</span> cell <span class="ph CodeHighlight Bold">Z1374F</span> now contains <span class="ph CodeHighlight Bold">1000071</span> flattened instances.  
<span class="ph CodeHighlight Bold">LVHEAP</span> = 1880/1882/1882  <span class="ph CodeHighlight Bold">MALLOC</span> = 1932/1932/1932  <span class="ph CodeHighlight Bold">ELAPSED TIME</span> = 32

<span class="ph CodeHighlight Bold">Layout</span> cell <span class="ph CodeHighlight Bold">Z1374G</span> now contains 1000036 flattened instances.  LVHEAP = 
2345/2345/2345  MALLOC = 2486/2486/2486  ELAPSED TIME = 34

   <span class="ph CodeHighlight Bold">EXPANDING unbalanced cells</span> in <span class="ph CodeHighlight Bold">LAYOUT</span> cell <span class="ph CodeHighlight Bold">Z1374G</span>, <span class="ph CodeHighlight Bold">SOURCE</span> cell <span class="ph CodeHighlight Bold">Z1374F</span>
      C1802 in Z1374F ( 28 instances, SOURCE )</code></pre><p class="p">For the preceding report, the cells Z1374G and
Z1374F are candidates to search for corresponding child cells to
be declared as hcells. </p>
</div>
<div class="section Subsection" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__id7c5587d5-0d8b-4de8-843c-825ac169eed6"><h2 class="title Subheading sectiontitle">Seed
Promotion and Hcells</h2><p class="p">In certain cases, device seed promotion can
occur in the circuit extraction module when devices cannot be completely
formed at the level of the seed shape. The device seed can be promoted
up the hierarchy and the device is recognized at a higher level.
This is indicated by a *.SEEDPROM statement in the extracted SPICE
netlist for the subcircuit that had the device seed promoted out
of it. </p>
<p class="p">This topic is discussed from the layout perspective
under “<a class="xref fm:HeadingAndPage" href="Concept_HierarchicalDeviceRecognition_id93e24e07.html#id93e24e07-cdf6-4bda-8c5e-025db549df13__ideee9fcb5-4545-400e-971e-de3c54eaf526">Seed Promotion</a>”. Here is an example:</p>
<div class="fig fignone ExampleTitle" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__idef69f12b-ff6b-416e-afe3-916e9cb432c0"><span class="figcap"><span class="fig--title-label">Example 1. </span>Seed
Promotion</span><pre class="pre codeblock leveled"><code>.SUBCKT cell_1 1 2 4 
** N=4 EP=3 IP=0 FDC=1 
*.SEEDPROM 
M0 4 1 2 2 n L=5e-08 W=1.25e-07 $X=1025 $Y=850 $D=0 
.ENDS 

.SUBCKT cell_2 
... 
X4 IN1 GND Y cell_1 $T=-875 -650 0 0 $X=25 $Y=0 
X5 IN1 GND Y cell_1 $T=-450 -650 0 0 $X=450 $Y=0 
.ENDS </code></pre></div>
<p class="p">If seed promotion occurs out of a cell, and
that hcell is preserved as an hcell during the comparison phase
(including the use of -automatch), it is maintained as an hcell
by default during hierarchical comparison even though devices have
been promoted from it up the hierarchy. This could result in circuit
comparison discrepancies where devices are present in differing
subcircuits in the layout versus the source.</p>
<p class="p">The <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Push Devices', 'svrf_ur'); return false;">LVS Push Devices</a> YES specification statement (which is the default)
allows for LVS to recover from seed promotion in many cases, and
is the default behavior. However, it cannot guarantee recovery from
seed promotion in all cases.</p>
<p class="p">In certain cases, it may be advantageous to
expand hcells during the comparison phase, where those hcells have
experienced seed promotion out of them. This could mitigate discrepancies during
the comparison phase. For information on expanding seed promotion
cells, see <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Expand Seed Promotions', 'svrf_ur'); return false;">LVS Expand Seed Promotions</a>. Another alternative is to cause the affected
hcells not to be used as hcells. The <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Exclude Hcell', 'svrf_ur'); return false;">LVS Exclude Hcell</a> statement can be used in this case. </p>
<p class="p">Layer derivation based layer
promotion can cause devices to form higher up in the hierarchy without
the usual seed promotion indicators. To mitigate the effects of
promotion, it is best to use layer operations that tend to preserve
hierarchy when deriving device seed shapes. See “<a class="xref" href="Concept_HierarchyPreservationByLayerOperations_id22ddcca6.html#id22ddcca6-8338-4286-b14b-5e2108f57db4__id9a2be1af-eecb-476d-915a-996d2f825fcd">Table 1</a>” for information about layer
operation effects upon hierarchy.</p>
<p class="p"><a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Use Careful AND', 'svrf_ur'); return false;">LVS Use Careful AND</a> YES,
or the AND operation LVSCAREFUL keyword, can be useful when the
AND operation is responsible for device layer shapes being promoted.
This promotion occurs before device recognition, so it may not lead
to seed promotion such as when *.SEEDPROM appears in the extracted
netlist. </p>
<p class="p">If you are extracting MOS device properties
such as AS, AD, PS, and PD for parasitic extraction flows, use of
the <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Push Devices', 'svrf_ur'); return false;">LVS Push Devices</a> SEPARATE PROPERTIES statement is recommended. See
the <cite class="cite">SVRF Manual</cite> for details.</p>
</div>
<div class="section Subsection" id="id1a9d220b-15eb-4fd7-9259-761562bccac5__ida3d4d996-6454-4122-95bd-25d2b46bcd79"><h2 class="title Subheading sectiontitle">Connectivity
Dependent Transformation</h2><p class="p">Two or more nets shorted together at a higher
level of hierarchy in corresponding hcells are recognized as one
net if they are shorted together in all instances of the cell. However,
they are treated separately if the nets are shorted together in
some, but not all, instances of the cell. This can affect LVS transformation
operations that occur during comparison such as unused device filtering.</p>
<p class="p">The <a class="xref Link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'LVS Expand Ambiguously High Shorted Hcells', 'svrf_ur'); return false;">LVS Expand Ambiguously High Shorted Hcells</a> statement controls automatic expansion of hcells
with high-shorted pins that are matched in a many-to-one configuration,
and that cause false LVS comparison discrepancies.</p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_Hcells_id3166033d.html" title="The term hcell stands for hierarchically corresponding cell. Hcells are cells that exist in both the layout and source designs and that (presumably) perform the same function. Calibre cannot determine if cells are identical in function because mask layout formats or SPICE netlists do not contain such information. Also, simply because two cells may have the same name is not necessarily a guarantee they have the same topology or device properties. So the user must specify cell correspondence in hierarchical LVS flows.">Hcells</a></div>
</div>

<div class="linklist linklist relinfo"><strong>Related Topics</strong><br />

<div><a class="link" href="../topics/Concept_HcellsAndCircuitExtraction_id74d19042.html" title="Hierarchical circuit extraction (as with the -spice option) does not require an hcell list. Extraction is performed hierarchically, based on the original database hierarchy. Some cells may be expanded or flattened based upon internal heuristics that determine when it is more efficient to do so.">Hcells and Circuit Extraction</a></div></div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_ver_user"
                DocTitle = "Calibre® Verification User’s Manual"
                PageTitle = "Hcells and Circuit Comparison"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_HcellsCircuitComparison_id1a9d220b.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® Verification User’s Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>