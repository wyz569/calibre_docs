<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="TaskTopic" />
<meta name="DC.Title" content="Resizing Polygons by a Percentage of the Area" />
<meta name="abstract" content="You can use eqDRC and the DFM Size operation to resize polygons by a percentage of their area." />
<meta name="description" content="You can use eqDRC and the DFM Size operation to resize polygons by a percentage of their area." />
<meta name="prodname" content="Calibre Solutions for Physical Verification" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-13" />
<meta name="Topline" content="Siemens EDA" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="21.2;show" />
<meta name="HighlightChanges" content="Yes" />
<meta name="HighlightColor" content="mgc_light_blue" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_solns_pv_user" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="March 16, 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® Solutions for Physical Verification" />
<meta name="CSHelp" content="NO" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,product.version.v2021.2,product.id.P10089,product.id.P11800,product.id.P11802,product.id.P11801,product.id.P11426,product.id.P10099,product.id.P10096,product.id.P11493,product.id.P11347,product.id.P11713,product.id.P10294" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id634e3d43-e3d9-4989-b8d2-97eb82395c7e" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Resizing Polygons by a Percentage of the Area</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Resizing Polygons by a Percentage of the Area" />
<meta name="attributes" content="doc.type.documentation.user,product.version.v2021.2,product.id.P10089,product.id.P11800,product.id.P11802,product.id.P11801,product.id.P11426,product.id.P10099,product.id.P10096,product.id.P11493,product.id.P11347,product.id.P11713,product.id.P10294" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id634e3d43-e3d9-4989-b8d2-97eb82395c7e">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Resizing Polygons by a Percentage of the Area</h1>
<div class="body taskbody TaskBody"><div class="abstract TaskAbstract"><p class="shortdesc">You can
use eqDRC and the DFM Size operation to resize polygons by a percentage
of their area. </p>
<p class="p">The DFM Size operation oversizes or undersizes
polygons by an amount that can be specified as a DFM property for
each polygon. This procedure assumes undersizing. For a rectangular polygon
with width W and length L, the shrink value must satisfy this equation:</p>
<p class="p BlockIndent">(L - <span class="keyword ParameterName OptionalReplaceable">shrink_val</span>)(W
- <span class="keyword ParameterName OptionalReplaceable">shrink_val</span>)
= target_area</p>
<p class="p">This equation can be solved using the quadratic
formula to find the <span class="keyword ParameterName OptionalReplaceable">shrink_val</span> for
each polygon. The preceding equation assumes a rectangular polygon,
but the equation can be generalized for use with any Manhattan polygon
by using an effective width and length; see “<a class="xref fm:HeadingAndPage" href="TaskTop_FindingPathLengthConnectedToGateEffectiveLengthMethod_ida90b7256.html#ida90b7256-d095-4abc-ab22-cea927121392__TaskTop_FindingPathLengthConnectedToGateEffectiveLengthMethod_ida90b7256.xml#ida90b7256-d095-4abc-ab22-cea927121392" title="This check measures the path lengths of nets connected to MOS gates on the first two layers of metal interconnect. An effective length of each polygon in the path is estimated using an equation.">Finding the Length of a Net Path Connected to Gate: Effective Length Method</a>”.</p>
<p class="p">The solution creates several functions with DFM
Function: functions to find the effective width and length of a
polygon and to solve the preceding equation for <span class="keyword ParameterName OptionalReplaceable">shrink_val</span>.
The resizing value is attached to each polygon as a DFM property.
The polygons are then resized with DFM Size. </p>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">The resizing method works
best for rectangular polygons or polygons with a somewhat uniform width.
It should only be used for Manhattan polygons. </p>
</div>
<p class="p"> </p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="id0d733561-a6ac-4298-992b-5e5393b3f731" class="table" frame="hsides" border="1" rules="cols"><colgroup><col style="width:0.987in" /><col style="width:5.513in" /></colgroup><tbody class="tbody"><tr class="row"><td class="entry row-nocellborder default-entry" style="vertical-align:top;"><p class="p">    <span class="ph FontProperty HeadingLabel">Try It!</span> </p>
<img class="image fmdpi:96" src="../graphics/try_it_note_small.png" /></td>
<td class="entry row-nocellborder default-entry" style="vertical-align:top;"><p class="p"><span class="ph FontProperty HeadingLabel">Calibre Advanced DRC (eqDRC) Tutorial and Example Kit</span></p>
<p class="p">Go to <a class="xref" href="http://supportnet.mentor.com/infohub.cfm?infohub=ver_ih&amp;link=cal_ekit_IC" target="_blank">this page</a> on Support Center
to download the complete eKit.</p>
<p class="p">This example is in the miscellaneous_checks/size_by_percent
example directory.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tasklabel"><h2 class="sectiontitle tasklabel">Procedure</h2></div><ol class="ol steps"><li class="li step stepexpand" id="id634e3d43-e3d9-4989-b8d2-97eb82395c7e__id5a26505d-f7c4-4dab-94a0-d2bab6f70cf8"><span class="ph cmd">Use DFM Function to write functions that return
the effective width and length of a polygon. </span><div class="itemgroup info StepInfo"><pre class="pre codeblock not-leveled"><code>// Find the effective length of a polygon
DFM FUNCTION [ L_EFF( LAYER L ) 
               (PERIM(L)+SQRT(FMAX(PERIM(L)*PERIM(L)-16*AREA(L),0)))/4 
             ]
// Find the effective width of a polygon
DFM FUNCTION [ W_EFF( LAYER L ) 
               (PERIM(L)-SQRT(FMAX(PERIM(L)*PERIM(L)-16*AREA(L),0)))/4 
             ]</code></pre></div></li>
<li class="li step stepexpand" id="id634e3d43-e3d9-4989-b8d2-97eb82395c7e__id2b6e7278-c010-457d-98fc-b2dbae4ac110"><span class="ph cmd">Use DFM Function to write a function that solves
the quadratic equation for <span class="keyword ParameterName OptionalReplaceable">shrink_val</span>. The
function is implemented with a Tcl procedure. The input arguments
are the polygon effective width, effective length, and the target
area. </span><div class="itemgroup info StepInfo"><pre class="pre codeblock"><code>// Solve this equation for shrink_val, using quadratic formula  
// (L - shrink_val)(W - shrink_val) = TA
DFM FUNCTION [ QUAD_ROOT( NUMBER W, NUMBER L, NUMBER TA )
               TVF_NUM_FUN( find_root, func_lib ) ]</code></pre><pre class="pre codeblock"><code>TVF FUNCTION func_lib [/* 
    
    proc find_root { W L TA } { 
      set a [$TA] ; # target area 
      set l [$L]  ; # length 
      set w [$W]  ; # width 
 
      set b [expr -($l + $w)]; #  b in the quadratic formula 
      # Discriminant of quadratic formula:
      set discr [expr sqrt(${b}*$b - 4*($l*$w - $a))] 
      set root1 [expr (-$b - $discr)/2]
      # We want the solution that is less than the width
      if {($root1 &lt; $w) &amp;&amp; ($root1 &gt; 0)} {
           return $root1
      }
      set root2 [expr (-$b + $discr)/2]
      if {($root2 &lt; $w) &amp;&amp; ($root2 &gt; 0)} {
       return $root2
      }
      puts "---NOTE: QUAD_ROOT returned 0."
      return 0
    }
  */]</code></pre></div></li>
<li class="li step stepexpand" id="id634e3d43-e3d9-4989-b8d2-97eb82395c7e__id4bc5d91b-bc7f-4a6d-a515-b442d2e2ad5d"><span class="ph cmd">Use DFM
Property to find the resizing value <span class="keyword ParameterName OptionalReplaceable">size_val</span> for
each polygon on layer L0 and attach it to each polygon as a DFM
property. The <span class="keyword ParameterName OptionalReplaceable">size_val</span> is
half of <span class="keyword ParameterName OptionalReplaceable">shrink_val</span>. </span><div class="itemgroup info StepInfo"><pre class="pre codeblock leveled"><code>LAYER L0 0

// Call QUAD_ROOT function to solve for shrink_val.
// DFM SIZE needs one-half of shrink_val.
VARIABLE scale 0.3  // scale factor should be less than one.
L0_prop  = DFM PROPERTY L0
              [weff = W_EFF(L0)]  // effective width
              [leff = L_EFF(L0)]  // effective length
              [target_area = scale*area(L0)]
              [size_val = (-0.5)*QUAD_ROOT(PROPERTY_REF(weff), 
                                       PROPERTY_REF(leff), 
                                       PROPERTY_REF(target_area))]</code></pre></div></li>
<li class="li step stepexpand" id="id634e3d43-e3d9-4989-b8d2-97eb82395c7e__idafa87d18-53a3-40c2-b93c-15f6aaced439"><span class="ph cmd">Resize
the polygons with DFM Size and output the layer to the standard
DRC results database. </span><div class="itemgroup info StepInfo"><pre class="pre codeblock leveled"><code>sized_L0 = DFM SIZE L0_prop BY "size_val" 
sized_L0 { COPY sized_L0 }</code></pre></div></li>
<li class="li step stepexpand" id="id634e3d43-e3d9-4989-b8d2-97eb82395c7e__id94fbd6ee-1905-49f7-8a51-11ace9aaf18e"><span class="ph cmd">Write a check to examine the results. Compare
the actual area to the target area and check that the original and
final edge counts are the same. </span><div class="itemgroup info StepInfo"><p class="p">Edge counts are compared
because it is possible for an edge to be removed if two times the <span class="keyword ParameterName OptionalReplaceable">size_val</span> is
greater than or equal to the smallest edge length of the polygon;
see the results section for an example.</p>
<pre class="pre codeblock not-leveled"><code>  // Error if percent difference between actual and expected area 
  //   is greater than pct_err_max.
  // Error if original and resized shape do not have same edge count.
  // Return original shape for error conditions.
  // Note: measurement functions on size_L0 layer sum over secondary 
  //   layer shapes, but there is only one shape in each cluster. 
  VARIABLE pct_err_max 10 
  bad_resize = DFM PROPERTY L0_prop sized_L0 OVERLAP 
                 [ pct_error = 100*ABS(AREA(sized_L0) - 
                                   PROPERTY(L0_prop, target_area))
                                  /PROPERTY(L0_prop, target_area)] 
                 [ edge_diff = COUNT(L0_prop:EDGE) - 
                                  COUNT(sized_L0:EDGE) ] 
                 [ - = ( (PROPERTY_REF(edge_diff) != 0) || 
                          (PROPERTY_REF(pct_error) &gt; pct_err_max) )
                          ? 1 : 0 ] == 1 </code></pre></div></li>
<li class="li step stepexpand" id="id634e3d43-e3d9-4989-b8d2-97eb82395c7e__id8dbd9ae4-0e79-42e9-8602-fdfa0afebb22"><span class="ph cmd">Output
the results to a DFM RDB:</span><div class="itemgroup info StepInfo"><pre class="pre codeblock leveled"><code>// Set default options for DFM RDB operations
DFM DEFAULTS RDB CELL SPACE ALL CELLS CHECKNAME "%_l_"
// Output the results
size_by_check {
    DFM RDB bad_resize eqdrc.rdb 
        COMMENT "Original shapes where resized shape has different "
        COMMENT "number of edges, or difference between target and "
        COMMENT "actual new size is greater than ^pct_err_max %"
//for debug
DFM RDB L0_prop eqdrc.rdb     
}</code></pre></div></li>
</ol>
<div class="section result"><div class="tasklabel"><h2 class="sectiontitle tasklabel">Results</h2></div><p class="p">The following figure shows results for several
polygons. The values of size_val and pct_error are shown for several
of the polygons. </p>
<div class="fig fignone" id="id634e3d43-e3d9-4989-b8d2-97eb82395c7e__ida8161721-f3f1-4b84-bf22-11aee403f73a"><br /><div class="imagecenter"><img class="image imagecenter fmdpi:96" src="../graphics/adv_drc/adv_drc_size_by_percent.png" /></div><br /></div>
<p class="p">For the upper right polygon, twice the <span class="keyword ParameterName OptionalReplaceable">size_val</span> is
greater than the minimum edge length of 0.1, so that edge is removed
during resizing. The bad_resize check outputs this shape as an error because
the original and resized edge counts are not the same. The percentage
error between the final and target area is less than 2% for all
of the other polygons. </p>
<p class="p">Depending on your application, you can add special
error handling to the L0_prop derivation or QUAD_ROOT function to
catch cases where twice the <span class="keyword ParameterName OptionalReplaceable">size_val</span> is
greater than or equal to the minimum edge length.</p>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_MiscellaneousAdvancedDRCChecks_idcdaa1058.html" title="This section includes miscellaneous advanced DRC checks.">Miscellaneous Advanced DRC Checks</a></div>
</div>

<div class="linklist linklist relinfo"><strong>Related Topics</strong><br />

<div><a class="link" href="../../calbr_ver_user/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'Introduction to DFM Property', 'calbr_ver_user'); return false;">Introduction to DFM Property [Calibre Verification User's Manual]</a></div>
<div><a class="link" href="../../calbr_ver_user/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'Introduction to DFM RDB', 'calbr_ver_user'); return false;">Introduction to DFM RDB [Calibre Verification User's Manual]</a></div>
<div><a class="link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'Measurement Functions', 'svrf_ur'); return false;">Measurement Functions [Standard Verification Rule Format (SVRF) Manual]</a></div>
<div><a class="link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'Supported Math Functions in DFM Expressions', 'svrf_ur'); return false;">Supported Math Functions in DFM Expressions [Standard Verification Rule Format (SVRF) Manual]</a></div>
<div><a class="link" href="../../svrf_ur/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'Math Operators', 'svrf_ur'); return false;">Math Operators [Standard Verification Rule Format (SVRF) Manual]</a></div></div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_solns_pv_user"
                DocTitle = "Calibre® Solutions for Physical Verification"
                PageTitle = "Resizing Polygons by a Percentage of the Area"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/TaskTop_ResizingPolygonsByAPercentageOfTheArea_id634e3d43.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® Solutions for Physical Verification, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>