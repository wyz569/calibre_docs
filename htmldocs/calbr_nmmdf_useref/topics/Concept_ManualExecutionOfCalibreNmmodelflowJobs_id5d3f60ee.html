<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Manual Execution of Calibre nmModelflow Jobs" />
<meta name="abstract" content="Jobs can be executed manually, outside of the dispatcher. However, this methodology is only intended as a debugging tool, and should not be used for normal job execution." />
<meta name="description" content="Jobs can be executed manually, outside of the dispatcher. However, this methodology is only intended as a debugging tool, and should not be used for normal job execution." />
<meta name="prodname" content="Calibre® nmModelflow™ User's and Reference Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-16" />
<meta name="Topline" content="Siemens EDA" />
<meta name="IncludeDraftCommentsInChangeLog" content="all" />
<meta name="HighlightColor" content="Pale Blue" />
<meta name="HighlightChanges" content="yes" />
<meta name="Draft" content="none" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_nmmdf_useref" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="NONE" />
<meta name="RevHist" content="none" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="March 2021" />
<meta name="DocumentTitle" content="Calibre® nmModelflow™ User’s and Reference Manual" />
<meta name="ConditionFiltering" content="XML" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,doc.type.documentation.ref, product.version.v2021.2,product.id.P10115,product.id.P10120" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Manual Execution of Calibre nmModelflow Jobs</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Manual Execution of Calibre nmModelflow Jobs" />
<meta name="attributes" content="doc.type.documentation.user,doc.type.documentation.ref, product.version.v2021.2,product.id.P10115,product.id.P10120" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Manual Execution
of Calibre nmModelflow Jobs</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">Jobs can be executed manually, outside
of the dispatcher. However, this methodology is only intended as
a debugging tool, and should not be used for normal job execution.</span>
</div>
<p class="p">The flow for manually executing jobs is as follows:</p>
<ol class="ol"><li class="li" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__id1e87f432-c8b3-4eca-a1e7-07f9ac8c09a7"><p class="p">Invoke
Calibre WORKbench and configure a Calibre nmModelflow job, specifying
a runscript. This runscript can be one that is modified and stored
in a specific directory, or can be one of the built-in runscripts,
as follows:</p>
<ul class="ul"><li class="li" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__id145442c2-d1a3-4904-a493-51b755a2219f"><p class="p">If the
script is one of the built-in example runscripts, you can simply
name it without using a full pathname (<span class="keyword ParameterName OptionalReplaceable">run_rsh_ssh.sh</span>)</p>
<pre class="pre codeblock"><code>mdf db update calibrationjobtable -key CJ-23 -runcommand {run_rsh_ssh.sh <span class="keyword ParameterName OptionalReplaceable">arguments</span> ...}</code></pre></li>
<li class="li" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__idbca07e80-1852-4de4-b0f1-ab8a79c988ae"><p class="p">If you copy
and modify one of the built-in example runscripts and store it in
a global directory, you must refer to it using a fully qualified
hard-coded path to that directory.</p>
<pre class="pre codeblock"><code>mdf db update calibrationjobtable -key CJ-23 -runcommand {/home/caltests/bin/my_run_local.sh <span class="keyword ParameterName OptionalReplaceable">arguments</span> ...}</code></pre></li>
<li class="li" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__id47da61a2-31f1-409d-95de-465a098e5d61"><p class="p">If you copy
and modify one of the built-in example scripts and store it in the directory
you invoked Calibre WORKbench from, this can be indicated using
the CALIBRE_INVOKE_DIR environment variable.</p>
<pre class="pre codeblock"><code>mdf db update calibrationjobtable -key CJ-23 -runcommand {<span class="keyword ParameterName OptionalReplaceable">$CALIBRE_INVOKE_DIR/my_run_local.sh</span> <span class="keyword ParameterName OptionalReplaceable">arguments</span> ...}</code></pre><div class="note note"><span class="notetitle">Note:</span> <p class="p">It is extremely important that you not store
any runscript files in your job directory; this directory is deleted
and reconstructed when a job is prepared.</p>
</div>
</li>
</ul>
</li>
<li class="li" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__iddf0746a5-96ad-4388-8396-cb9032f6ce38"><p class="p">Enter the command: </p>
<pre class="pre codeblock"><code>mdf job prepare <span class="keyword ParameterName OptionalReplaceable">key</span> </code></pre><p class="p">where <span class="keyword ParameterName OptionalReplaceable">key</span> is
the job identifier as shown in the Jobs list (CJ-23, for example).</p>
<p class="p">Calibre nmModelflow prepares a job directory with the job executable
files, but does not run them.</p>
</li>
<li class="li" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__id597f3894-df0d-4320-8928-276e6d64bdc6"><p class="p">Exit Calibre
WORKbench.</p>
</li>
<li class="li" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__id3a76032d-29bb-44be-b5d8-1beac057f63c"><p class="p">In a terminal
window, navigate to the job directory.</p>
</li>
<li class="li" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__id6cb1ce96-d45f-4158-bc57-65fb3bd68698"><p class="p">(Optional)
Edit the runscript file as needed to select remote hosts, allocation
parameters, or other relevant items.</p>
</li>
<li class="li" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__ida6dd8e44-e90c-4657-aa9d-4cbbb1aee3c4"><p class="p">Invoke the <span class="ph filepath">job.sh</span> script.
The job script should source the <span class="ph filepath">env.sh</span> script
containing the required environment variables, and then execute
the runscript. One of the environment variables set in that <span class="ph filepath">env.sh</span> file
is CALIBRE_INVOKE_DIR, which refers to the current working directory
used before step 2 (and not the job directory, which is overwritten
by newly-created jobs). </p>
<p class="p">If the script is then copied to the same directory where you
invoke Calibre WORKbench, you can configure the job run command
to execute the script such as in the following example: </p>
<pre class="pre codeblock"><code>mdf db update calibrationjobtable -key CJ-23 -runcommand {$CALIBRE_INVOKE_DIR/my_run_local.sh} </code></pre><p class="p">You must wait for the job to complete, since it is running in
the terminal window. Only output from the runscript shows in the
terminal window; no calibration job output is shown. The calibration
job output is written to the <span class="ph filepath">job.transcript</span> file. </p>
<p class="p">If the runscript exits with an error, or the calibration job
exits with an error, the status file will not be updated; this is
expected, since this flow is for debugging purposes only. However,
if the user invokes the Calibre nmModelflow GUI, the state for the
job shows “Ready” instead of “Done” or “Error”.</p>
</li>
</ol>
<div class="section Subsections"><div class="section Subsection" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__id0a717752-a172-44de-a524-4b1a65c56fd0"><h2 class="title Subheading sectiontitle">Example Batch Execution, No Waiting</h2><p class="p">This example code executes a job and lets it run to completion
without waiting. It generates a Tcl script, and the script executes
Calibre WORKbench. </p>
<pre class="pre codeblock"><code>#!/bin/bash
# Set the nmModelFlow environment variables:
export CALIBRE_MDF_WORKDIR_DEFAULT="./tmpworkdir"
export CALIBRE_MDF_DISPATCHER_DIR="./mdfdispatcher"
export CALIBRE_MDF_DB_HOME="./mdfdatabase"

# Process command-line options:
JOB_KEY=$1
if [ -z "$JOB_KEY" ]
then  
	echo "USAGE: $0 JOB_KEY"  
	exit 1
fi

# Create a temporary Tcl script file:
tmp_script_file=/tmp/tmp$$.tcl
cat &gt; $tmp_script_file &lt;&lt;EOF

# Clear the job :
mdf job clear $JOB_KEY

# Execute the job:
mdf job execute $JOB_KEY
EOF

# Run calibrewb on the script file:
$MGC_HOME/bin/calibrewb $tmp_script_file
# Remove the temporary script file
rm -f $tmp_script_file</code></pre></div>
<div class="section Subsection" id="id5d3f60ee-9d1c-47d1-a3a0-a3547e7cfd8c__id0072e173-1d69-4362-b00e-a8395cc7d570"><h2 class="title Subheading sectiontitle">Example
Batch Execution, Job Wait</h2><p class="p">This example code shows a script that executes a job, but waits
for it to complete. It generates a Tcl script, and executes Calibre
WORKbench. The script completes when the job completes, with a state
of success (Done) or an error (Error). </p>
<p class="p">The only difference between this example and the previous one
is the use of the mdf job wait command.</p>
<pre class="pre codeblock"><code>#!/bin/bash

# Set the nmModelFlow environment variables:
export CALIBRE_MDF_WORKDIR_DEFAULT="./tmpworkdir"
export CALIBRE_MDF_DISPATCHER_DIR="./mdfdispatcher"
export CALIBRE_MDF_DB_HOME="./mdfdatabase"

# Process command-line options:
JOB_KEY=$1
if [ -z "$JOB_KEY" ]
then  
	echo "USAGE: $0 JOB_KEY"  
	exit 1
fi

# Create a temporary Tcl script file:
tmp_script_file=/tmp/tmp$$.tclcat &gt; $tmp_script_file &lt;&lt;EOF

# Clear the job :
mdf job clear $JOB_KEY
# Execute the job:
mdf job execute $JOB_KEY</code></pre><pre class="pre codeblock"><code># Wait for the job to finish; dump out transcripts for any errors:
mdf job wait {Done Error Stopped} 0 $JOB_KEY -dump_transcripts_upon_error</code></pre><pre class="pre codeblock"><code>EOF
# Run calibrewb on the script file:
$MGC_HOME/bin/calibrewb $tmp_script_file
# Remove the temporary script file
rm -f $tmp_script_file</code></pre></div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCAppe_SystemFlowAndRunscriptInformation_id2db09b3e.html" title="It is useful to understand the system flow and runscripts used by the Calibre nmModelflow tool.">System Flow And Runscript Information</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_nmmdf_useref"
                DocTitle = "Calibre® nmModelflow™ User’s and Reference Manual"
                PageTitle = "Manual Execution of Calibre nmModelflow Jobs"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_ManualExecutionOfCalibreNmmodelflowJobs_id5d3f60ee.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® nmModelflow™ User’s and Reference Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>