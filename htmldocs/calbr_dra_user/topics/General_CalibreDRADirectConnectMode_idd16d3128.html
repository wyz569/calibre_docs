<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="GeneralRefTopic" />
<meta name="DC.Title" content="Calibre DRA Direct Connect Mode" />
<meta name="abstract" content="The Calibre DRA Direct Connect mode is similar to Calibre DRA with the exception that the Calibre job is not responsible to launch extra remote processes. The Calibre job simply accepts the remote connections. An external system, such as a job scheduler or user, decides when and how to launch the extra remotes." />
<meta name="description" content="The Calibre DRA Direct Connect mode is similar to Calibre DRA with the exception that the Calibre job is not responsible to launch extra remote processes. The Calibre job simply accepts the remote connections. An external system, such as a job scheduler or user, decides when and how to launch the extra remotes." />
<meta name="prodname" content="Calibre Dynamic Resource Allocator (DRA) User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-26" />
<meta name="Topline" content="Siemens EDA" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="2" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_dra_user" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="none" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® Dynamic Resource Allocator (DRA) User’s Manual" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,doc.type.documentation.sys,product.version.v2021.2,product.id.P10101" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeDraftCommentsInChangeLog" content="2021.1" />
<meta name="HighlightChanges" content="yes" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="idd16d3128-0c81-4990-b5f9-9214ef664999" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Calibre DRA Direct Connect Mode</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Calibre DRA Direct Connect Mode" />
<meta name="attributes" content="doc.type.documentation.user,doc.type.documentation.sys,product.version.v2021.2,product.id.P10101" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body class="default" id="idd16d3128-0c81-4990-b5f9-9214ef664999">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Calibre DRA Direct Connect Mode</h1>
<div class="body refbody GeneralRefBody"><div class="abstract GeneralRefAbstract"><span class="shortdesc">The Calibre DRA Direct Connect mode
is similar to Calibre DRA with the exception that the Calibre job
is not responsible to launch extra remote processes. The Calibre
job simply accepts the remote connections. An external system, such
as a job scheduler or user, decides when and how to launch the extra
remotes.</span>
</div>
<div class="section Subsections"><div class="section Subsection" id="idd16d3128-0c81-4990-b5f9-9214ef664999__id09b26373-9cb7-4bf8-9058-240c6406c511"><h2 class="title Subheading sectiontitle">Direct
Connect MTflex Example</h2><p class="p">In the following example from the configuration file, the Calibre
process no longer launches the remote processes. This task is handled
by the external system.</p>
<p class="p">Refer to the <a class="xref LinkItalic" href="../../calbr_admin_gd/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'manual title', 'calbr_admin_gd'); return false;">Calibre Administrator’s Guide</a> for the exact syntax and a complete description of the
Calibre MTflex configuration file</p>
<pre class="pre codeblock"><code>// MTflex file statements.
// Protects against unresponsive hosts.
MONITOR SYSTEM INTERVAL 900 HEARTBEAT 4 PRINT
// Shows CPU load in log.
MONITOR LOCAL LOAD INTERVAL 20
// For DRA, computes CPU demand.
MONITOR UTILITY
// DRA Direct Connect mode: Don’t launch any remote hosts.
// This action is performed externally.
// Calibre job waits for external connections on specified ports.
// Connect on specified ports while job is running.
// Start computing when one remote connects (it has 60 seconds.)
// Job can be scaled up to 20000 remote processes.
// Make sure port numbers are available before using them.
LAUNCH MANUAL PORT 1234 WAIT 60 COUNT 1 MAXCOUNT 20000 CTRLPORT 5678</code></pre><p class="p">The two port numbers written in the MTflex
configuration file must be available on the primary host when the
Calibre job starts. In the Calibre DRA Direct Connect mode, the
user is responsible to choose these port numbers. The ports must
be specified in the <a class="xref fm:HeadingOnly" href="Command_CalibreDraRemote_id81b388b0.html#id81b388b0-4832-47e3-a999-70d2e0bc1314__Command_CalibreDraRemote_id81b388b0.xml#id81b388b0-4832-47e3-a999-70d2e0bc1314" title="You can use calibre_dra_remote to connect available remotes launched through an external system to a Calibre primary process running with Calibre DRA.">calibre_dra_remote</a> command
launched from the remote hosts. This specification tells the remotes
where to connect on the primary host.</p>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">The specified LAUNCH MANUAL keyword options are mandatory
for Calibre DRA Direct Connect mode usage. The LAUNCH MANUAL keywords,
MAXCOUNT and CTRLPORT, are only used for the Calibre DRA Direct
Connect mode.</p>
</div>
<p class="p">The following example shows the Calibre command line arguments
for ‑remotefile <span class="ph filepath">mtflex</span>, <a class="xref fm:HeadingOnly" href="Command_CalibreDraRemote_id81b388b0.html#id81b388b0-4832-47e3-a999-70d2e0bc1314__Command_CalibreDraRemote_id81b388b0.xml#id81b388b0-4832-47e3-a999-70d2e0bc1314" title="You can use calibre_dra_remote to connect available remotes launched through an external system to a Calibre primary process running with Calibre DRA.">calibre_dra_remote</a>, and <a class="xref fm:HeadingOnly" href="Command_CalibreDra_id2b5ebaae.html#id2b5ebaae-b77c-422c-a447-e0938a9e523b__Command_CalibreDra_id2b5ebaae.xml#id2b5ebaae-b77c-422c-a447-e0938a9e523b" title="You use the calibre_dra command to obtain status information and to adjust the resources for a Calibre job that is running.">calibre_dra</a>.</p>
<pre class="pre codeblock"><code>$MGC_HOME/bin/calibre -drc -hier -turbo -dra <span class="ph CodeHighlight magenta">-remotefile</span> <span class="ph filepath">mtflex \
</span><span class="ph filepath">rules.svrf</span> &gt; calibre.log &amp;
# Connect one remote to start the job; 
# LAYOUT DATA INPUT MODULE doesn't need many remotes.
ssh &lt;<span class="keyword ParameterName OptionalReplaceable">remotehost</span>&gt; "$MGC_HOME/bin/<span class="ph CodeHighlight magenta">calibre_dra_remote</span> \
-master <span class="keyword ParameterName OptionalReplaceable">&lt;primaryhost&gt;</span> -ports <span class="keyword ParameterName OptionalReplaceable">5678</span>:<span class="keyword ParameterName OptionalReplaceable">1234</span>"
# Check job status and scale up the job when needed.
$MGC_HOME/bin/<span class="ph CodeHighlight magenta">calibre_dra</span> –log calibre.log –status</code></pre></div>
<div class="section Subsection" id="idd16d3128-0c81-4990-b5f9-9214ef664999__id57550d98-ab4e-44c8-8995-8ab38a262cc7"><h2 class="title Subheading sectiontitle">Effect
of DRA Direct Connect in Calibre Transcript</h2><p class="p">In the following Calibre transcript example, the Calibre tool
waits 60 seconds for a remote to be launched externally. The initial
connection is for one remote only. During the job, the external system
or user can scale up the job (up to MAXCOUNT) using calibre_dra_remote.
The calibre_dra -status command can be used to help determine the
resource adjustment.</p>
<pre class="pre codeblock"><code>// Mentor Graphics software executing under x86-64 Linux
// Running Mgc_home/pkgs/icv/pvt/calibre -dra -remotefile
// <span class="keyword ParameterName OptionalReplaceable">mtflex_dra_direct_connect</span> -drc -hier -turbo <span class="keyword ParameterName OptionalReplaceable">rules.svrf</span>
// Reading remote host configuration file:
// <span class="keyword ParameterName OptionalReplaceable">mtflex_dra_direct_connect</span>
// Necessary for DRA to compute CPU demand.
MONITOR UTILITY
// Protection against unresponsive remotes.
MONITOR SYSTEM INTERVAL 300 HEARTBEAT 4 PRINT
MONITOR LOCAL LOAD INTERVAL 120
LAUNCH MANUAL PORT 1234 WAIT 60 COUNT 1 MAXCOUNT 20000 CTRLPORT 5678
// Performing manual launch of remote hosts: WAIT 60
// Connected to CPU on remote host &lt;<span class="keyword ParameterName OptionalReplaceable">remote_hostname</span>&gt;
// List of connected remote cpus:
// REMOTE CPU &lt;<span class="keyword ParameterName OptionalReplaceable">remote_hostname</span>&gt; (&lt;<span class="keyword ParameterName OptionalReplaceable">ip_address</span>&gt;) : pid = …
// Calibre Controller Connection &lt;<span class="keyword ParameterName OptionalReplaceable">remote_hostname</span>&gt;:&lt;<span class="keyword ParameterName OptionalReplaceable">5678</span>&gt;
--- CALIBRE::DRC-H CALIBRE REMOTE PROTOCOL INITIALIZATION MODULE COMPLETED.  CPU TIME = 0  REAL TIME = 13
...
_im10_ = LENGTH _im1_ &gt;= 0.012 &lt;= 1.4
-------------------------------------
// Connected to CPU on remote host &lt;<span class="keyword ParameterName OptionalReplaceable">remote_hostname</span>&gt;, logfile = …
// Connected to CPU on remote host &lt;<span class="keyword ParameterName OptionalReplaceable">remote_hostname</span>&gt;, logfile = …
// Connected to CPU on remote host &lt;<span class="keyword ParameterName OptionalReplaceable">remote_hostname</span>&gt;, logfile = …
// Applying licensing policy...
&lt;DCA 41 0 12 N &lt;<span class="keyword ParameterName OptionalReplaceable">remote_hostname</span>&gt; R 20 20 2 6 6 T 7 4 0 A 0 0 14972(V)[14959]
 …&gt;
_im10_ (HIER-FMF TYP=2 CFG=1 HGC=4788723 FGC=12774154 HEC=4788723 FEC=12774154 IGC=18992 VHC=F VPC=F)CPU TIME = 1 + 17  REAL TIME = 6  LVHEAP = 51/715/715  OPS COMPLETE = 8 OF 20  ELAPSED TIME = 46</code></pre></div>
<div class="section Subsection" id="idd16d3128-0c81-4990-b5f9-9214ef664999__id6f718bbb-6939-4edb-afbf-b02078d7de11"><h2 class="title Subheading sectiontitle">Direct
Connect Scale-Up Example</h2><p class="p">In this example, a shell script is used to implement an “external
system” that adjusts the remote resources based on information from
a calibre_dra ‑status command</p>
<p class="p">For example, calibre_dra ‑status for a Calibre job running a
large LITHO simulation shows the following information.</p>
<pre class="pre codeblock"><code>REPORT BRIEF
  TIMESTAMP: 405
   OPS COMPLETE: 19(95%) of 20
   MODULE NAME: EXECUTIVE MODULE MTFlex HDB(0)
   OPNAME: metal1_opc OP-TIMESTAMP: 357
           OP-ECP: 0.0% OP-CLASS: LITHO:70
   ACTIVE REMOTE: 4 CELL QUEUE LENGTH: 78
   STRIPE QUEUE LENGTH: 59 TOTAL ACTIVE REMOTE: 4/4
 END </code></pre><p class="p">To scale the job up, if 500 remote hosts are available with 40
CPUs each, the following shell script is implemented.</p>
<pre class="pre codeblock"><code>#!/bin/bash
i=1
while [ $i -le 40 ]
do
  foreach remotehost (`./<span class="keyword ParameterName OptionalReplaceable">list_remote_hosts.sh</span>`)
     ssh $remotehost "$MGC_HOME/bin/calibre_dra_remote \
							-master &lt;<span class="keyword ParameterName OptionalReplaceable">primaryhost</span>&gt; -ports <span class="keyword ParameterName OptionalReplaceable">5678</span>:<span class="keyword ParameterName OptionalReplaceable">1234</span> &amp;"
  end
  i=$(( $i + 1 ))
end</code></pre><p class="p">The shell script is a manual implementation. In a production
environment, a job scheduler is recommended to control and optimize
the utilization of jobs with large‑scale CPU clusters.</p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCChap_RunningCalibreDra_id3e2d945a.html" title="This section covers how to create a customized Calibre MTflex file, invoke Calibre DRA, and then use it to access the resources and status of your running Calibre job.">Running Calibre DRA</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_dra_user"
                DocTitle = "Calibre® Dynamic Resource Allocator (DRA) User’s Manual"
                PageTitle = "Calibre DRA Direct Connect Mode"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/General_CalibreDRADirectConnectMode_idd16d3128.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® Dynamic Resource Allocator (DRA) User’s Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>