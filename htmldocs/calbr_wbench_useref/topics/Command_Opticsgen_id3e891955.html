<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="CommandRefTopic" />
<meta name="DC.Title" content="opticsgen" />
<meta name="abstract" content="Creates an optical model and associated source map file from an optical parameters file." />
<meta name="description" content="Creates an optical model and associated source map file from an optical parameters file." />
<meta name="prodname" content="Calibre WORKbench User's and Reference Manual" />
<meta name="version" content="2017.3" />
<meta name="release" content="v2017.3" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Calibre WORKbench User's and Reference Manual" />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-18" />
<meta name="Topline" content="Siemens EDA" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="HighlightChanges" content="yes" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="calbr_wbench_useref" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="none" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="IncludeDraftCommentsInChangeLog" content="all;show" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="March 20, 2021" />
<meta name="Draft" content="NONE" />
<meta name="DocumentTitle" content="Calibre® WORKbench™ User’s and Reference Manual" />
<meta name="ConditionFiltering" content="XML" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.user,product.version.v2021.2,product.id.P10115,product.id.P10120" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id3e891955-c2bf-4dc9-90be-6af511310ec6" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>opticsgen</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="opticsgen" />
<meta name="attributes" content="doc.type.documentation.user,product.version.v2021.2,product.id.P10115,product.id.P10120" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body class="usa-arg" id="id3e891955-c2bf-4dc9-90be-6af511310ec6">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">opticsgen</h1>
<div class="body refbody CommandRefBody"><div class="abstract CommandRefAbstract"><p class="p ContextMGC"><a class="xref fm:HeadingOnly" href="Contain_OpticalModelingCommands_idf531f086.html#idf531f086-0616-4eeb-97b7-accb0f1f55ee__Contain_OpticalModelingCommands_idf531f086.xml#idf531f086-0616-4eeb-97b7-accb0f1f55ee" title="Optical model file commands require specific inputs and parameters in order to produce optical model-related files.">Optical Model Commands</a></p>
<p class="shortdesc">Creates an optical model and
associated source map file from an optical parameters file. </p>
<div class="note tip"><span class="tiptitle">Tip</span> <p class="p">For information on the
format of the optical parameter file, refer to “<a class="xref fm:HeadingAndPage" href="Concept_OpticalParametersFileFormat_id5a50af0d.html#id5a50af0d-f6e6-4f01-8c58-8031c78cdb05__Concept_OpticalParametersFileFormat_id5a50af0d.xml#id5a50af0d-f6e6-4f01-8c58-8031c78cdb05" title="The Optical Parameters file format defines the parameters for an optical model. The format can be included inline in a setup file">Optical Parameters File Format</a>”. </p>
</div>
</div>
<div class="section Usages"><h2 class="title Subheading sectiontitle">Usage</h2><div class="section UsageSet"><p class="lines UsageLine"><span class="keyword ParameterName Required">opticsgen</span> [<span class="keyword ParameterName Required">-opticalfile</span> <span class="keyword ParameterName RequiredReplaceable">optical</span> | <span class="keyword ParameterName Required">-opticalstring</span> <span class="keyword ParameterName RequiredReplaceable">string</span>] <span class="keyword ParameterName Required">-o</span> <span class="keyword ParameterName RequiredReplaceable">outmodel </span> <br />
[-writetccs] [-noheader] [-usetccs <span class="keyword ParameterName OptionalReplaceable">precomputed_model</span>] [-nolookuptables]</p>
</div>
</div>
<div class="section Arguments"><h2 class="title Subheading sectiontitle">Arguments</h2><div class="section ArgumentSet"><dl class="dl ArgumentList"><dt class="dt ArgumentName dlterm" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__id03d6a9be-31ed-4f1f-851a-037acc5debfc"><span class="keyword ParameterName Required">-opticalfile</span> <span class="keyword ParameterName RequiredReplaceable">optical</span> </dt>
<dd class="dd ArgumentDescription"><p class="p">A required keyword and value
pair specifying the optical parameter file that defines the optical
model.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__id0b575e72-85a5-4c47-9696-93ac55471f47"><span class="keyword ParameterName Required">-opticalstring</span> <span class="keyword ParameterName RequiredReplaceable">string</span></dt>
<dd class="dd ArgumentDescription"><p class="p">An alternative to specifying an
optical file, the -opticalstring option lets you specify an optical
model inline. <span class="keyword ParameterName RequiredReplaceable">string </span>must
be enclosed in curly braces, and can be used in conjunction with
an environment variable. </p>
</dd>
<dt class="dt ArgumentName dlterm" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__id36268195-8689-4178-aeb9-e2e978b59174"><span class="keyword ParameterName Required">-o</span> <span class="keyword ParameterName RequiredReplaceable">outmodel</span> </dt>
<dd class="dd ArgumentDescription"><p class="p">A required keyword and value
pair specifying the name of the resulting optical model. The application
creates a directory with this name and stores all the files required
for the model in this directory, including the following: </p>
<ul class="ul"><li class="li" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__ide875b801-3c9d-48ea-80a7-10c8439635fe"><p class="p">Binary files with the lookup-tables
for the SOCS kernel and mask convolutions</p>
</li>
<li class="li" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__id6b67552e-c77e-44d6-bb82-b9fb18b58a75"><p class="p"><span class="ph filepath">illummap.smf</span>,
a source map text file, which you can view using the Source View
tool in Calibre WORKbench</p>
</li>
</ul>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">The value of <span class="keyword ParameterName RequiredReplaceable">outmodel</span> cannot be
‘.’, ‘./’, ‘..’, ‘../’ or any string starting with a dot such as
‘.abcd’. These values produce error messages. Values starting with
‘./’ followed by additional characters are acceptable.</p>
</div>
</dd>
<dt class="dt ArgumentName dlterm" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__id2f9987b6-aef4-4b63-9fcf-c72f655f1c03">-writetccs </dt>
<dd class="dd ArgumentDescription"><p class="p">An optional keyword that instructs opticsgen
to write the TCC matrix to the disk. This is performed even if the
-nolookuptables option is specified. </p>
</dd>
<dt class="dt ArgumentName dlterm" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__id377d869b-d036-4843-98c7-f615e4ecb700">-noheader</dt>
<dd class="dd ArgumentDescription"><p class="p">An optional keyword that instructs opticsgen
to not print the optical model header to any of the binary files.
This is not an encrypted method; both the optical file and the sourcemap <span class="keyword ParameterName OptionalReplaceable">.sml</span> files
are still written to the disk directory.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__id50b65e82-54fe-4d4b-949b-5b2b6d0d645d">-usetccs <span class="keyword ParameterName OptionalReplaceable">precomputed_model</span></dt>
<dd class="dd ArgumentDescription"><p class="p">An optional keyword that uses a precomputed
optical model’s TCC matrix, rather than rebuilding the TCC matrix.
Use this keyword to regenerate a new optical model with different
numbers of optical kernels (approxorder) when you do not want to
wait to regenerate the TCC matrix. -usetccs is commonly used with
the -writetccs keyword.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__ide8dad6a0-fc85-4a76-a850-fe8a8dc854cc">-nolookuptables</dt>
<dd class="dd ArgumentDescription"><p class="p">An optional flag that directs
opticsgen to omit the creation of the binary files with the lookup
tables for SOCS kernel and mask convolution. In this case, the optical
model is comprised of the SOCS kernels (a <span class="ph filepath italic">*.fsk</span> file)
and the SOCS weights (an *<span class="ph filepath italic">_0_0_0.omf</span> file)
and takes up significantly less disk space. Models without SOCS
lookup tables are appropriate for dense image simulations. (Does
not work for Calibre OPCpro.)</p>
</dd>
</dl>
</div>
</div>
<div class="section Descriptions"><h2 class="title Subheading sectiontitle">Description</h2><div class="note note"><span class="notetitle">Note:</span> <p class="p">When
specifying any filename, you must be sure to provide either the
absolute or relative path to the directory from which you invoke
Calibre WORKbench.</p>
</div>
<p class="p">You can instruct this command to
write the optical kernels to disk by setting the environment variable
WB_PRINT_MODEL.</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="id3e891955-c2bf-4dc9-90be-6af511310ec6__id724d3b66-0798-46aa-8f85-2af1afc4a7cb" class="table" frame="void" border="0" rules="none"><colgroup><col style="width:2.686in" /><col style="width:3.814in" /></colgroup><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;"><pre class="pre codeblock"><code>setenv WB_PRINT_MODEL 1</code></pre></td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;"><p class="p">in the <span class="ph filepath">.cshrc</span> file</p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;"><pre class="pre codeblock"><code>set env(WB_PRINT_MODEL) 1</code></pre></td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;"><p class="p">in the <span class="ph filepath">.signaext</span> file
or tclsh command prompt</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p">This causes the kernels to be written
to the files <span class="ph filepath">h0.bin</span>, <span class="ph filepath">h1.bin</span>,
and so on.</p>
<p class="p">You can read these files using
the Source View tool (see “<a class="xref fm:HeadingAndPage" href="Contain_PostGenerationOpticalModelVisualizationTools_id346348d8.html#id346348d8-82e2-4680-864d-f861ee41facf__Contain_PostGenerationOpticalModelVisualizationTools_id346348d8.xml#id346348d8-82e2-4680-864d-f861ee41facf" title="Every time an optical model is created, the system generates a source map file called illummap.smf and stores it in the optical model directory.">Post-Generation - Optical Model Visualization Tools</a>”) or by using the following
MATLAB script:</p>
<pre class="pre codeblock leveled"><code>%/**********************************************************************/
%/* Copyright Mentor Graphics Corporation 2008  All Rights Reserved.   */
%/*                                                                    */
%/* THIS WORK CONTAINS TRADE SECRET AND PROPRIETARY INFORMATION        */
%/* WHICH IS THE PROPERTY OF MENTOR GRAPHICS CORPORATION OR ITS        */
%/*   LICENSORS AND IS SUBJECT TO LICENSE TERMS.                       */
%/**********************************************************************/</code></pre><pre class="pre codeblock leveled"><code>% y = readgridgen(fname);
% Returns an array from the gridheadGen in the file fname
% This script is independent of the endianess of the file</code></pre><pre class="pre codeblock leveled"><code>function [t, test] = readgridgen(fname)
tic;
% assume little endian
endianess = 'l';
fid = fopen(fname,'r',endianess);
if fid==-1
    ferr=fopen('errors.txt','a');
    fwrite(ferr,['unable to open file' fname]);
end
% read byte to see if its big endian
isBE = fread(fid, 1 ,'char');
if(isBE)
    % switch fread to big endian
    fclose(fid);
    endianess = 'b';
    fid = fopen(fname,'r',endianess);
    isBE = fread(fid, 1 ,'char');
end
info = fread(fid, 4 ,'int');
prec = info(1);
type = info(2);
sz = [info(3) info(4) ];</code></pre><pre class="pre codeblock leveled"><code>if( (prec~=2 &amp;&amp; prec ~=1) || (type~=2 &amp;&amp; type~=1) )
    %fail('Error -- old grid file')
    % Likely an error or an older gridhead file
    % fclose(fid);    
    %display('Regular grid head file detected, calling readgrid.m');
    % fid = fopen(fname,'r',endianess);
    % info = fread(fid, 3 ,'int');
    %if( (info(3)~=1 &amp;&amp; info(3)~=2) || info(1)&lt;0 || info(2)&lt;0 )
    %    if(endianess=='l')
    %        endianess='b';
    %    else
    %        endianess='l';
    %    end
    %end
    %fclose(fid);
    %[t, test] = readgrid(fname,endianess);
else
    % reading the pointer from the gridhead
    %useless = fread(fid, 4, 'char');</code></pre><pre class="pre codeblock leveled"><code>    if( prec == 1 )
        precision = 'float';
    else
        precision = 'double';
    end</code></pre><pre class="pre codeblock leveled"><code>    if type == 1
        t = fread(fid, sz, precision);
        t = t';
    else
        t2 = fread(fid,[ 2*sz(1) sz(2)],precision);
        test = fread(fid,2*sz(1),precision);
        size(t2)
        clear i;
        t2 = t2';
        ret = t2(:,1:2:end);
        imt = t2(:,2:2:end);
        %   for n1 = 1:sz(1),
        %     ret(:,n1) = t2(:,2*n1-1);
        %     imt(:,n1) = t2(:,2*n1);
        %   end
        t = ret + i * imt;
    end
    fclose(fid);
    %toc
end</code></pre></div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_OpticalModelingCommands_idf531f086.html" title="Optical model file commands require specific inputs and parameters in order to produce optical model-related files.">Optical Model Commands</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_wbench_useref"
                DocTitle = "Calibre® WORKbench™ User’s and Reference Manual"
                PageTitle = "opticsgen"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Command_Opticsgen_id3e891955.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® WORKbench™ User’s and Reference Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>