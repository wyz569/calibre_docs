<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Write the Command Procedure" />
<meta name="abstract" content="You can write a command procedure to invoke another application or perform data manipulation. The macro command procedure must be GUI-independent. It relies on the GUI plug-in to pass it the proper user input." />
<meta name="description" content="You can write a command procedure to invoke another application or perform data manipulation. The macro command procedure must be GUI-independent. It relies on the GUI plug-in to pass it the proper user input." />
<meta name="prodname" content="Calibre DESIGNrev Reference Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-26" />
<meta name="Topline" content="Siemens EDA" />
<meta name="IncludeDraftCommentsInChangeLog" content="2019.4" />
<meta name="GenerateOnlyChangedTopics" content="no" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="HighlightChanges" content="yes" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="2" />
<meta name="SubTitle" content="Batch Command Support for Calibre® DESIGNrev™, Calibre® WORKbench™, Calibre® LITHOview™, and Calibre® MDPview™" />
<meta name="SourceHandle" content="calbr_drv_ref" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® DESIGNrev™ Reference Manual" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10088,product.id.P10120" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="idb341892f-8949-415a-b5b6-51ed0371209d" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Write the Command Procedure</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Write the Command Procedure" />
<meta name="attributes" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10088,product.id.P10120" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="idb341892f-8949-415a-b5b6-51ed0371209d">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Write the Command Procedure</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">You can write
a command procedure to invoke another application or perform data
manipulation. The macro command procedure must be GUI-independent.
It relies on the GUI plug-in to pass it the proper user input.</span>
</div>
<p class="p">When you learn to write macros,
it is easiest to write the command procedure before writing the
GUI plug-in. Writing the procedure first ensures you know what information
to obtain from the user.</p>
<p class="p">The command procedure performs the actual data
manipulation for the macro. You write it using the standard Tcl
proc format. Note, however, the procedure must follow these conventions:</p>
<ul class="ul"><li class="li" id="idb341892f-8949-415a-b5b6-51ed0371209d__id19bc105c-a3d4-4af2-b6ed-717115527c95"><p class="p">It must be scriptable. That is, once
the GUI plug-in invokes the command procedure, it requires no user
interaction and all processing occurs automatically.</p>
</li>
<li class="li" id="idb341892f-8949-415a-b5b6-51ed0371209d__id05beb971-e93e-4007-a24b-769965a4fef9"><p class="p">It must contain no Tk code.</p>
</li>
<li class="li" id="idb341892f-8949-415a-b5b6-51ed0371209d__id583986ad-9096-49f2-bc36-0c4131a8bbd0"><p class="p">It can perform operations only on a layout
object. That is, it should not depend on the state of the Viewer.</p>
</li>
</ul>
<p class="p">There are no constraints on the arguments for
command procedures, nor are there further constraints on the types
of processing it can perform. Any valid Tcl script is allowed.</p>
<p class="p">The code you write to create a macro can be
located in the <span class="ph filepath italic">wbinit.tcl</span> file
or a separate file.</p>
<ul class="ul"><li class="li" id="idb341892f-8949-415a-b5b6-51ed0371209d__idcf62090c-54fd-4318-af4d-c488893da9ce"><p class="p">In the <span class="ph filepath italic">wbinit.tcl</span> file
— If you define the macro in the <span class="ph filepath">wbinit.tcl</span> file,
embed it within a conditional statement instructing the tool to
ignore the macro when the Tk package is not loaded, as described
in “<a class="xref fm:HeadingAndPage" href="Contain_TclVersusTkWhatDistinctionMeansYou_idf6f71d6f.html#idf6f71d6f-9189-4557-9231-9d6357fc2619__Contain_TclVersusTkWhatDistinctionMeansYou_idf6f71d6f.xml#idf6f71d6f-9189-4557-9231-9d6357fc2619" title="Tcl is rarely mentioned without Tk because of the close relationship between the two. Tcl is the language used to write scripts, while Tk is the toolkit of building blocks used to build graphical user interfaces for Tcl programs. Tk is basically an extension to Tcl.">Tcl Versus Tk and What the Distinction Means to You</a>”. The <span class="ph filepath">wbinit.tcl</span> file
is discussed in the <a class="xref LinkItalic" href="../../calbr_drv_user/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'manual title', 'calbr_drv_user'); return false;">Calibre DESIGNrev Layout Viewer User’s Manual</a>.</p>
</li>
<li class="li" id="idb341892f-8949-415a-b5b6-51ed0371209d__idd58f9fcf-21ee-40dd-9c9b-b8c98f598ca7"><p class="p">In a separate file — If you define the
macro in a separate file, you need to load it into the application.
Refer to “<a class="xref fm:HeadingAndPage" href="Concept_LoadMacro_idb814f78d.html#idb814f78d-5168-4563-9249-db26b74f42c8__Concept_LoadMacro_idb814f78d.xml#idb814f78d-5168-4563-9249-db26b74f42c8" title="Once the macro is registered, you can issue the Macros menu command to refresh the Macros menu so the new command is available to you.">Load the Macro</a>” for information on loading
a macro.</p>
</li>
</ul>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_WritingMacros_id77aaf373.html" title="One of the many uses for macros is to provide access to the many Calibre batch tools (such as DRC, LVS, the RET batch tools), essentially making them interactive from the graphical user interface. However, you can use macros to perform many other functions as well.">About Writing Macros</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_drv_ref"
                DocTitle = "Calibre® DESIGNrev™ Reference Manual"
                PageTitle = "Write the Command Procedure"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_WriteCommandProcedure_idb341892f.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® DESIGNrev™ Reference Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>