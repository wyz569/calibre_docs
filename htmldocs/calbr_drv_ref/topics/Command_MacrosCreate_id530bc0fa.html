<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="CommandRefTopic" />
<meta name="DC.Title" content="Macros create" />
<meta name="abstract" content="Creates a macro." />
<meta name="description" content="Creates a macro." />
<meta name="DC.subject" content="Macros create command" />
<meta name="keywords" content="Macros create command" />
<meta name="prodname" content="Calibre DESIGNrev Reference Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-26" />
<meta name="Topline" content="Siemens EDA" />
<meta name="IncludeDraftCommentsInChangeLog" content="2019.4" />
<meta name="GenerateOnlyChangedTopics" content="no" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="HighlightChanges" content="yes" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="2" />
<meta name="SubTitle" content="Batch Command Support for Calibre® DESIGNrev™, Calibre® WORKbench™, Calibre® LITHOview™, and Calibre® MDPview™" />
<meta name="SourceHandle" content="calbr_drv_ref" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® DESIGNrev™ Reference Manual" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10088,product.id.P10120" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id530bc0fa-ee59-4d02-a363-242364081114" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Macros create</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Macros create" />
<meta name="attributes" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10088,product.id.P10120" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body class="usa-arg" id="id530bc0fa-ee59-4d02-a363-242364081114">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Macros create</h1>
<div class="body refbody CommandRefBody"><div class="abstract CommandRefAbstract"><span class="shortdesc">Creates a macro.</span>
</div>
<div class="section Usages"><h2 class="title Subheading sectiontitle">Usage</h2><div class="section UsageSet"><p class="lines UsageLine"><span class="keyword ParameterName Required">Macros create</span> <span class="keyword ParameterName RequiredReplaceable">macroName</span> <span class="keyword ParameterName RequiredReplaceable">commandProc</span> <span class="keyword ParameterName RequiredReplaceable">guiPlugin</span></p>
</div>
</div>
<div class="section Arguments"><h2 class="title Subheading sectiontitle">Arguments</h2><div class="section ArgumentSet"><dl class="dl ArgumentList"><dt class="dt ArgumentName dlterm" id="id530bc0fa-ee59-4d02-a363-242364081114__id19c70282-f122-4ade-9d33-196ba4d06658"><span class="keyword ParameterName RequiredReplaceable">macroName</span> </dt>
<dd class="dd ArgumentDescription"><p class="p">A required argument assigning
a name to the macro.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="id530bc0fa-ee59-4d02-a363-242364081114__id9cd2bd69-c561-465a-a1db-691078265c60"><span class="keyword ParameterName RequiredReplaceable">commandProc</span> </dt>
<dd class="dd ArgumentDescription"><p class="p">A required argument specifying
the name of the Tcl procedure which performs the macro processing
you require. This procedure runs the commands you require.</p>
<p class="p">For example, this basic <span class="keyword ParameterName RequiredReplaceable">commandProc</span> procedure
displays a message:</p>
<pre class="pre codeblock leveled"><code>proc my_cmd_procedure { } { 
	tk_messageBox -message "Called my_cmd_procedure." -type ok 
	... 
}</code></pre></dd>
<dt class="dt ArgumentName dlterm" id="id530bc0fa-ee59-4d02-a363-242364081114__id82734758-c406-4e49-9809-821fce6857ce"><span class="keyword ParameterName RequiredReplaceable">guiPlugin</span> </dt>
<dd class="dd ArgumentDescription"><p class="p">A required argument specifying
the Tcl procedure that interfaces to the Calibre layout viewer GUI.
This GUI plug-in procedure requires two arguments: the handle for
the layout viewer tool and the handle for the window from which
the macro is invoked.</p>
<p class="p">For example, this <span class="keyword ParameterName RequiredReplaceable">guiPlugin</span> procedure
invoke the <span class="keyword ParameterName RequiredReplaceable">commandProc</span> procedure
from the GUI plug-in:</p>
<pre class="pre codeblock leveled"><code>proc my_plugin_procedure { wbHandle window} { 
    my_cmd_procedure 
} </code></pre></dd>
</dl>
</div>
</div>
<div class="section ReturnedValues"><h2 class="title Subheading sectiontitle">Return Values</h2><p class="p">None.</p>
</div>
<div class="section Descriptions"><h2 class="title Subheading sectiontitle">Description</h2><p class="p">Creates a macro and registers
it with a Calibre layout viewer. The new macro adds functionality
you need to the layout viewer. You write the required macro procedures
using the Tcl programming language. Once registered, the macro name
can be placed on the <span class="ph uicontrol bold">Macros</span> menu
as a menu item. A common use for macros is to provide access to
Calibre batch tools.</p>
<p class="p">This command requires two existing
Tcl procedures, one containing the commands you want the macro to
perform and the other to interface to the Calibre layout viewer
GUI.</p>
<p class="p">In
this example, the <span class="keyword ParameterName Required">Macros create</span> command
registers the “my_cmd_procedure” Tcl procedure as a macro:</p>
<pre class="pre codeblock leveled"><code>if {[info exists tk_version]} { 
	Macros create "my macro" my_cmd_procedure my_plugin_procedure 
}</code></pre><p class="p">In order to add a macro to the
Calibre layout viewer <span class="ph uicontrol bold">Macros</span> menu,
use the <span class="ph FontProperty shellcommand">source</span> command
to source the macro from your <span class="ph filepath italic">$HOME/wbinit.tcl</span> file,
and then invoke the layout viewer.</p>
<pre class="pre codeblock leveled"><code>echo "source macro_file.tcl" &gt;&gt; ~/wbinit.tcl 
calibredrv</code></pre><p class="p">To write complicated macros,
first write the command script, and then test the script. Following
this, rewrite the script into a procedure. Finally, write a GUI
plug-in procedure to obtain user input data, and register the macro.</p>
<div class="note tip"><span class="tiptitle">Tip</span> <p class="p">The <span class="ph FontProperty shellcommand">Macros</span> Tcl
command is only available when running the GUI and not in shell
mode, therefore it is recommend that you wrap macro definitions
in an “if {[info exists tk_version]} {…}” block as shown above to
avoid errors when the <span class="ph filepath">wbinit.tcl</span> file is sourced.</p>
</div>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">For
more information on writing macros, see “<a class="xref fm:HeadingAndPage" href="Contain_WritingMacros_id77aaf373.html#id77aaf373-d862-4ffe-a1c2-fdf0caed0b3b__Contain_WritingMacros_id77aaf373.xml#id77aaf373-d862-4ffe-a1c2-fdf0caed0b3b" title="One of the many uses for macros is to provide access to the many Calibre batch tools (such as DRC, LVS, the RET batch tools), essentially making them interactive from the graphical user interface. However, you can use macros to perform many other functions as well.">About Writing Macros</a>”.</p>
</div>
</div>
<div class="section Examples"><h2 class="title Subheading sectiontitle">Examples</h2><div class="section Subsection" id="id530bc0fa-ee59-4d02-a363-242364081114__id540b6be4-8381-4bb3-94f5-3d65c7ba31f9"><h2 class="title Subheading sectiontitle">Example 1</h2><p class="p">Assuming you have a Tcl procedure
which you want made into a macro, you have only to add a second
brief procedure and a call to the <span class="ph FontProperty shellcommand">Macros create</span> batch
command to turn the original procedure into a macro.</p>
<p class="p">In the following example, a Tcl
procedure has been expanded into a macro:</p>
<pre class="pre codeblock leveled"><code>proc original_tcl_script { } { 
	tk_messageBox -message "Testing..." -type ok 
	... 
} 
proc new_macro_plug_in { wbHandle window} { 
	original_tcl_script 
} 
if {[info exists tk_version]} { 
	Macros create "my menu title" original_tcl_script new_macro_plug_in 
} </code></pre><p class="p">To add the macro to the layout viewer <span class="ph uicontrol bold">Macros</span> menu, source the macro
from your <span class="ph filepath">wbinit.tcl</span> file, and
then invoke the Calibre layout viewer as always:</p>
<pre class="pre codeblock leveled"><code>echo "source macro_file.tcl" &gt;&gt; ~/.calibrewb_workspace/wbinit.tcl 
calibredrv </code></pre></div>
<div class="section Subsection" id="id530bc0fa-ee59-4d02-a363-242364081114__idea6fbc41-b8b9-4753-863d-a53e9baea7b4"><h2 class="title Subheading sectiontitle">Example 2</h2><p class="p">This example takes a simple Tcl
procedure and converts it to a macro available in the layout viewer <span class="ph uicontrol bold">Macros</span> menu. This example assumes
you are starting with the following example Tcl script containing
only a proc named “cmd_procedure” that runs commands you require:</p>
<pre class="pre codeblock leveled"><code>proc cmd_procedure { } { 
	tk_messageBox -message "Procedure cmd_procedure was called." -type ok 
	... 
} </code></pre><p class="p">Add a second proc named “plugin_procedure”
to invoke the command procedure from the GUI plug-in. A GUI plug-in
procedure requires two arguments: the handle for the layout viewer
tool and the handle for the window from which the macro is invoked:</p>
<pre class="pre codeblock leveled"><code>proc plugin_procedure { wbHandle window} { 
    cmd_procedure 
} </code></pre><p class="p">The following Tcl script registers
the original Tcl procedure as a macro:</p>
<pre class="pre codeblock leveled"><code>if {[info exists tk_version]} { 
	Macros create "my macro" cmd_procedure plugin_procedure 
} </code></pre><p class="p">Finally, to add the macro to the
layout viewer Macros menu, use the <span class="ph FontProperty shellcommand">source</span> command
to read and evaluate the macro in your <span class="ph filepath italic">$HOME/wbinit.tcl</span> file,
and then invoke the layout viewer:</p>
<pre class="pre codeblock leveled"><code>echo "source <span class="ph filepath italic">macro_file.tcl</span>" &gt;&gt; ~/wbinit.tcl 
calibredrv</code></pre></div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_MacrosCommands_id3aa81de3.html" title="Macros are application extensions you write to add new functionality to your application. In order to use macros, you must first add them to the Macros menu.">Macros Commands</a></div>
</div>

<div class="linklist linklist relinfo"><strong>Related Topics</strong><br />

<div><a class="link" href="../topics/Command_MacrosDelete_id3102c261.html#id3102c261-efa5-43f7-8a69-dc0353971a28__" title="Removes (un-registers) the specified macro.">Macros delete</a></div>
<div><a class="link" href="../topics/Command_MacrosMenu_id4e48e4e9.html#id4e48e4e9-5e24-442b-a0f7-eefe9a3aba58__" title="Re-creates the Macros menu with all registered macros.">Macros menu</a></div>
<div><a class="link" href="../topics/Command_MacrosShow_id91b04954.html#id91b04954-eaaa-4c73-8372-5f5cbc3b2958__" title="Returns information about macros currently registered with the tool.">Macros show</a></div></div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_drv_ref"
                DocTitle = "Calibre® DESIGNrev™ Reference Manual"
                PageTitle = "Macros create"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Command_MacrosCreate_id530bc0fa.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® DESIGNrev™ Reference Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>