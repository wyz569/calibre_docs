<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Simple Macro Example" />
<meta name="abstract" content="This example converts a simple Tcl procedure into a macro and makes it available through the layout viewer Macros menu." />
<meta name="description" content="This example converts a simple Tcl procedure into a macro and makes it available through the layout viewer Macros menu." />
<meta name="prodname" content="Calibre DESIGNrev Reference Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-26" />
<meta name="Topline" content="Siemens EDA" />
<meta name="IncludeDraftCommentsInChangeLog" content="2019.4" />
<meta name="GenerateOnlyChangedTopics" content="no" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="HighlightChanges" content="yes" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="2" />
<meta name="SubTitle" content="Batch Command Support for Calibre® DESIGNrev™, Calibre® WORKbench™, Calibre® LITHOview™, and Calibre® MDPview™" />
<meta name="SourceHandle" content="calbr_drv_ref" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® DESIGNrev™ Reference Manual" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10088,product.id.P10120" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id73c0e99c-d792-4fe2-8dc7-8bc8cbc57a52" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Simple Macro Example</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Simple Macro Example" />
<meta name="attributes" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10088,product.id.P10120" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id73c0e99c-d792-4fe2-8dc7-8bc8cbc57a52">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Simple
Macro Example</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">This example
converts a simple Tcl procedure into a macro and makes it available
through the layout viewer Macros menu.</span>
</div>
<p class="p">You start with an example Tcl
script containing only a proc, named <span class="ph filepath italic">return_info</span>,
which runs commands you require:</p>
<pre class="pre codeblock leveled"><code>proc return_info { } { 
   tk_messageBox -message "Procedure return_info was called.” -type ok 
   ... 
} </code></pre><p class="p">You then add a second proc, <span class="ph filepath italic">return_info_plug_in</span>,
which invokes the command procedure from the GUI plug-in. A GUI
plug-in procedure is passed two arguments: the handle for the layout
viewer application and the handle for the window from which the
macro is invoked:</p>
<pre class="pre codeblock leveled"><code>proc return_info_plug_in { wbHandle window} { 
   return_info 
}</code></pre><p class="p">The following Tcl call registers the original
Tcl procedure as a macro. The Macros Tcl command is only available
when running the layout viewer’s GUI, and not when running in shell
mode. Therefore the following call is wrapped in an if block to
avoid errors when the Tcl script is sourced:</p>
<pre class="pre codeblock leveled"><code>if {[info exists tk_version]} { 
	macros create "my macro" return_info return_info_plug_in 
} </code></pre><p class="p">Finally, to add the macro to the layout viewer
Macros menu, source the macro from your <span class="ph filepath italic">$HOME/wbinit.tcl</span> file,
and then invoke the layout viewer:</p>
<pre class="pre codeblock leveled"><code>echo "source macro_file.tcl" &gt;&gt; ~/wbinit.tcl 
calibredrv </code></pre><div class="note note"><span class="notetitle">Note:</span> <p class="p">To write a more
complicated macro, it is easiest to first write the command script,
and then test the script. Following this, rewrite the script into
a procedure. Finally, write a GUI plug-in to obtain user input data,
and register the macro.</p>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCChap_WritingMacros_id182aad1c.html" title="Macros are application extensions you write to add new functionality to a Calibre layout viewer application, such as Calibre DESIGNrev. You can then make the extensions accessible from the Macros menu.">Writing Macros</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_drv_ref"
                DocTitle = "Calibre® DESIGNrev™ Reference Manual"
                PageTitle = "Simple Macro Example"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_SimpleMacroExample_id73c0e99c.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® DESIGNrev™ Reference Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>