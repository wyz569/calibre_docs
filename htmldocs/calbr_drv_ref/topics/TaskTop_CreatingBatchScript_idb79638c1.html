<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2021" />
<meta name="DC.rights.owner" content="(C) Copyright 2021" />
<meta name="DC.Type" content="TaskTopic" />
<meta name="DC.Title" content="Creating a Batch Script" />
<meta name="abstract" content="Tcl scripts are stand-alone programs written using the Tcl language, plus any language extensions you have available. Calibre layout viewer scripts are Tcl scripts using the Calibre layout viewer Tcl extensions and batch commands." />
<meta name="description" content="Tcl scripts are stand-alone programs written using the Tcl language, plus any language extensions you have available. Calibre layout viewer scripts are Tcl scripts using the Calibre layout viewer Tcl extensions and batch commands." />
<meta name="prodname" content="Calibre DESIGNrev Reference Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Siemens Industry Software 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2021-03-26" />
<meta name="Topline" content="Siemens EDA" />
<meta name="IncludeDraftCommentsInChangeLog" content="2019.4" />
<meta name="GenerateOnlyChangedTopics" content="no" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="HighlightChanges" content="yes" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="2" />
<meta name="SubTitle" content="Batch Command Support for Calibre® DESIGNrev™, Calibre® WORKbench™, Calibre® LITHOview™, and Calibre® MDPview™" />
<meta name="SourceHandle" content="calbr_drv_ref" />
<meta name="SoftwareVersionNum" content="2021.2" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="14" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="calbr_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="March 2021" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Calibre® DESIGNrev™ Reference Manual" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10088,product.id.P10120" />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="calibre" />
<meta name="BookcaseHandle" content="none" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="idb79638c1-71df-48e0-af94-7f7c15fce74c" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Creating a Batch Script</title>
<link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles-disw/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles-disw/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles-disw/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Creating a Batch Script" />
<meta name="attributes" content="doc.type.documentation.ref,product.version.v2021.2,product.id.P10088,product.id.P10120" />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.3.000" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="idb79638c1-71df-48e0-af94-7f7c15fce74c">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Creating
a Batch Script</h1>
<div class="body taskbody TaskBody"><div class="abstract TaskAbstract"><span class="shortdesc">Tcl scripts are
stand-alone programs written using the Tcl language, plus any language
extensions you have available. Calibre layout viewer scripts are Tcl
scripts using the Calibre layout viewer Tcl extensions and batch commands.</span>
</div>
<div class="tasklabel"><h2 class="sectiontitle tasklabel">Procedure</h2></div><ol class="ol steps"><li class="li step stepexpand" id="idb79638c1-71df-48e0-af94-7f7c15fce74c__idfd3cbda1-0c11-4dd0-8e0b-573cedbf3d92"><span class="ph cmd">You run your layout viewer
script in batch mode, by including the pathname for the script in
the Calibre DESIGNrev invocation. You also add arguments to the
script for the layout database pathname and the data output filename:</span><div class="itemgroup info StepInfo"><pre class="pre codeblock leveled"><code>calibredrv myscript.tcl mylayout.gds myoutput.txt </code></pre><p class="p">The code is expanded to include
an example of writing a recursive procedure that checks whether
a cell has contents. The resulting script outputs layer and cell
data about a layout, and it highlights whether any particular cell
is empty.</p>
</div></li>
<li class="li step stepexpand" id="idb79638c1-71df-48e0-af94-7f7c15fce74c__id6ec00f25-700a-4104-b760-9ea0473ab2db"><span class="ph cmd">In addition to adding a new
Tcl procedure, the commands you typed into the console in the previous
section have been modified to convert them to a script. Here is
an example of the batch commands discussed, placed into a script
format. You can copy and save the following script to a file named <span class="ph filepath italic">myscript.tcl</span>:</span><div class="itemgroup info StepInfo"><pre class="pre codeblock leveled"><code># Filename: myscript.tcl 
 
# Description: Display layer and cell information about a database. 
 
# This script accepts two optional arguments: 
#	arg 0 --&gt; layout filename 
#	arg 1 --&gt; output filename 
 
# Default filename argument values. 
set layoutfilename "mylayout.gds" 
set outputfilename "myoutput.txt" 
 
 
# Print out the children of a given cell. 
proc proc_cell_tree { L F {C ""} {Indent ""} } { 
	if {$C == ""} { 
		set C [$L topcell] 
	} 
	if { [ check_cell_empty $L $C ] } { 
		puts $F "$Indent--&gt; $C -- Empty cell" 
	} else { 
		puts $F "$Indent--&gt; $C" 
	} 
	append Indent "\t" 
	foreach child [$L children $C] { 
		proc_cell_tree $L $F $child $Indent 
	} 
} 
 
 
# Check for empty cells. 
proc check_cell_empty { L cell_name } { 
	if { [ $L exists cell $cell_name ] } { 
		# Check if cell contains at least one polygon, wire, or text. 
		foreach layer [ $L layers ] { 
			if { [ $L iterator count poly $cell_name $layer ] != 0 || \ 
				[ $L iterator count wire $cell_name $layer ] != 0 || \ 
				[ $L iterator count text $cell_name $layer ] != 0 } { 
					return 0 
			} 
		} 
		# If cell only contains a reference, check if reference is
		# empty. 
		if { [ $L iterator count ref $cell_name ] != 0 } { 
			set ref_list [ $L iterator ref $cell_name range 0 end ] 
			foreach ref $ref_list { 
				set refname [ lindex [ split $ref ] 0 ] 
				if { ![ check_cell_empty $L $refname ] } { 
					return 0 
				} 
			} 
		} 
		return 1 
	} 
} 
 
 
# Argument processing. 
if {$argc == 0} { 
	puts "$argv0: Default layout filename: $layoutfilename" 
	puts "$argv0: Default output filename: $outputfilename" 
} elseif {$argc == 1} { 
	set layoutfilename [lindex $argv 0] 
	puts "$argv0: Default output filename: $outputfilename" 
} elseif {$argc == 2} { 
	set layoutfilename [lindex $argv 0] 
	set outputfilename [lindex $argv 1] 
} else { 
	puts "$argv0: Wrong number of arguments, $argc." 
	puts "Usage: $argv0 [layout filename] [output filename]" 
	puts "$argv0: Default layout filename: $layoutfilename" 
	puts "$argv0: Default output filename: $outputfilename" 
	exit 
} 
if { ![ file exists $layoutfilename] } { 
	puts "$argv0: Database $layoutfilename does not exist" 
exit 
} 
 
# Open data file for writing. 
set fileID [open $outputfilename w] 
 
# Capture layout handle. 
set mylayout [layout create $layoutfilename] 
 
# Output layer and cell information to data file. 
puts $fileID "This file displays layer and cell information about\ 
	the [$mylayout file] database." 
puts $fileID "\nLayers:" 
foreach lay [lsort -integer [$mylayout layers]] { 
	puts $fileID "--&gt; $lay" 
} 
puts $fileID "\nCells:" 
 
 
# Write out results to data file. 
proc_cell_tree $mylayout $fileID 
 
close $fileID 
set fileID [open $outputfilename r] 
read $fileID 
close $fileID </code></pre></div></li>
<li class="li step stepexpand" id="idb79638c1-71df-48e0-af94-7f7c15fce74c__id604f5591-b8ac-44f6-99ae-de0bf4406424"><span class="ph cmd">Save and close the file.</span></li>
<li class="li step stepexpand" id="idb79638c1-71df-48e0-af94-7f7c15fce74c__id596076aa-8228-410f-bcb4-bcfa2293717b"><span class="ph cmd">Enter the following command
to execute the batch script:</span><div class="itemgroup info StepInfo"><pre class="pre codeblock leveled"><code>% calibredrv myscript.tcl mylayout.gds myoutput.txt</code></pre></div></li>
</ol>
<div class="section result"><div class="tasklabel"><h2 class="sectiontitle tasklabel">Results</h2></div><p class="p">Here is the transcript from running
this batch script:</p>
<pre class="pre codeblock leveled"><code>/labs/drvbatch % calibredrv myscript.tcl mylayout.gds myoutput.txt 
Collecting data...                                                          
Analyzing data... 
Sorting data... 
 
------------------------------------------------------------------------- 
-----                  LAYOUT FILE OBJECT SUMMARY                   ----- 
------------------------------------------------------------------------- 
 
Type                         Count 
---------------------------------- 
LAYER                           13 
CELL                           149 
PLACEMENT                   135112 
ARRAY                            0 
RECTANGLE                   131797 
POLYGON                       1440 
PATH                             0 
TEXT                             0 
PROPERTY                         0 
 
 
------------------------------------------------------------------------- 
-----                     LOAD LAYOUT SUMMARY                       ----- 
------------------------------------------------------------------------- 
 
GDS FILE READ FROM ’/labs/drvbatch/mylayout.gds’ 
 
DATABASE PRECISION:  0.001 user units per database unit 
PHYSICAL PRECISION:  1e-09 meters per database unit 
 
LAYOUT FILE SIZE =           12382 K  =           12 M 
LAYOUT MEMORY    =            6659 K  =            6 M 
LAYOUT READ TIME = 1 sec REAL.  TOTAL TIME = 2 sec REAL. 
 
/labs/drvbatch % 
 </code></pre><p class="p">Output from this script is as follows:</p>
<pre class="pre codeblock leveled"><code>This file displays layer and cell information about the mylayout.gds 
database. 
 
Layers: 
--&gt; 1 
--&gt; 2 
--&gt; 3 
--&gt; 4 
--&gt; 5 
--&gt; 6 
--&gt; 7 
--&gt; 8 
--&gt; 9 
--&gt; 10 
--&gt; 11 
--&gt; 30 
--&gt; 31 
 
Cells: 
--&gt; mp_core 
	--&gt; AOI32X4 
		--&gt; aoi32_4xaww3wwwwwbhkbsly 
	--&gt; XNOR2 
	--&gt; AOI2BB2X1 
	--&gt; OAI32X4 
		--&gt; oai32_4xaww3wwwwwtdkunjy 
	--&gt; AOI222X1 
		--&gt; aoi222_1xawwpwwwwwl1f2fcy -- Empty cell 
	--&gt; OAI31X1 
		--&gt; oai31_1xawwewwwwwukxutty 
	--&gt; AOI21X2 
		--&gt; aoi21_2xaww9wwwwwcvsiymy 
... </code></pre></div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCAppe_ExampleScript_id91446712.html" title="Typically, the Calibre layout viewers are accessed using the Calibre DESIGNrev GUI. Alternatively, layout viewer batch commands can be used. Additionally, these commands can be combined into stand-alone programs called scripts. Scripts are a simple way to string together a series of batch commands for execution together. It is often useful to develop a script interactively, to see the output of each command as you step through them.">Example Script</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "calbr_drv_ref"
                DocTitle = "Calibre® DESIGNrev™ Reference Manual"
                PageTitle = "Creating a Batch Script"
                Copyright = "2021"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/TaskTop_CreatingBatchScript_idb79638c1.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Calibre® DESIGNrev™ Reference Manual, v2021.2<br />Unpublished work. © 2021 Siemens 
                <br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>